{"id":303378,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMDMzNzg=","url":"https://hackerone.com/reports/303378","title":"SSRF - Blacklist bypass for mail account addition","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-01-08T22:25:32.145Z","submitted_at":"2018-01-08T22:25:32.145Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"logan5","url":"/logan5","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/110/421/4eacc0e36a20a036380e88612bb8755d1dddda08_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":8906,"url":"https://hackerone.com/open-xchange","handle":"open-xchange","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Open-Xchange","twitter_handle":"openxchange","website":"https://www.open-xchange.com/","about":"Messaging, collaboration and office productivity software for service providers"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-07-05T09:04:22.786Z","bug_reporter_agreed_on_going_public_at":"2019-07-05T09:04:22.694Z","team_member_agreed_on_going_public_at":"2019-07-04T11:19:00.691Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"FYI - Tested on local installation of App Suite 7.8.4-Rev19, on CentOS 7.4\n\nHello,\n\nThere appears to be a vulnerability with the way the IP blacklist works for adding servers for a new mail account.  The default blacklist is designed to stop connections to the localhost address, but these can be bypassed.  The same is also true of user-specified IP addresses.   The vulnerable endpoint is the following:\n\n**http://\u003cdomain\u003e/appsuite/api/account?action=validate\u0026session=\u003csessionkey\u003e**\n\nPre-requisites to exploit this vulnerability are the following:\n\n-Valid session from login or anonymous link\n\n\n###Summary\n\nThe configuration file located at **/opt/open-xchange/etc/mail.properties** contains the following parameter that defaults to blocking all connections to localhost on a set of white-listed ports:\n\n**com.openexchange.mail.account.blacklist=127.0.0.1-127.255.255.255,localhost,192.168.0.10**\n\nNote.  **192.168.0.10** has been added by myself for testing purposes\n\nAs can be seen, the blacklist should prevent localhost connections and connections to 192.168.0.10.  This however can be bypassed using a variety of payloads, the below list has been confirmed to work:\n\n**Localhost bypass:**\n\n1.   All IPv4: **0**\n2.   All IPv6: **::**\n3.   All IPv4: **0.0.0.0**\n4.   Localhost IPv6: **::1**\n5.   All IPv4: **0000**\n6.   All IPv4: (Leading zeros): **00000000**\n7.   IPv4 mapped IPv6 address: **0:0:0:0:0:FFFF:7F00:0001** \n8.   8-Bit Octal conversion: **0177.00.00.01**\n9.   32-Bit Octal conversion: **017700000001**\n10. 32-Bit Hex conversion: **0x7f000001**\n\n**192.168.0.10 bypass:**\n\n1.   IPv4 mapped IPv6 address: **0:0:0:0:0:FFFF:C0A8:000A**\n2.   32-Bit Hex conversion: **030052000012**\n3.   32-Bit Octal conversion: **0xc0a8000a**\n\n \n###PoC Setup\n\n{F252353}\n\n\nThe below PoC will contain the following files:\n\n**request.py** (Attackers python script that will submit different formats of IP addresses to the affected endpoint)\n\n**script_results.txt** (Results of different IP address formats and port response)\n\n\n###PoC\n\n-The **requests.py** script will run on **192.168.0.6 (Attacker server)** this will connect to the App Suite server **(192.168.0.16)** and submit multiple PUT requests to the vulnerable endpoint\n\n-The submitted IP addresses in each PUT request will be to the blacklisted IP address **(192.168.0.10)** or **localhost**.  \n\n-There will be a Netcat listener running on **TCP port 143** on **192.168.0.10** and the App Suite server on **192.168.0.16** which will listen for requests.\n\n-The HTTP response time will be analysed to determine if a host is listening on that particular port.  The number of ports that can be probed is however limited to what is available in the configuration whitelist.  The default is the following: **143,993, 25,465,587, 110,995**\n\n-The results will be sent to **script_output.txt** sorted in descending order of HTTP response time.   \n\n\n###Results\n\n-Below is a section of results from the **script_output.txt** file.  As you can see, port connections with the longest response times are from non-standard IP address entries.  Response time is the best indicator in this case.  You can receive “time out” error messages in the HTTP response, this was not consistent with every response received however.\n\n```\nIP Format: ::1  Response Time:  [50.057549]\nIP Format: 030052000012  Response Time:  [50.034396]\nIP Format: 0177.00.00.01  Response Time:  [20.032494]\nIP Format: localhost  Response Time:  [0.013174]\nIP Format: 192.168.0.10  Response Time:  [0.01305]\nIP Format: 127.0.0.1  Response Time:  [0.011691]\n\n```\n\n-Below are the results from the Netcat listeners during multiple successful connections\n\n**App Suite server (192.168.0.16)**\n\n```\n[root@localhost test]# nc -l -k -vv -p 143\nNcat: Version 6.40 ( http://nmap.org/ncat )\nNcat: Listening on :::143\nNcat: Listening on 0.0.0.0:143\nNcat: Connection from 127.0.0.1.\nNcat: Connection from 127.0.0.1:37266.\nNCAT DEBUG: Closing connection.\nNcat: Connection from 127.0.0.1.\nNcat: Connection from 127.0.0.1:37274.\nNCAT DEBUG: Closing connection.\nNcat: Connection from 127.0.0.1.\nNcat: Connection from 127.0.0.1:37280.\nNCAT DEBUG: Closing connection.\n```\n\n**192.168.0.10 server**\n\n```\nroot@test-VirtualBox:~# nc -l -vv -k -p 143\nListening on [0.0.0.0] (family 0, port 143)\nConnection from [192.168.0.16] port 143 [tcp/imap2] accepted (family 2, sport 49490)\nConnection closed, listening again.\nConnection from [192.168.0.16] port 143 [tcp/imap2] accepted (family 2, sport 49496)\nConnection closed, listening again.\nConnection from [192.168.0.16] port 143 [tcp/imap2] accepted (family 2, sport 49502)\nConnection closed, listening again.\n```\n\n## Impact\n\nOverall, this is a limited SSRF vulnerability here that can be used for reconnaissance purposes of internal hosts.  The effect of the vulnerability is limited to the small range of ports that can be probed, the default being the following provided by the whitelist: 143,993, 25,465,587, 110,995\n\nAll the best.","vulnerability_information_html":"\u003cp\u003eFYI - Tested on local installation of App Suite 7.8.4-Rev19, on CentOS 7.4\u003c/p\u003e\n\n\u003cp\u003eHello,\u003c/p\u003e\n\n\u003cp\u003eThere appears to be a vulnerability with the way the IP blacklist works for adding servers for a new mail account.  The default blacklist is designed to stop connections to the localhost address, but these can be bypassed.  The same is also true of user-specified IP addresses.   The vulnerable endpoint is the following:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ehttp://\u0026lt;domain\u0026gt;/appsuite/api/account?action=validate\u0026amp;session=\u0026lt;sessionkey\u0026gt;\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003ePre-requisites to exploit this vulnerability are the following:\u003c/p\u003e\n\n\u003cp\u003e-Valid session from login or anonymous link\u003c/p\u003e\n\n\u003ch3 id=\"summary\"\u003eSummary\u003c/h3\u003e\n\n\u003cp\u003eThe configuration file located at \u003cstrong\u003e/opt/open-xchange/etc/mail.properties\u003c/strong\u003e contains the following parameter that defaults to blocking all connections to localhost on a set of white-listed ports:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003ecom.openexchange.mail.account.blacklist=127.0.0.1-127.255.255.255,localhost,192.168.0.10\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003eNote.  \u003cstrong\u003e192.168.0.10\u003c/strong\u003e has been added by myself for testing purposes\u003c/p\u003e\n\n\u003cp\u003eAs can be seen, the blacklist should prevent localhost connections and connections to 192.168.0.10.  This however can be bypassed using a variety of payloads, the below list has been confirmed to work:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eLocalhost bypass:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e  All IPv4: \u003cstrong\u003e0\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e  All IPv6: \u003cstrong\u003e::\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e  All IPv4: \u003cstrong\u003e0.0.0.0\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e  Localhost IPv6: \u003cstrong\u003e::1\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e  All IPv4: \u003cstrong\u003e0000\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e  All IPv4: (Leading zeros): \u003cstrong\u003e00000000\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e  IPv4 mapped IPv6 address: \u003cstrong\u003e0:0:0:0:0:FFFF:7F00:0001\u003c/strong\u003e \u003c/li\u003e\n\u003cli\u003e  8-Bit Octal conversion: \u003cstrong\u003e0177.00.00.01\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e  32-Bit Octal conversion: \u003cstrong\u003e017700000001\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e32-Bit Hex conversion: \u003cstrong\u003e0x7f000001\u003c/strong\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e\u003cstrong\u003e192.168.0.10 bypass:\u003c/strong\u003e\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003e  IPv4 mapped IPv6 address: \u003cstrong\u003e0:0:0:0:0:FFFF:C0A8:000A\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e  32-Bit Hex conversion: \u003cstrong\u003e030052000012\u003c/strong\u003e\n\u003c/li\u003e\n\u003cli\u003e  32-Bit Octal conversion: \u003cstrong\u003e0xc0a8000a\u003c/strong\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"poc-setup\"\u003ePoC Setup\u003c/h3\u003e\n\n\u003cp\u003e\u003ca class=\"markdown-attachment-link markdown-attachment-inline-reference\" data-attachment-filename=\"poc.png\" data-attachment-link=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/252/353/8cc100f6c68668b36bc881ffdb8da9bf6c0b36d9/poc.png?response-content-disposition=attachment%3B%20filename%3D%22poc.png%22%3B%20filename%2A%3DUTF-8%27%27poc.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052950Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026amp;X-Amz-Signature=a419092bf469549841372e1e425bf6f0b277244080faeb91bfc1d95ca8a53fe6\" data-attachment-type=\"image/png\"\u003e\u003cimg src=\"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/252/353/8cc100f6c68668b36bc881ffdb8da9bf6c0b36d9/poc.png?response-content-disposition=attachment%3B%20filename%3D%22poc.png%22%3B%20filename%2A%3DUTF-8%27%27poc.png\u0026amp;response-content-type=image%2Fpng\u0026amp;X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026amp;X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026amp;X-Amz-Date=20201229T052950Z\u0026amp;X-Amz-Expires=3600\u0026amp;X-Amz-SignedHeaders=host\u0026amp;X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026amp;X-Amz-Signature=a419092bf469549841372e1e425bf6f0b277244080faeb91bfc1d95ca8a53fe6\" class=\"markdown-inline-image\" style=\"display: inline-block\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003eThe below PoC will contain the following files:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003erequest.py\u003c/strong\u003e (Attackers python script that will submit different formats of IP addresses to the affected endpoint)\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003escript_results.txt\u003c/strong\u003e (Results of different IP address formats and port response)\u003c/p\u003e\n\n\u003ch3 id=\"poc\"\u003ePoC\u003c/h3\u003e\n\n\u003cp\u003e-The \u003cstrong\u003erequests.py\u003c/strong\u003e script will run on \u003cstrong\u003e192.168.0.6 (Attacker server)\u003c/strong\u003e this will connect to the App Suite server \u003cstrong\u003e(192.168.0.16)\u003c/strong\u003e and submit multiple PUT requests to the vulnerable endpoint\u003c/p\u003e\n\n\u003cp\u003e-The submitted IP addresses in each PUT request will be to the blacklisted IP address \u003cstrong\u003e(192.168.0.10)\u003c/strong\u003e or \u003cstrong\u003elocalhost\u003c/strong\u003e.  \u003c/p\u003e\n\n\u003cp\u003e-There will be a Netcat listener running on \u003cstrong\u003eTCP port 143\u003c/strong\u003e on \u003cstrong\u003e192.168.0.10\u003c/strong\u003e and the App Suite server on \u003cstrong\u003e192.168.0.16\u003c/strong\u003e which will listen for requests.\u003c/p\u003e\n\n\u003cp\u003e-The HTTP response time will be analysed to determine if a host is listening on that particular port.  The number of ports that can be probed is however limited to what is available in the configuration whitelist.  The default is the following: \u003cstrong\u003e143,993, 25,465,587, 110,995\u003c/strong\u003e\u003c/p\u003e\n\n\u003cp\u003e-The results will be sent to \u003cstrong\u003escript_output.txt\u003c/strong\u003e sorted in descending order of HTTP response time.   \u003c/p\u003e\n\n\u003ch3 id=\"results\"\u003eResults\u003c/h3\u003e\n\n\u003cp\u003e-Below is a section of results from the \u003cstrong\u003escript_output.txt\u003c/strong\u003e file.  As you can see, port connections with the longest response times are from non-standard IP address entries.  Response time is the best indicator in this case.  You can receive “time out” error messages in the HTTP response, this was not consistent with every response received however.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eIP Format: ::1  Response Time:  [50.057549]\nIP Format: 030052000012  Response Time:  [50.034396]\nIP Format: 0177.00.00.01  Response Time:  [20.032494]\nIP Format: localhost  Response Time:  [0.013174]\nIP Format: 192.168.0.10  Response Time:  [0.01305]\nIP Format: 127.0.0.1  Response Time:  [0.011691]\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e-Below are the results from the Netcat listeners during multiple successful connections\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eApp Suite server (192.168.0.16)\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003e[root@localhost test]# nc -l -k -vv -p 143\nNcat: Version 6.40 ( http://nmap.org/ncat )\nNcat: Listening on :::143\nNcat: Listening on 0.0.0.0:143\nNcat: Connection from 127.0.0.1.\nNcat: Connection from 127.0.0.1:37266.\nNCAT DEBUG: Closing connection.\nNcat: Connection from 127.0.0.1.\nNcat: Connection from 127.0.0.1:37274.\nNCAT DEBUG: Closing connection.\nNcat: Connection from 127.0.0.1.\nNcat: Connection from 127.0.0.1:37280.\nNCAT DEBUG: Closing connection.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003e\u003cstrong\u003e192.168.0.10 server\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003eroot@test-VirtualBox:~# nc -l -vv -k -p 143\nListening on [0.0.0.0] (family 0, port 143)\nConnection from [192.168.0.16] port 143 [tcp/imap2] accepted (family 2, sport 49490)\nConnection closed, listening again.\nConnection from [192.168.0.16] port 143 [tcp/imap2] accepted (family 2, sport 49496)\nConnection closed, listening again.\nConnection from [192.168.0.16] port 143 [tcp/imap2] accepted (family 2, sport 49502)\nConnection closed, listening again.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eOverall, this is a limited SSRF vulnerability here that can be used for reconnaissance purposes of internal hosts.  The effect of the vulnerability is limited to the small range of ports that can be probed, the default being the following provided by the whitelist: 143,993, 25,465,587, 110,995\u003c/p\u003e\n\n\u003cp\u003eAll the best.\u003c/p\u003e\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":252353,"file_name":"poc.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/252/353/8cc100f6c68668b36bc881ffdb8da9bf6c0b36d9/poc.png?response-content-disposition=attachment%3B%20filename%3D%22poc.png%22%3B%20filename%2A%3DUTF-8%27%27poc.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052950Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=a419092bf469549841372e1e425bf6f0b277244080faeb91bfc1d95ca8a53fe6","file_size":49362,"type":"image/png"},{"id":252354,"file_name":"script_output.txt","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/252/354/96d86ef72c10682717bd2e1f9d295aa5fac929b0/script_output.txt?response-content-disposition=attachment%3B%20filename%3D%22script_output.txt%22%3B%20filename%2A%3DUTF-8%27%27script_output.txt\u0026response-content-type=text%2Fplain\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052950Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=f9fe3fff6be7160bb903a605cb04a9f8aec028db465e9339bcc5cc094ac27992","file_size":754,"type":"text/plain"},{"id":252355,"file_name":"request.py","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/252/355/4bca92b3e9b4fcdee29bd01ea2b4e9965acf4be2/request.py?response-content-disposition=attachment%3B%20filename%3D%22request.py%22%3B%20filename%2A%3DUTF-8%27%27request.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3ORU3ZNE%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T052950Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBDRduU%2FQiKN2Hy3Cc%2BFdvYldnR%2BI9yQ0JWu5Nd0q2n7AiBT09NYT9NM%2FNa1T7X7mPFfQEFunNsAbPoVngTqyDCvlCq0AwhSEAEaDDAxMzYxOTI3NDg0OSIMjho0%2F2dG4425KWNaKpEDfRP2JVIKEZKe%2Fu1DRJDnMt1hodmiYRHSHxVJXvZvnhQp68RTbgsA5dtRAFzhCl2p7oJWn2DfsUhN61oqH1cme2ydNbTr6cDG5AkVoiUMnjHvkMPTgbPahrduPs%2FdXuwFoyZMuPeBtzUlpjssIk0BfcIUtph2FGwzCuy6d0CQhdl914kkFpuTBp69z2htWslZiifdNkKWK0DIJcK%2FrSurcsk8WEaPiZ7tEJAcfYZS4SddR8orMY%2BhEfGsLc5RSVBGXY0UW6zTNw%2BYg82wPCY1Z9kgrjwVLQPpVTje3rfzRO3UEDh0xbd54m7t%2FSL0yItTAuaGshQmPLuW6S%2F5KOdoWWnwCmkruRqE1ZKMsnSko5gBnNELay%2BWeukQAQ6EyIB%2FWB06%2F%2FaYfBiWUzjgZyKRGg99IBpEO3zShFTod3huOdptlvO4PfWBvrB4632o9feKKn5CXqJUOE%2BTT%2BgjHEdWRLP2W3GZAibuc%2FbOIfOwee7%2Bn9cOimwp8NVS4U08VlgiSfhcWXonWb3aOkvnOfX46QkwoP6p%2FwU67AFSjWFI11fWgLkInKyx6Dx9AePw1c4qVefioOdfVonnQ3dNW7fXwjlRC5F1185jkAwhyCARy9%2F7sIPFHaI%2FEID5osYCwdvVwv0O6pPIknWS%2FVG7rXxUIgYk0xp3ln2eURcIkz%2F20YEsL73kMrgQLn%2BEd3AiGH%2F9wW5PEZOVPNqagqBYtUSWzNl9%2BrKCkhyVg8k79SdRjUkvdYLXtvxU1m6oAu2IjxFOCgwXqn1jFH1Lloh4Gp%2Fkq68ckYZB67%2B%2FdOzejM9ofYNi%2BpJRLwSwwu22w857sj9E%2BbC8Ei9i7KZOZGBCWe81d9lycwAH6Q%3D%3D\u0026X-Amz-Signature=53fedff20f146d5e2b7305a32c403af96adeb52b8db31f6ca4c98a6d55afdee4","file_size":4094,"type":"text/x-python"}],"allow_singular_disclosure_at":null,"vote_count":43,"voters":["base_64","sameerphad72","akshansh","mygf","eveeez","masonhck357","imranhudaa","ronygigi","exception","trieulieuf9","and 33 more..."],"severity":{"rating":"medium","author_type":"Team"},"structured_scope":{"databaseId":551,"asset_type":"URL","asset_identifier":"sandbox.open-xchange.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2274308,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for the report, this goes in a similar direction as #299130 and we confirm the report for mail accounts but also other kinds of blacklists. Note that the reports from #299130 are not yet resolved and available as packages.","markdown_message":"\u003cp\u003eThanks for the report, this goes in a similar direction as \u003ca href=\"/reports/299130\"\u003e#299130\u003c/a\u003e and we confirm the report for mail accounts but also other kinds of blacklists. Note that the reports from \u003ca href=\"/reports/299130\"\u003e#299130\u003c/a\u003e are not yet resolved and available as packages.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-10T08:27:01.385Z","updated_at":"2018-01-10T08:27:01.385Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2274801,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cheers for the quick triage.  Indeed, it is similar to #299130, thought best to submit it anyway in case the endpoint is missed in any future patch that's being developed.\n\nAll the best.","markdown_message":"\u003cp\u003eCheers for the quick triage.  Indeed, it is similar to \u003ca href=\"/reports/299130\"\u003e#299130\u003c/a\u003e, thought best to submit it anyway in case the endpoint is missed in any future patch that\u0026#39;s being developed.\u003c/p\u003e\n\n\u003cp\u003eAll the best.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-10T12:58:29.477Z","updated_at":"2018-01-10T12:58:29.477Z","actor":{"username":"logan5","cleared":false,"url":"/logan5","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/421/4eacc0e36a20a036380e88612bb8755d1dddda08_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2279856,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","markdown_message":"","automated_response":false,"created_at":"2018-01-12T10:30:56.366Z","updated_at":"2018-01-12T10:30:56.366Z","actor":{"url":"/open-xchange","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/JtYLEsu5yRZxGitSmAjeAFtK/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Open-Xchange"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"open-xchange","collaborator":{"username":"logan5","url":"/logan5"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2280404,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks very much for the bounty!  Have a good weekend.","markdown_message":"\u003cp\u003eThanks very much for the bounty!  Have a good weekend.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-12T16:29:47.167Z","updated_at":"2018-01-12T16:29:47.167Z","actor":{"username":"logan5","cleared":false,"url":"/logan5","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/421/4eacc0e36a20a036380e88612bb8755d1dddda08_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2291901,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We solved this vulnerability internally and will provide a backport to in-production releases during the next weeks.","markdown_message":"\u003cp\u003eWe solved this vulnerability internally and will provide a backport to in-production releases during the next weeks.\u003c/p\u003e\n","automated_response":false,"created_at":"2018-01-17T11:17:33.119Z","updated_at":"2018-01-17T11:17:33.119Z","actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"logan5","url":"/logan5"},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4916978,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-05-24T12:17:43.097Z","updated_at":"2019-05-24T12:17:43.097Z","additional_data":{"old_severity":null,"new_severity":"Medium","old_severity_id":null,"new_severity_id":401083},"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5253143,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-04T11:19:00.715Z","updated_at":"2019-07-04T11:19:00.715Z","first_to_agree":true,"actor":{"username":"mheiland","cleared":false,"url":"/mheiland","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/425JKsXEnCYsDU1VA48SXXZV/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5258529,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-05T09:04:22.729Z","updated_at":"2019-07-05T09:04:22.729Z","actor":{"username":"logan5","cleared":false,"url":"/logan5","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/421/4eacc0e36a20a036380e88612bb8755d1dddda08_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5258530,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-05T09:04:22.817Z","updated_at":"2019-07-05T09:04:22.817Z","actor":{"username":"logan5","cleared":false,"url":"/logan5","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/110/421/4eacc0e36a20a036380e88612bb8755d1dddda08_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"open-xchange","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}