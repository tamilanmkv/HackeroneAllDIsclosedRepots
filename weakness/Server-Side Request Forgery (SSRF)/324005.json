{"id":324005,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMjQwMDU=","url":"https://hackerone.com/reports/324005","title":"Server-Side Request Forgery on SAML Application - Import via URL","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-03-09T21:57:40.049Z","submitted_at":"2018-03-09T21:57:40.049Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ziot","url":"/ziot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/003/262/0ae404c47a4859c97158707b8e111baf9f6193d0_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":25188,"url":"https://hackerone.com/pingidentity","handle":"pingidentity","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Ping Identity","twitter_handle":"pingidentity","website":"https://www.pingidentity.com/","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-03-26T20:44:06.747Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-03-26T20:42:29.699Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Summary\n==\n\nThe My Applications feature on PingOne Identity admin allows you to add new SAML applications to your account. One feature allows you to import metadata via URI instead of via upload. This uses Java 1.8 to make an external web request to the URI supplied. Typically this is hard to validate if it's a vulnerability or not because it functions as intended. However, the error responses I was able to get back suggests it can hit internal services and you can perform recon or attack internal services using it.\n\nSteps\n==\n1. Go to My Applications and click the Add Application button:\n * https://ort-admin.pingone.com/web-portal/cas/connections\n2. Fill out basic details and go to the next step\n3. Next to Upload metadata, select `or use URL`\n4. Try these URLs:\n * https://localhost\n * https://localhost:22\n * http://169.254.169.254/latest/meta-data/\n * http://169.254.169.254/latest/meta-data/a\n5. ---\u003e The error responses determine it's hitting internal resources you specify.\n\nAdditional Info\n==\n\nhttps://localhost response:\n * `The issuer of the server X.509 certificate at this address is not in PingOne's trusted authority list.`\n\nhttps://localhost:22 response:\n * `We could not connect to the address 'https://localhost:22'.`\n\nhttp://169.254.169.254/latest/meta-data/ response:\n * `\u003cajax-response\u003e\u003credirect\u003e\u003c![CDATA[../error]]\u003e\u003c/redirect\u003e\u003c/ajax-response\u003e`\n\nhttp://169.254.169.254/latest/meta-data/a response:\n * `We could not connect to the address \u0026#039;http://169.254.169.254/latest/meta-data/a\u0026#039;.`\n\n## Impact\n\nServer-Side Request Forgery that allows internal requests and provides useful feedback on errors could lead an attacker to mapping internal services and hosts. If there are any vulnerable services such as internal APIs, old ElasticSearch, etc it could lead to an attacker escalating to more critical vulnerabilities.\n\nThe hacker selected the **Server-Side Request Forgery (SSRF)** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**Can internal services be reached bypassing network access control?**\nYes\n\n**What internal services were accessible?**\nhttps://localhost\nInternal AWS meta data\n\n**Security Impact**\nThis allows you to hit internal IPs and hostnames in the AWS environment. Any application or host that has security groups preventing external access could potentially be discovered and exploited. Due to no response back, it would mostly be used for recon against internal services/ports.\n\n","bounty_amount":"450.0","formatted_bounty":"$450","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":271084,"file_name":"ssrf.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/271/084/194c0a0beeaad4228f8979d195160751d594696f/ssrf.png?response-content-disposition=attachment%3B%20filename%3D%22ssrf.png%22%3B%20filename%2A%3DUTF-8%27%27ssrf.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQX46P3UGI%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144542Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIGvlFSN4tPhAu4V7v5pc7%2F6eSiik7IhHLLD01kiqhVWYAiB5Dz9ea%2BLZD%2BpLtagj4O%2BjrW%2FPBVXyOw%2FvfPhYOWnLJyqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMy2N4EHiSo%2FA9G2F0KtcDeo3CuylmH%2BuFka3rGPAArFX7PEojyq8EAAWPijF4XtZGXNXpmeQR1pzTOcI0Rm%2Fvja%2BwHd%2F8TxJsGVWeh%2Flk5vjiIRZT9GPW9u3ZycCrjqMci9iGhBM6uwkYQOmABA3poTj0CyTV9vU5PwMEPHFcEacwKutRiCveofJe7f8Tu4WHR%2BNU7KEmxqtXpvAXj8hQLxFVDU25WgaPgk2b4mSQSaY%2FPywLP4TuBkCMbSNVoBG2JTX5CaBeJN5iElkzZ62K%2FGVGXrbaaNyPhn%2BB8rXIjbw78eQJEkHjvT8OqfCHAYP5f%2B4IhYfTll35nE7LIUoMiLvBq6tkN5BWqoopu%2Fpju60lSqB656qlcZeAK9f5orDqJzDwlKMnoVzqvkUrUy9bmk%2BkxGW97VVmeHZ1t0v3wof%2BrT0QSrWeBO35JesCQ%2BdFE8O%2BxosSdP7tU4A%2BDPpxwomZQHAAcNR9Aywt%2FQ8Qbv894mkGzt9WDwY%2FFN8jeU3O6C%2BmyqjrgMf7nGycFeD87%2Bsgs8CikLj6%2BhBYFpskae2EppYXvqHFDwWaJKFLdI8X3NNsrRpCnIXL5GUe8p%2BBySjVvE4SnyaxoJD5sUMGcJj0QQyQGgO22eUI1ATV1DsO%2BN%2BaLLxtMPqIkYsGOqYBTa91vvmG%2BK28LWqLSYG8vhMxYQ%2Fxj6PD70iq5MyM9pLPu1bgCyqJfX2mwm9fHA6UDqgGoerI%2Bnp3Q6V4OYY0E3hEAx7T8Q%2FppO8G%2BTgH7gaNlLC%2Fng4%2BkFoIuXyVGb7q1PCueRn4pqAqwTocflxXYcQQGudKiKkzrNHGy4UeULO76lDgSIcMEtI1vIJ76b2MxFEJwq4lWhln09Xn3ksb8maUXRDeCg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6ad45a21212bed7e5abd469ca2efbf893c4076021f7cb55369886c96fa65e926","file_size":185245,"type":"image/png"}],"allow_singular_disclosure_at":"2019-04-25T20:42:29.838Z","allow_singular_disclosure_after":-77738592.43408762,"singular_disclosure_allowed":true,"vote_count":5,"voters":["mashoud1122","emitrani","samet","dkd","cryptographer"],"severity":{"rating":"medium","score":6.1,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":6162,"asset_type":"URL","asset_identifier":"https://ort-admin.pingone.com/*","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2478274,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"After testing other parts of the site, I was able to find this URL:\n * http://art01.corp.pingidentity.com:8080/artifactory/simple/inhouse/com/pingone/pingone-ui-library/pingone-ui-library/0.3.0/pingone-ui-library-0.3.0.tar.gz\n\nTrying to load that with the SSRF gives me `\u003cajax-response\u003e\u003credirect\u003e\u003c![CDATA[../error]]\u003e\u003c/redirect\u003e\u003c/ajax-response\u003e`.\n\nTrying to load this URL:\n * http://art01.corp.pingidentity.com:8080/artifactory/simple/inhouse/com/pingone/pingone-ui-library/pingone-ui-library/0.3.0/asdf\n\nGives me the following:\n * `We could not connect to the address \u0026#039;http://art01.corp.pingidentity.com:8080/artifactory/simple/inhouse/com/pingone/pingone-ui-library/pingone-ui-library/0.3.0/asdf\u0026#039;.`\n\nThis leads me to believe that the SSRF is able to hit *.corp.pingidentity.com.","automated_response":false,"created_at":"2018-03-09T22:22:07.471Z","updated_at":"2018-03-09T22:22:07.471Z","actor":{"username":"ziot","cleared":true,"url":"/ziot","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/262/0ae404c47a4859c97158707b8e111baf9f6193d0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2479848,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @ziot,\n\nThanks for the report. We'll be looking into it and get back to you shortly.\n\nRegards,\n@bagofchips","automated_response":false,"created_at":"2018-03-10T19:15:10.192Z","updated_at":"2018-03-10T19:15:10.192Z","actor":{"username":"bagofchips","cleared":false,"url":"/bagofchips","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/218/557/6f0d25b588bc8483b7161b46181ee9d14d62b1db_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2479854,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-03-10T19:19:20.582Z","updated_at":"2018-03-10T19:19:20.582Z","additional_data":{"old_severity":null,"new_severity":"High (7.5)","old_severity_id":null,"new_severity_id":127227},"actor":{"username":"bagofchips","cleared":false,"url":"/bagofchips","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/218/557/6f0d25b588bc8483b7161b46181ee9d14d62b1db_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2479856,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"We were able to validate your report, and we have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and if/when a fix will be implemented. We will follow-up after the remediation team has assessed the impact of this report. Please note that the status and severity are subject to change.","automated_response":false,"created_at":"2018-03-10T19:19:33.116Z","updated_at":"2018-03-10T19:19:33.116Z","actor":{"username":"bagofchips","cleared":false,"url":"/bagofchips","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/218/557/6f0d25b588bc8483b7161b46181ee9d14d62b1db_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2479864,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2018-03-10T19:24:34.925Z","updated_at":"2018-03-10T19:24:34.925Z","additional_data":{"old_severity":"High (7.5)","new_severity":"Medium (6.1)","old_severity_id":127227,"new_severity_id":127229},"actor":{"username":"bagofchips","cleared":false,"url":"/bagofchips","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/218/557/6f0d25b588bc8483b7161b46181ee9d14d62b1db_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2515893,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2018-03-21T20:55:44.929Z","updated_at":"2018-03-21T20:55:44.929Z","actor":{"url":"/pingidentity","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/025/188/95e54845d1cd7b8af42716695136b86fd11d0cf1_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Ping Identity"}},"bounty_amount":"450.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"pingidentity","collaborator":{"username":"ziot","url":"/ziot"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3349941,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-09-17T17:13:29.666Z","updated_at":"2018-09-17T17:13:29.666Z","actor":{"username":"richardcardona","cleared":false,"url":"/richardcardona","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ziot","url":"/ziot"},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4396021,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-03-26T20:42:29.729Z","updated_at":"2019-03-26T20:42:29.729Z","first_to_agree":true,"actor":{"username":"joaquinh1","cleared":false,"url":"/joaquinh1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/197/274b02be7185c009932f1a8035f3dc8c8ad9349b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4396031,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","automated_response":false,"created_at":"2019-03-26T20:44:06.578Z","updated_at":"2019-03-26T20:44:06.578Z","actor":{"username":"joaquinh1","cleared":false,"url":"/joaquinh1","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/188/197/274b02be7185c009932f1a8035f3dc8c8ad9349b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"pingidentity","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}