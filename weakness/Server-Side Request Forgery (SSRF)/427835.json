{"id":427835,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC80Mjc4MzU=","url":"https://hackerone.com/reports/427835","title":"Server-Side request forgery in New-Subscription feature of the calendar app","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2018-10-24T12:13:55.702Z","submitted_at":"2018-10-24T12:13:55.702Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"foobar7","url":"/foobar7","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2020-8118"],"singular_disclosure_disabled":false,"disclosed_at":"2019-12-12T09:42:20.199Z","bug_reporter_agreed_on_going_public_at":"2019-12-12T09:42:20.125Z","team_member_agreed_on_going_public_at":"2019-11-13T08:51:06.977Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"CVSS\n----\n\n8.5 High [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:L/A:N)\n\nDescription\n-----------\n\nThe \"New Subscription\" functionality of the official [Calendar](https://github.com/nextcloud/calendar) app allows authenticated users to direct the server to perform arbitrary external requests, and then displays the full response to the user. The requests can be directed to external websites as well as the internal network. \n\nAn attacker can use this vulnerability to exfiltrate data from the internal network that is not protected by other mechanisms, or to perform actions in the name of the server in the internal network which do not contain other protection mechanisms (reduced security is common in internal networks).\n\nAn attacker can also use this issue to scan the internal network as well as external websites for further vulnerabilities.\n\nA user account is required, but it does not require extended permissions.\n \nPOC\n---\n\n    GET /nextcloud/nextcloud/index.php/apps/calendar/v1/proxy?url=http%3A%2F%2Flocalhost%2Fsecret HTTP/1.1\n\n    HTTP/1.1 200 OK\n    [...]\n    secret\n\nThe \"secret\" file is an example of a file located in the internal network that is not protected by further authentication. Its content is displayed in full and as-is (the same is true for more complex files). \n\nSolution\n--------\n\nThe given URL should be verified before making a request. If it is pointing to a private address, the request should not be performed. To reduce the impact of potential misuse of the host as a scanner, requests could be throttled.\n\nAdditionally, the impact of the issue could be reduced by processing the response server-side instead of client-side. Instead of displaying the entire HTTP response to the client, the response could be parsed and validated to ensure that it is in a calendar format. This way, non-calendar/ics information from internal networks would not leak to an attacker.\n\n## Impact\n\nexfiltrate data from the internal network and perform actions in the name of the server in the internal network","bounty_amount":"100.0","formatted_bounty":"$100","weakness":{"id":68,"name":"Server-Side Request Forgery (SSRF)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-12-13T08:51:07.062Z","allow_singular_disclosure_after":-57737299.0322348,"singular_disclosure_allowed":true,"vote_count":8,"voters":["cryptographer","neural","m1ghtyg00sh","cybarcher","7h3_w17ch3r","makatini","ikiiki","min4tor"],"severity":{"rating":"medium","score":5.0,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"low","user_interaction":"none","scope":"changed","confidentiality":"low","integrity":"none","availability":"none"}},"structured_scope":{"databaseId":13,"asset_type":"SOURCE_CODE","asset_identifier":"nextcloud/server","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":3525628,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2018-10-24T12:13:56.398Z","updated_at":"2018-10-24T12:13:56.398Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3525665,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @foobar7,\n\nGood catch. I'm in contact with out calendar engineers to see how we can fix this.\nThere is already work on the way to cache calendars server side: https://github.com/nextcloud/server/pull/10059/files\n\nA possible quick fix (that might do the trick). If check the actual response type of the proxy request.\nAlso filtering out localhost as server would make sense.\n\nWe'll look into this and get back to you.\n\nCheers,\n--Roeland\n\n","automated_response":false,"created_at":"2018-10-24T12:25:36.737Z","updated_at":"2018-10-24T12:25:36.737Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3525675,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2018-10-24T12:27:51.120Z","updated_at":"2018-10-24T12:27:51.120Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":3527427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rullzer,\n\nthanks for the very quick response!\n\nChecking the response type sounds like a good solution to severely reduce the impact. And filtering out private network ranges is a good additional defense if your use-cases allow for it (just the type filter would still allow (port-)scans of internal networks, stealing of internal calendars, and some other (less likely) attacks).\n\nBest,\nFoobar7","automated_response":false,"created_at":"2018-10-24T16:27:26.720Z","updated_at":"2018-10-24T16:27:26.720Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3721714,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rullzer,\n\ndo you have an update on this, or on [#428010](https://hackerone.com/reports/428010) or [#428660](https://hackerone.com/reports/428660)?\n\nBest,\nFoobar7\n\nPS: I forgot to mention this in my initial report, but owncloud is affected by this as well. You might want to coordinate the release of a fix with them or hold back detailed information in the release notes.","automated_response":false,"created_at":"2018-11-28T10:41:30.191Z","updated_at":"2018-11-28T10:43:44.065Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3731497,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"fyi: They had trouble reproducing this over at owncloud because of a failing CSRF check. I rechecked it at nextcloud and could confirm that simply visiting the URL given in the initial report doesn't seem to work. \n\nI'm glad that you were still able to reproduce it, but for completeness sake: You can initiate the correct request - including a CSRF token - in the web interface:\n\n- Open the calendar -\u003e click on \"New Subscription\"\n- Enter the URL -\u003e click on \"Create\"\n- This will lead to an error message in the web interface, but the request will have been sent, and a response will be received. You can read the response using any interception proxy (eg Burp).\n\nYou can alternatively use the attached python script which sends the correct request (including CSRF token) and returns the contents of the internal file. ","automated_response":false,"created_at":"2018-11-29T14:24:43.543Z","updated_at":"2018-11-29T14:24:43.543Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":383116,"filename":"nextcloud_ssrf.py","type":"text/x-python","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/383/116/605a2c6556753e8662f48c6de378db066d7f1282/nextcloud_ssrf.py?response-content-disposition=attachment%3B%20filename%3D%22nextcloud_ssrf.py%22%3B%20filename%2A%3DUTF-8%27%27nextcloud_ssrf.py\u0026response-content-type=text%2Fx-python\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQYC7ZV3WT%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T145926Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIDrMLp4%2BWn0RnMngqqBOAomCU8GWEnyzbfeWXMTkRqdkAiEAmbCt%2FtYvzimCcqsBY5T%2BAP6C1koJvsZIEr7pm24tsEAqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDHO5iuzPFsJ4aK7KmSrXA43fG9ZExUYtmldfJFAHkWRlov9q%2FHMMPiqI7JWoul8iB2lnCe0Z8UD9oM5cfjZfhntNLx94myZGJfeT24YbqZ%2BCsOqn%2BPXRlK7VWqoq1AV8zdBtboSY1qGlF1yW0h8xQvR1G807ShHTgDzCxdIUl0y2PUXdt%2BRNIlHckLFzjBfbJBmGFikh%2B68wwr3qhH%2BRekBJT8dRJqkMmVmJIoL4rn3y%2FCM010RJxL86Xuoat%2BrN046smSjkfceh4bPaJkOADf33dP%2FBliSDcBjoMG74ZFHPAmgnqoN439xdfqhUpIPqNFrcRU1WpQhc12VYut5tMZcbmJchXopaXhvm%2B4orW3DihHvyn7HD%2BiT1cpN9baXaycQzr%2B68J9MyG01Zce8VNQxPm5eRp7v9dtdfEQ9sF3yuOsWzUwY%2BTHCD7SIcVsQFrS5Z2L5Ux3CncTXxkqQVlNCyHTcJODpncVKfD7b6uHxsAmVawhDDZJgLpATJPpVIaGa0em09aEDUcT%2FuazJtx1N1gOr8ZYZSsD6LmJlT7xfEsyzeZ%2BC%2FQQSJKyYRebEtRjLR%2BsYz4MKD2jlXjj62sVdjHko29e6c4eso%2Fx8%2Bjrkj%2BYuyD88VzMWxszti4qHccB7%2Fr3%2BsDzDViZGLBjqlAc5vcHGjagoOTjMDz6VCxHAyKKMhBY%2F4ksl1iKt3Mkg6KIb8dD7WB3B5bRwalHdLpA6q%2F0HyHwVC3k8nRLkVacoHC%2BTnF8IsDYgQMa3VWvq9UB5BqCGPwIE9Smv%2FlQf6eGWyrcOO%2Brsi6UGSaKxoz3eFt2y8zMnz71sdDkZshTNAZoB15M%2BSMQApjyeteOn3dhbojlsBvMBhOE%2FWaBGY2zXmhSJaSA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=40664febebaec8969f67a5f1fc0d9005ad29473dc0443fdf7f94a4e170acdf9e"}],"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3763736,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nSorry for the delay. We had a company hackweek and are very busy with the upcomming releases. I'll check on your other tickets as well.\n\nThis should be fixed with the latest calendar release (1.6.4). Could you verify that?\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2018-12-04T22:10:42.634Z","updated_at":"2018-12-04T22:10:42.634Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3776313,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rullzer ,\n\nthanks for getting back to me on this!\n\nI can confirm that the fix severely reduces the impact of the issue. I couldn't bypass it to read any files that do not start with `BEGIN:VCALENDAR` or `BEGIN:VCARD` (and also otherwise parse properly; the extension of the file doesn't matter, but it's highly unlikely that non-vcalendar/vcard files would start with these strings). \n\nIt is still possible to perform a portscan of the internal network and to perform other requests to the internal network from the given server (see eg [here](https://security.stackexchange.com/questions/182739/what-can-be-done-with-blind-ssrf)) though. And ICS files could of course still be taken from the internal network.\n\nBecause of this, I would still suggest to additionally filter out private network ranges - and optionally provide a configuration option (with a security notice in the documentation) to enable it if absolutely required. \n\nBest,\nFoobar7","automated_response":false,"created_at":"2018-12-06T16:57:24.184Z","updated_at":"2018-12-06T16:57:24.184Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3858939,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @foobar7,\n\nSorry for the delay here. I was traveling with limited internet access.\nI'll talk with our dav/calendar developers to discuss this further.\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2018-12-18T07:48:44.019Z","updated_at":"2018-12-18T07:48:44.019Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3953363,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nSo the background job already does this internal network test: https://github.com/nextcloud/server/blob/master/apps/dav/lib/BackgroundJob/RefreshWebcalJob.php#L227L239\n\nBut lets see if we can add it to calendar directly as well\n\nCheers,\n--Roeland","automated_response":false,"created_at":"2019-01-10T09:30:28.807Z","updated_at":"2019-01-10T09:30:28.807Z","actor":{"username":"rullzer","cleared":false,"url":"/rullzer","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/086/005/20095c4a0c77c88375f8db5d6ed10f350d98a5a3_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":3954516,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rullzer,\n\nreusing existing code sounds good to me :)\n\nThe code may need some adapting though, I found at least two bypasses. \n\n`http://[::]/` is accepted by the filter, and will be retrieved as valid localhost URL. So with the above exploit and a secret.ics file hosted at localhost, the following call will retrieve the file even with the filter in place:\n\n    python nextcloud_ssrf.py http://192.168.0.104/nextcloud/nextcloud/ admin [pass] http://[::]/secret.ics\n\nCasing can also be used to bypass the filter and eg ` http://LocalHost/` will be retrieved by the calendar app:\n\n    python nextcloud_ssrf.py http://192.168.0.104/nextcloud/nextcloud/ admin [pass] http://LocalHost/secret.ics\n\nBest,\nFoobar7\n","automated_response":false,"created_at":"2019-01-10T13:43:53.136Z","updated_at":"2019-01-10T13:46:07.357Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4175910,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rullzer,\n\nany update on this?\n\nBest,\nFoobar7","automated_response":false,"created_at":"2019-02-19T21:07:51.985Z","updated_at":"2019-02-19T21:07:51.985Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4353077,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\nHi @rullzer,\n\nI set a preliminary disclosure date for **April the 23rd** for the same issue in ownCloud. \n\nAs the issues can be exploited using the same POC, I wanted to let you know in case you are planning to add the internal network check from the background job to the calendar as well. \n\nIf you need a bit more time to release a full fix, please let me know an approximate timeline and I'll postpone the disclosure accordingly. \n\nBest,\nFoobar7","automated_response":false,"created_at":"2019-03-19T14:32:23.398Z","updated_at":"2019-03-19T14:32:23.398Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4584317,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rullzer, hi @nickvergessen,\n\nI'd like to remind you of the public disclosure date next week, April the 23rd.\n\nIf you have an approximate timeline for the development of the remainder of the fix, please let me know before then and I'll postpone the disclosure accordingly.\n\nBest,\nFoobar7","automated_response":false,"created_at":"2019-04-17T14:19:42.132Z","updated_at":"2019-04-17T14:19:42.132Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4633610,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @rullzer , \n\nthe owncloud team asked for an extension, so I'm postponing the disclosure. I'll keep you posted. \n\nIt would still be good for me to know if you are planning on further working on this issue (in which case an ETA would be appreciated), or if you want to keep the state as-is (in which case I would not object to marking the report as resolved, but would ask you to hold off on disclosure for now). If you are not sure yet, an ETA on when you will make a decision would also be appreciated.\n\nBest,\nFoobar7","automated_response":false,"created_at":"2019-04-24T11:38:21.508Z","updated_at":"2019-04-24T11:41:23.879Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4633687,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @foobar7,\n\nI'm sorry for the late response and the rather suboptimal communication for this issue.\nWe backported the fix from the Nextcloud server to the Calendar app.\nIt is available on the master and stable1.6 branches:\n- master: https://github.com/nextcloud/calendar/commit/0cdb36e7b3c726bc0c758f6501becb319af1c3ca\n- stable1.6: https://github.com/nextcloud/calendar/commit/f6d5acf744558e1c309a41da02805bc3ad5f64bb\n\nBoth have been released in calendar versions 1.7.0 (Nextcloud 16) and 1.6.5 (Nextcloud 14/15) respectively.\nThis covers all Nextcloud versions currently supported.\n\nPlease let us know how you'd like to be credited in our official advisory. We require the following information:\n- Name / Pseudonym \n- Email address (optional) \n- Website (optional) \n- Company (optional)","automated_response":false,"created_at":"2019-04-24T11:51:32.635Z","updated_at":"2019-04-24T11:51:32.635Z","actor":{"username":"georgehrke","cleared":false,"url":"/georgehrke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/D993oaNG9Cgi9tT7DEJwEuU5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4633838,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @georg_xa7pd,\n\nthanks for getting back to me on this!\n\n------------\n\nThe fix looks mostly OK to me. You still have the problem that the filter can be bypassed (see [this comment](https://hackerone.com/reports/427835#activity-3954516)), but I would consider that to be a separate issue as it's affecting code taken from core (though it now also affects the calendar app).\n\nDo you want me to open a separate report for this so that you can keep track of it?\n\n------------\n\nI'm not sure if you coordinate disclosure with owncloud, but if possible, I'd like to give them a heads-up about your advisory. \n\nWould it be possible to hold off on it to give them time to fix the issue as well? If so, do you want to set a specific date?\n\nIf you want to fix the filter bypass, it might also be a good idea to hold off on the advisory until that is fixed as well.\n\n------------\n\nYou can credit me as:\n\nName: Tim Coen\nWebsite: https://security-consulting.icu/blog/\n\nThanks!\nFoobar7","automated_response":false,"created_at":"2019-04-24T12:30:12.423Z","updated_at":"2019-04-24T12:37:04.716Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6186827,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @georg_xa7pd,\n\nany update on this? As the main issue has been fixed, I think keeping this report open seems unnecessary. \n\nIf you want to keep track of the broader issue of the SSRF filter bypass, I'm happy to open a new report, just let me know.\n\nBest,\nFoobar7","automated_response":false,"created_at":"2019-10-31T18:10:35.831Z","updated_at":"2019-10-31T18:10:35.831Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6288305,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report again. This has been resolved in all supported releases back in July. If you can still bypass something please feel free to open a new issue.\n\nWe are going to credit you with the following information:\n\n- Name: Tim Coen\n- Website: https://security-consulting.icu/blog/\n\n","automated_response":false,"created_at":"2019-11-12T13:49:01.167Z","updated_at":"2019-11-12T13:49:01.167Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"foobar7","url":"/foobar7"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6288716,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2019-11-12T13:58:54.465Z","updated_at":"2019-11-12T13:58:54.465Z","additional_data":{"old_severity":"High","new_severity":"Medium (5.0)","old_severity_id":228322,"new_severity_id":564064},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6288942,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","automated_response":false,"created_at":"2019-11-12T14:28:55.077Z","updated_at":"2019-11-12T14:28:55.077Z","additional_data":{"old_title":"Calendar App: SSRF","new_title":"Server-Side request forgery in New-Subscription feature of the calendar app"},"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6295499,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2019-11-13T08:50:41.636Z","updated_at":"2019-11-13T08:50:41.636Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"bounty_amount":"100.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"foobar7","url":"/foobar7"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6295505,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-11-13T08:51:06.998Z","updated_at":"2019-11-13T08:51:06.998Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":6530454,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-12-12T09:42:20.151Z","updated_at":"2019-12-12T09:42:20.151Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":6530455,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-12-12T09:42:20.221Z","updated_at":"2019-12-12T09:42:20.221Z","actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}