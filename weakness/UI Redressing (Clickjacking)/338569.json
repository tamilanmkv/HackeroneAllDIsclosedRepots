{"id":338569,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMzg1Njk=","url":"https://hackerone.com/reports/338569","title":"Clickjacking: Delete Account, Change privacy settings, Rate business, follow/unfollow (IE)","state":"Closed","substate":"duplicate","severity_rating":"medium","readable_substate":"Duplicate","created_at":"2018-04-15T15:07:45.210Z","submitted_at":"2018-04-15T15:07:45.210Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"foobar7","url":"/foobar7","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2943,"url":"https://hackerone.com/zomato","handle":"zomato","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/943/71b47f9aa21166f0989dfb97112ca10c66a9d0b2_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Zomato","twitter_handle":"Zomato","website":"https://www.zomato.com","about":"The fastest way to search for great places to eat at and order from around you. Serving 24 countries worldwide."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2018-04-15T19:04:34.992Z","bug_reporter_agreed_on_going_public_at":"2018-04-15T18:48:11.292Z","team_member_agreed_on_going_public_at":"2018-04-15T19:04:34.342Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Inspired by report #337219. Please note that this report includes a clear security impact as well as a proof of concept. \n\nCVSS\n----\n\nmedium 5.0 [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L)\n\nDescription\n-----------\n\nThe application does not send a X-Frame-Options header, thus allowing pages to be included in iFrames.\n\nThere are some specific actions which can be performed with clicks:\n\n- DOS: Deleting an account (requires 3 clicks)\n- Confidentiality/Integrity: Change privacy \u0026 notification settings (disabling of \"Hide my profile from search engines\" / \"Prevent my profile from showing up in search results\" as well as enabling/disabling of newsletters)\n- Integrity: Following/Unfollowing users (requires 1 click), Rating a business (requires 2 clicks), Changing the language of the site, etc. Among other, a business could use this to influence its own rating.\n\nNote that attacks will only work in Internet Explorer.  The CSP directive `frame-ancestors` will prevent inclusion of the page in frames in Firefox and Chrome.\n\nProof of Concept\n----------------\n\nRate a business:\n\n    \u003cdiv style=\"position: absolute; left: 430px; top: 490px; pointer-events: none;\"\u003eClick 1\u003c/div\u003e\n    \u003cdiv style=\"position: absolute; left: 650px; top: 535px; pointer-events: none;\"\u003eClick 2\u003c/div\u003e\n    \u003ciframe style=\"opacity: 0.2;\" height=\"1000\" width=\"1000\" scrolling=\"no\" src=\"https://www.zomato.com/szczecin/bajgle-kr%C3%B3la-jana-%C5%9Br%C3%B3dmie%C5%9Bcie\"\u003e\u003c/iframe\u003e\n\nThe following proof of concepts are specific to one user (in this example with the ID 53373042). A general POC which can be reused across users would require two more clicks (opening the menu drop-down + click on settings).\n\nDelete an Account:\n\n    \u003cdiv style=\"position: absolute; left: 70px; top: 860px; pointer-events: none;\"\u003eClick 1\u003c/div\u003e\n    \u003cdiv style=\"position: absolute; left: 330px; top: 600px; pointer-events: none;\"\u003eClick 2 \u0026 3\u003c/div\u003e\n    \u003ciframe style=\"opacity: 0.2;\" height=\"1000\" width=\"1000\" scrolling=\"no\" src=\"https://www.zomato.com/users/simone-eisenberg-53373042/edit\"\u003e\u003c/iframe\u003e\n\nChange privacy settings: \n\n\t\u003cdiv style=\"position: absolute; left: 70px; top: 825px; pointer-events: none;\"\u003eClick 1\u003c/div\u003e\n\t\u003cdiv style=\"position: absolute; left: 295px; top: 900px; pointer-events: none;\"\u003eClick 2\u003c/div\u003e\n\t\u003ciframe style=\"opacity: 0.2;\" height=\"1000\" width=\"1000\" scrolling=\"no\" src=\"https://www.zomato.com/users/simone-eisenberg-53453315/edit\"\u003e\u003c/iframe\u003e\n\nTested with IE11. Note that the script needs to be called on a real domain - not from a local file - as IE will otherwise not send the required cookies.\n\nIn a real attack, the zomato page would not be displayed. Javascript could also be used to automatically follow the users mouse pointer, so that a user would only need to click x times anywhere on a page instead of needing to click the specific labels.\n\n## Impact\n\nDelete Account, change privacy settings, rate a business, follow/unfollow, etc.\n\nThe hacker selected the **UI Redressing (Clickjacking)** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://www.zomato.com/\n\n**Can a victim be tricked into unknowingly initiating a specific action?**\nYes\n\n**What specific action can the user be tricked into?**\nDelete Account, change privacy settings, rate a business, follow/unfollow, etc.","weakness":{"id":74,"name":"UI Redressing (Clickjacking)"},"original_report_id":337219,"original_report_url":"https://hackerone.com/reports/337219","attachments":[{"id":286874,"file_name":"zomato-clickjacking.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/286/874/a1d3fe828c757c869567a717c7508d00f9385c4d/zomato-clickjacking.png?response-content-disposition=attachment%3B%20filename%3D%22zomato-clickjacking.png%22%3B%20filename%2A%3DUTF-8%27%27zomato-clickjacking.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T144745Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d4d7bde3d01580b640c05f44beb7fd1bb3ba5ef7ce72dca3bf2c274d27fae8a0","file_size":244989,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["silv3rpoision","cybernewbie","yuhyuh7890"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":383,"asset_type":"URL","asset_identifier":"*.zomato.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2615774,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"Hi @foobar7 love your inspiration :)\n\nBut just so that you're aware you haven't done anything different. We already knew what the previous researcher was trying to do based on that report. The only concerning thing here is the `Delete Action` but if you see the `Delete Account` requires the user to go through `Account deletion request` although that's optional that's a pretty good hint on what action user is performing.\n\nLot of User Interaction and only working in IE (browser specific) is something which makes this issue as Informative and based on previous reports we are already aware of this behaviour.\n\nWish you good luck in your future bug hunting. Cheers :)","automated_response":false,"created_at":"2018-04-15T18:27:00.780Z","updated_at":"2018-04-15T18:27:00.780Z","original_report_id":337219,"actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2615812,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi @prateek_0490-zomato,\n\nthanks for the quick reply!\n\nI think the previous report was unclear what clickjacking can achieve here. And this isn't only about deleting an account either, but also other actions such as the possibility to manipulate ratings or negatively affect other users privacy.\n\nNote that the `Account deletion request` will not be seen by victims of a clickjacking attack. \n\nIn the POC - which again, is very rudimentary; a real attack will be much easier to perform as users may click anywhere - you can set the `opacity` to 0 so a victim will not know what is happening.\n\nI don't think that 1 click (follow/unfollow), 2 clicks (manipulate ratings), or 3 clicks (delete account) is unreasonable user interaction. \n\nI would consider this a security issue with a measurable impact. But if you disagree, I would request disclosure so that other researchers can see that any Clickjacking attack is out of scope. \n\nIn that case, you might also want to adapt your policy to avoid further duplicates (it currently only mentions \"clickjacking on a static website\", which these are not).\n\nBest,\nFoobar7","automated_response":false,"created_at":"2018-04-15T18:48:11.334Z","updated_at":"2018-04-15T18:48:11.334Z","first_to_agree":true,"actor":{"username":"foobar7","cleared":true,"url":"/foobar7","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2615825,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Disclosing it so that other researchers don't submit a `Clickjacking issue` which requires a lot of User Interaction, and is `browser specific` as this one. If you find an issue which has a ***reasonable security impact*** and doesn't requires `3 clicks` or so then feel free to drop in the reports. But similar issues going forward will be closed as `N/A`.\n\nHappy Hunting :) Cheers.","automated_response":false,"created_at":"2018-04-15T19:04:34.378Z","updated_at":"2018-04-15T19:04:34.378Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2615826,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-04-15T19:04:35.025Z","updated_at":"2018-04-15T19:04:35.025Z","actor":{"username":"prateek_0490-zomato","cleared":false,"url":"/prateek_0490-zomato","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/CL56d6XwY4TN3eHc73df8AEU/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"zomato","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}