{"id":347782,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zNDc3ODI=","url":"https://hackerone.com/reports/347782","title":"Click Jacking Nextcloud","state":"Closed","substate":"informative","severity_rating":"low","readable_substate":"Informative","created_at":"2018-05-05T15:38:23.376Z","submitted_at":"2018-05-05T15:38:23.376Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"enz0","url":"/enz0","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/123/910/ef4c36537df7beae3a7b103dc0b9ecf8f135eee0_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-07-01T10:02:23.776Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-07-01T10:02:14.925Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Security,\nClickjacking (User Interface redress attack, UI redress attack, UI redressing) is a malicious technique of tricking a Web user into clicking on something different from what the user perceives they are clicking on, thus potentially revealing confidential information or taking control of their computer while clicking on seemingly innocuous web pages.\nThe server didn't return an X-Frame-Options header which means that this website could be at risk of a clickjacking attack. The X-Frame-Options HTTP response header can be used to indicate whether or not a browser should be allowed to render a page in a \u003cframe\u003e or \u003ciframe\u003e. Sites can use this to avoid clickjacking attacks, by ensuring that their content is not embedded into other sites.\nThis vulnerability affects Web Server.\nIMPACT:\nAn attacker can host this domain in other evil site by using iframe and if a user fill the given filed it can directly redirect as logs to attacker and after its redirect to your web server.. its lead to steal user information too and use that host site as phishing of your site its CSRF and Clickjacking\n\nPOC:\n1. open https://portal.nextcloud.com/login.php or https://nextcloud.com\n2. Put the url in the below code of iframe\n\u003chtml\u003e\n\u003cbody\u003e\n\u003ciframe \nsandbox=\"allow-modals allow-scripts allow-forms allow-popups allow-same-origin\"\nsrc=\"https://portal.nextcloud.com/login.php\" width=600 height=400\u003e\n\u003c/iframe\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n3.Observe that site is getting displayed in Iframe\n\n## Impact\n\nBy using Clickjacking technique, an attacker hijack's click's\nmeant for one page and route them to another page, most likely\nfor another application, domain, or both.\n\nThe hacker selected the **UI Redressing (Clickjacking)** weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\n\n**URL**\nhttps://portal.nextcloud.com/login.php\n\n**Can a victim be tricked into unknowingly initiating a specific action?**\nYes\n\n**What specific action can the user be tricked into?**\nThis is the nexcloud login page, it can trick user login or forgot password function","vulnerability_information_html":"\u003cp\u003eHello Security,\u003cbr\u003e\nClickjacking (User Interface redress attack, UI redress attack, UI redressing) is a malicious technique of tricking a Web user into clicking on something different from what the user perceives they are clicking on, thus potentially revealing confidential information or taking control of their computer while clicking on seemingly innocuous web pages.\u003cbr\u003e\nThe server didn\u0026#39;t return an X-Frame-Options header which means that this website could be at risk of a clickjacking attack. The X-Frame-Options HTTP response header can be used to indicate whether or not a browser should be allowed to render a page in a \u0026lt;frame\u0026gt; or \u0026lt;iframe\u0026gt;. Sites can use this to avoid clickjacking attacks, by ensuring that their content is not embedded into other sites.\u003cbr\u003e\nThis vulnerability affects Web Server.\u003cbr\u003e\nIMPACT:\u003cbr\u003e\nAn attacker can host this domain in other evil site by using iframe and if a user fill the given filed it can directly redirect as logs to attacker and after its redirect to your web server.. its lead to steal user information too and use that host site as phishing of your site its CSRF and Clickjacking\u003c/p\u003e\n\n\u003cp\u003ePOC:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eopen \u003ca title=\"https://portal.nextcloud.com/login.php\" href=\"/redirect?url=https%3A%2F%2Fportal.nextcloud.com%2Flogin.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://portal.nextcloud.com/login.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e or \u003ca title=\"https://nextcloud.com\" href=\"/redirect?url=https%3A%2F%2Fnextcloud.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://nextcloud.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\n\u003c/li\u003e\n\u003cli\u003ePut the url in the below code of iframe\n\u0026lt;html\u0026gt;\n\u0026lt;body\u0026gt;\n\u0026lt;iframe \nsandbox=\u0026quot;allow-modals allow-scripts allow-forms allow-popups allow-same-origin\u0026quot;\nsrc=\u0026quot;https://portal.nextcloud.com/login.php\u0026quot; width=600 height=400\u0026gt;\n\u0026lt;/iframe\u0026gt;\n\u0026lt;/body\u0026gt;\n\u0026lt;/html\u0026gt;\n3.Observe that site is getting displayed in Iframe\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eBy using Clickjacking technique, an attacker hijack\u0026#39;s click\u0026#39;s\u003cbr\u003e\nmeant for one page and route them to another page, most likely\u003cbr\u003e\nfor another application, domain, or both.\u003c/p\u003e\n\n\u003cp\u003eThe hacker selected the \u003cstrong\u003eUI Redressing (Clickjacking)\u003c/strong\u003e weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eURL\u003c/strong\u003e\u003cbr\u003e\n\u003ca title=\"https://portal.nextcloud.com/login.php\" href=\"/redirect?url=https%3A%2F%2Fportal.nextcloud.com%2Flogin.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://portal.nextcloud.com/login.php\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eCan a victim be tricked into unknowingly initiating a specific action?\u003c/strong\u003e\u003cbr\u003e\nYes\u003c/p\u003e\n\n\u003cp\u003e\u003cstrong\u003eWhat specific action can the user be tricked into?\u003c/strong\u003e\u003cbr\u003e\nThis is the nexcloud login page, it can trick user login or forgot password function\u003c/p\u003e\n","weakness":{"id":74,"name":"UI Redressing (Clickjacking)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":294073,"file_name":"poc.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/294/073/bcdf6630276dda67c2323aa01a3c42d6e8d3acb3/poc.png?response-content-disposition=attachment%3B%20filename%3D%22poc.png%22%3B%20filename%2A%3DUTF-8%27%27poc.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQXTSUKMQR%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T054043Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICj7knYENMnZh5A0NglwhkrcefT2BpvxRPeuGap0VUVRAiAmn0d7G6cOHj4E%2FKnqMO8ijTpfdfQo0l3AXDA9%2BVALKyq0AwhVEAEaDDAxMzYxOTI3NDg0OSIM%2FiUJtIxCtzL546wIKpEDje0AX20BGKjUrOSYKWZEdzHWjKRP8eQkcBUNH01qDuCwWFb492oSkH%2FEbtHYsr08fP7HLp%2BTd6LcNHSrDFB9d%2BFYETRUG%2BADKmSGmr3Nwq3xqOP7v1EpWK%2BMEc71vsf2gHyy2w59dToZZzlFf2LAOtvhw7zU2wPf4yKeKdDuOWSWY%2FYHF9%2FAyxR3PD619mcgslnZ5pnYBzX6KdEFvaj1f6s0iYObvLdLHSGri%2BDq6ie%2BP8QhqPHtP8GrAkyOULwf0RxusfkoOYlk6RCSPeGnc%2B%2F0xS4Z3WGTX1xspZfXd0eNVxbwMndOmyXOgV4rAgYhogZMCF8CUdB54myomh4lvN8GC6ZOidewqvFMUYwvJDtcv5pamoBOKfBja9zALg1XyMVI0veiuhxW3yKuxhVLdNKxYadV6pexYwarFA3FPF7h4jC%2F4kY3598KIMbOh7q27L9WfbepKiXnfyh29KSGWxJCVMqZfME%2F5fKTENVzxThmVhSuR%2BN%2FKLX7fsytnAWZSmFjtkQ0xLsf2eZqtVvhJBAwkdSq%2FwU67AHKBp0gQe3TLXIgmEnz83bIH2CwQkZMzah2yfBPWtq0ZmAtH%2B0SUMwvTFocxndYggkQSymMXlnMxSrW%2BShlOraR%2FvJ3Ray4%2FLsf09Cb2XaPSrPR5Wx1KvVAyb2Z18jluSP%2Fm5hPR5XJ4tbNBRxfzhgRI1u4O97hl5qsWT1DT7hNdHJ0BNkn7AUS4VJKTLipMdxmxf4j4xDx5eEMqe7Wr5xoy56daL76ywzY%2F7%2B2Yy7SSE3lpZivXSYx0hn1jJAOzsp%2BLLnwo599EX%2FHSD0E4ZBDvjofSUuw6iva2j9O%2BZyk3WJc%2FbmM7LEVw1QRhA%3D%3D\u0026X-Amz-Signature=898fd5650d9542fbb04ed2bc46b64758044c058e4c71164269f6214cfaf7e36f","file_size":85203,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":7,"voters":["tems","cryptographer","sulimanalkhadr","pcmechanic","yahialachrem","facmagsbtfo","snip3rgh0st"],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":49,"asset_type":"URL","asset_identifier":"https://portal.nextcloud.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":2703974,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","markdown_message":"\u003cp\u003eThanks a lot for reporting this potential issue back to us!\u003c/p\u003e\n\n\u003cp\u003eOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we\u0026#39;d like to ask you to not disclose this issue to any other party.\u003c/p\u003e\n","automated_response":true,"created_at":"2018-05-05T15:38:24.103Z","updated_at":"2018-05-05T15:38:24.103Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2707037,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"Quote from other duplicates of this:\n\u003e The lack of X-Frame-Options does not always indicate that a security vulnerability is present. This is an optional header that is only necessary on endpoints where there UI is rendered to invoke state changing actions. We recommend reading this informative post by David Ross: https://plus.google.com/u/0/+DavidRossX/posts/jVrtTRd5yKP","markdown_message":"\u003cp\u003eQuote from other duplicates of this:\u003c/p\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003eThe lack of X-Frame-Options does not always indicate that a security vulnerability is present. This is an optional header that is only necessary on endpoints where there UI is rendered to invoke state changing actions. We recommend reading this informative post by David Ross: \u003ca title=\"https://plus.google.com/u/0/+DavidRossX/posts/jVrtTRd5yKP\" href=\"/redirect?url=https%3A%2F%2Fplus.google.com%2Fu%2F0%2F%2BDavidRossX%2Fposts%2FjVrtTRd5yKP\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://plus.google.com/u/0/+DavidRossX/posts/jVrtTRd5yKP\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n","automated_response":false,"created_at":"2018-05-07T07:20:56.498Z","updated_at":"2018-05-07T07:20:56.498Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5228207,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-01T10:02:14.944Z","updated_at":"2019-07-01T10:02:14.944Z","first_to_agree":true,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5228208,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2019-07-01T10:02:23.693Z","updated_at":"2019-07-01T10:02:23.693Z","actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}