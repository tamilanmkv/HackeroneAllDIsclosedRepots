{"id":85624,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NTYyNA==","url":"https://hackerone.com/reports/85624","title":"Highly wormable clickjacking in player card","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-08-30T06:43:37.878Z","submitted_at":"2015-08-30T06:43:37.878Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"filedescriptor","url":"/filedescriptor","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-05-17T23:11:28.495Z","bug_reporter_agreed_on_going_public_at":"2018-05-14T13:56:16.370Z","team_member_agreed_on_going_public_at":"2018-05-17T23:11:28.388Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\r\nI would like to report an issue where player card is vulnerable to clickjacking in certain browsers. This may result in something similar to XSS worm and many other critical damages.\r\n\r\n##Details\r\nTwitter Player Card allows a website to embed a custom player(html) into an iframe in a tweet. There are currently 2-3 security features in place to defend clickjacking on Twitter:\r\n1. ```X-Frame-Options: SAMEORIGIN``` covering the whole twitter.com domain\r\n2. ```Content-Security-Policy: frame-ancestors 'self'``` ditto\r\n3. JS-based frame-buster in some pages (but not all)\r\n\r\nFor (1), SAMEORIGIN only checks if the embedded frame is on the same origin of the top window. For example, attacker can do something like twitter.com -\u003e attacker.com -\u003e twitter.com to evade it. More details can been seen from here: https://bugzilla.mozilla.org/show_bug.cgi?id=725490 \r\nFor (2), this is the only way to correctly prevent framing from other websites (it performs the check against the ancestor list). However this is a CSP2 directive so not all browsers support it. For example, Safari and IE do not support it.\r\nFor (3), using the sandbox attribute of iframe can disable JS of a frame, hence anti-frame-buster\r\n\r\nSince Player Card is shown on a Tweet (on twitter.com), attacker can embed an iframe which embeds a Twitter page so that attacker can overlay it with \"bait\" content to lure victims to click on it.\r\n\r\nThe impact is huge because of the following facts:\r\n* The card displays directly on the user's timeline, making the attack less suspicious to normal clickjacking\r\n* The click is very subtle that victims cannot notice what's happened behind the scene\r\n* Wormable because attacker can make victims tweet arbitrary content to spread it\r\n* Can perform click-based critical actions, like follow, retweet, favorite... etc\r\n* If sent as promoted tweet, it can target even more victims, also player is directly expanded\r\n\r\n##Repo step\r\n1. Clone the Player Card started bundle here: https://github.com/twitterdev/cards\r\n2. Change the card's property *twitter:player* to a custom HTML file\r\n3. In the HTML file, embed iframe to a Twitter page, e.g. ```\u003ciframe src=\"//twitter.com\"\u003e\u003c/iframe\u003e```\r\n4. Post the link in a Tweet (make sure the domain is white-listed)\r\n5. Expand the tweet in Safari or IE, it will show that a Twitter page is embedded\r\n\r\nDocumentation of Player Card: https://dev.twitter.com/cards/types/player\r\n\r\n##PoC\r\n\r\nhttps://twitter.com/AttackerCanvas/status/637859735501279232 (**Open with Safari or IE**)\r\n\r\nVideo demo: https://vimeo.com/137725491 (password: click)\r\n\r\nThe PoC demonstrates how the attack can be conducted. There will be a fake video to lure victims to click to play it. After clicking the victim will automatically post a tweet with content \"Pwn3d!\".","bounty_amount":"5040.0","formatted_bounty":"$5,040","weakness":{"id":74,"name":"UI Redressing (Clickjacking)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-06-13T13:56:16.444Z","allow_singular_disclosure_after":-105068323.820258,"singular_disclosure_allowed":true,"vote_count":127,"voters":["test0x00","jokebookservice1","natanalves01001","sp1d3rs","europa","kapytein","mvc","mashoud1122","jobert","hunter","and 117 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":568346,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The fix is very tricky here considering the usage of Player Card. For example using the sandbox attribute will break all player cards because plugins are also disabled. One workaround is to insert a JS snippet in all twitter page to check the frame ancestors, but then attackers can still use the sandbox attribute to disable the JS. The ultimate fix would be to change the way Player Card behaves.\n\nOh by the way TweetDeck is also affected but the PoC may need adjustments.","automated_response":false,"created_at":"2015-08-30T07:05:40.231Z","updated_at":"2015-08-30T07:07:28.854Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":576050,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here is a more delicate and stealthy PoC with maximum damage:\nhttps://twitter.com/AttackerCanvas/status/639465287629144064\nVideo demo: https://vimeo.com/138212863 (password: app)\n\nVictim will see it as a normal embedded YouTube video, and it can be interacted properly (click to play). Victims will definitely not notice anything. Behind the scene the victim is actually clicking on the Authorize button on a fake app with full read, write permission, so that attacker can gain long-term control over the victim. Besides it is easy to fake an legitimate app (like Twitter for iPhone), so even victims notice there is a new app that has access to his/her account he/she would not be able to distinguish it.","automated_response":false,"created_at":"2015-09-03T16:12:53.330Z","updated_at":"2015-09-03T16:14:00.435Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":576176,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2015-09-03T17:17:27.097Z","updated_at":"2015-09-03T17:17:27.097Z","actor":{"username":"bfd","cleared":false,"url":"/bfd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/639/cb4711f9ee63746ad25d3c68fdef609f4ea84711_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":585403,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned weâ€™ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","automated_response":false,"created_at":"2015-09-11T17:35:14.315Z","updated_at":"2015-09-11T17:35:14.315Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"5040.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"filedescriptor","url":"/filedescriptor"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1069018,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2016-07-14T15:53:42.643Z","updated_at":"2016-07-14T15:53:42.643Z","actor":{"username":"bfd","cleared":false,"url":"/bfd","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/639/cb4711f9ee63746ad25d3c68fdef609f4ea84711_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"filedescriptor","url":"/filedescriptor"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1074590,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's what I observe:\n1. Player card now requires a click to open \n2. New applications for player cards now use iframe sandbox by default\n\nI wouldn't say the fix is perfect but given that it's a mitigation for the specifications this should be sufficient.","automated_response":false,"created_at":"2016-07-18T19:42:18.427Z","updated_at":"2016-07-18T19:42:18.427Z","actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2739512,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2018-05-14T13:56:16.401Z","updated_at":"2018-05-14T13:56:16.401Z","first_to_agree":true,"actor":{"username":"filedescriptor","cleared":true,"url":"/filedescriptor","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2759261,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Approved","automated_response":false,"created_at":"2018-05-17T23:11:28.416Z","updated_at":"2018-05-17T23:11:28.416Z","actor":{"username":"aarun","cleared":false,"url":"/aarun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/486/bcf774a6460ff9e33545235af9344be33732008d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2759262,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-05-17T23:11:28.527Z","updated_at":"2018-05-17T23:11:28.527Z","actor":{"username":"aarun","cleared":false,"url":"/aarun","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/166/486/bcf774a6460ff9e33545235af9344be33732008d_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":7460,"category":"researcher","content":"https://blog.innerht.ml/google-yolo/","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":9081,"username":"filedescriptor","name":"filedescriptor","bio":"\\\"","cleared":true,"website":"https://www.youtube.com/channel/UCCp25j1Zh9vc_WFm-nB9fhQ","location":"","created_at":"2014-08-16T03:54:09.722Z","url":"https://hackerone.com/filedescriptor","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}}]}