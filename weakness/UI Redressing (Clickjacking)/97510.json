{"id":97510,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NzUxMA==","url":"https://hackerone.com/reports/97510","title":"Following a User After Favoriting Actually Follows Another User (related to #95243)","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-11-03T21:43:56.140Z","submitted_at":"2015-11-03T21:43:56.140Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ericr","url":"/ericr","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/965/8e3881ef9e10824c3f2e34adb21290c7d4db79d1_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":61,"url":"https://hackerone.com/twitter","handle":"twitter","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Twitter","twitter_handle":"twittersecurity","website":"https://twitter.com","about":"Twitter helps you create and share ideas and information instantly, without barriers."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-12-02T17:42:20.929Z","bug_reporter_agreed_on_going_public_at":"2015-12-02T17:27:33.520Z","team_member_agreed_on_going_public_at":"2015-12-02T17:42:20.710Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hi,\n\nThere appears to be a bug similar to #95243 which affects following a user after favoriting one of their tweets via an Intent dialog.\n\nThe following is a proof of concept:\n\nhttps://twitter.com/intent/favorite/?tweet_id=661625230297821184\u0026screen_name=ericrtest3\n\nThe screen_name param submits with the favorite form and ends up getting injected into the follow param on the resulting page.\n\nThis isn't quite as bad as the previous vulnerability I found, since it requires an additional step (favoriting a tweet) to exploit. However, the impact is exactly the same as the last vulnerability, in that the user has no idea that they're actually following a completely different user.\n\nPlease let me know if you have any other questions.","bounty_amount":"280.0","formatted_bounty":"$280","weakness":{"id":74,"name":"UI Redressing (Clickjacking)"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-01-01T17:27:33.769Z","allow_singular_disclosure_after":-182297998.90188608,"singular_disclosure_allowed":true,"vote_count":0,"voters":[],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":643506,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry, the above should read:\n\nThe screen_name param submits with the favorite form and ends up getting injected back into the follow **form** on the resulting page.","automated_response":false,"created_at":"2015-11-03T21:45:35.993Z","updated_at":"2015-11-03T21:45:35.993Z","actor":{"username":"ericr","cleared":false,"url":"/ericr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/965/8e3881ef9e10824c3f2e34adb21290c7d4db79d1_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":645349,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Thank you for the report. \n\nSince report #95243 has been fixed, we're having trouble reproducing this issue. From your PoC, we can see that the user ID is being passed to the URL in the second page. However upon clicking the follow button, we follow the original owner of the Tweet (as intended). Can you provide a set of images or a video that demonstrates this exploit in more detail? \n\nThank you for thinking of Twitter security. ","automated_response":false,"created_at":"2015-11-04T16:17:56.984Z","updated_at":"2015-11-04T16:17:56.984Z","actor":{"username":"bugtriage-josh","cleared":false,"url":"/bugtriage-josh","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":645430,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi,\n\nHuh, that's strange. It definitely appears to be working for me. After favoriting the tweet in the above PoC link, I am redirected to this URL:\n\nhttps://twitter.com/intent/favorite/complete?tweet_id=661625230297821184\u0026screen_name=ericrtest3\u0026already_favorited=false\n\nThis is where clicking \"follow\" ends up following ericrtest3 instead of the original author of the tweet I just favorited.\n\nWhat appears to be happening is that the form submission url references the correct user, but the user_name input that was injected gets sent along with the post request and overrides it. Please see the attached request_body.png for a screenshot of what I'm talking about.\n\nI've also attached a video PoC.\n\nPlease let me know if you have any additional questions.","automated_response":false,"created_at":"2015-11-04T16:51:18.234Z","updated_at":"2015-11-04T16:51:18.234Z","actor":{"username":"ericr","cleared":false,"url":"/ericr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/965/8e3881ef9e10824c3f2e34adb21290c7d4db79d1_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":60260,"filename":"request_body.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/060/260/c2016f178c6c6c56d7bc110553ae187ef3e6967a/request_body.png?response-content-disposition=attachment%3B%20filename%3D%22request_body.png%22%3B%20filename%2A%3DUTF-8%27%27request_body.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154732Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=972bfb7d661ce58395dfb51e1e5cebc6bcc888072379a79f8d6047de60c0b31a"},{"id":60262,"filename":"97510.mov","type":"video/quicktime","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/060/262/7a973e1f761c700883b1e5807b996273690ce366/97510.mov?response-content-disposition=attachment%3B%20filename%3D%2297510.mov%22%3B%20filename%2A%3DUTF-8%27%2797510.mov\u0026response-content-type=video%2Fquicktime\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQQUWX32YR%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T154732Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJIMEYCIQDI60ST6nG4q4laTSFldIqSXi%2FaRkkQyutm5GwT0cJIZgIhAOZhMg3jBlju6Int%2BeeUm1aiBO7rhlrQcLIk%2Bgf6D%2BEDKoMECO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgwXNLBv9MILvVoorSoq1wOfX3WD6Q7XyleYeGc645Essao0xgUb9KvTqDMYcvHVGFjpYncM47xpmv3HMsu%2F5W1XrLh7mNNldxl0sp09zO40TE5Gv3tk2fKUJkR%2FD6XSYmqjjSQ1X8rpbrso174vGjaIUSzY97sO%2Fd37gH6ZpB7ew%2Fv3oEvinQIGLVJR0eRzLhiviACbbOMKLVbWbamWcEPt5JM%2BAi%2F9NdNl7YuEpr2x1Aba%2FQ7SrG7ebdm1DcE0lVqIqx0ztrFvl3nirCMo74N6ge1UFzEhWH44%2BFZEehSLzVwe3%2F%2FBZFO65bGyxbdcPGK84GPYyTmQ%2BjLOaldd7KqAdRhPjDfqVNtwC3oWvVdxRnK%2FoQIrzUgaia36mrU%2B9zb4%2FRhBIhVDxcpxUM1gkKjO26kCJizTpuEecHCYqUizMVCu%2BZHsHDBDtIkkSFfQ%2B2gv2sFyQKltKMSVLAEHz02kDaXPYdZgNpJpJb5mig7chRqoJheUFMk5FqS9E%2FlqeZ5JfW22b6sOCLD%2FEMKSDTLFHVl3btbPUCjyHfhmlMXnpBRHVIqKR1wYVgjD5A7%2FSBEWiHu7RrZzNRZghQJBq1L32qmueS8YHqpboqJLILIuPtnLxC99DFuXuovAM4duMqxEoPDhN0Mw3oyRiwY6pAEUCR%2BsNQPvZhxAQDP4H0mmjcS7kJOELluaCLhnFR0avdVxZaYB9x8Q%2B1vVVuMQVfHNSrjWJl4H%2Be5xJlQ6IIY3JmCIpBdpvoYal7a%2B64IuQyPvQqpHA3Ie7oP5I5O%2F9TxjNDzuk8S48F6Uu5xP3VWBG1thWt0Ez9VpERdwmSl9%2FKYIOOCQmgzrHUQhmsthA0Nah76KucMZDyOmhK8c6RFPBq%2BuQw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=958c425f927c741c6cdd341195dc85768dd8454edda70db61003d38eb5a09a2a"}],"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":647539,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We believe it may be a valid security issue and will investigate it further. It could take some time to find and update the root cause for an issue, so we thank you for your patience.\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2015-11-06T01:35:39.717Z","updated_at":"2015-11-06T01:35:39.717Z","actor":{"username":"arkadiyt","cleared":false,"url":"/arkadiyt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":648814,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks again. As mentioned we’ll keep you updated as we investigate further. As a reminder, please remember to keep the details of this report private until we have fully investigated and addressed the issue.","automated_response":false,"created_at":"2015-11-06T22:12:21.072Z","updated_at":"2015-11-06T22:12:21.072Z","actor":{"url":"/twitter","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/061/85a63a443f017ad8353de4f68ebf52fdd61c345a_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Twitter"}},"bounty_amount":"280.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"twitter","collaborator":{"username":"ericr","url":"/ericr"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":648839,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fantastic, will do of course. Thank you for the bounty.\n\nAs a side note, do I need to request public disclosure after a bug has been fixed and both Twitter and I have verified the fix? I would like to eventually blog about these bugs.","automated_response":false,"created_at":"2015-11-06T22:17:28.386Z","updated_at":"2015-11-06T22:23:04.253Z","actor":{"username":"ericr","cleared":false,"url":"/ericr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/965/8e3881ef9e10824c3f2e34adb21290c7d4db79d1_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":648967,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @erirc,\n\nYes, you can request public disclosure through the HackerOne interface once the issue has been marked as \"resolved\". However since #95243 is very similar to this issue we will postpone approving disclosure of that issue until this issue is addressed. Please refrain from disclosing information about #95243 until this issue is addressed (marked as resolved).\n\nThank you for thinking of Twitter security!\n","automated_response":false,"created_at":"2015-11-06T23:36:25.231Z","updated_at":"2015-11-06T23:36:25.231Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":697893,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi,\n\nCurious to know what the status of this bug is. Thanks.","automated_response":false,"created_at":"2015-11-24T17:51:04.563Z","updated_at":"2015-11-24T17:51:04.563Z","actor":{"username":"ericr","cleared":false,"url":"/ericr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/965/8e3881ef9e10824c3f2e34adb21290c7d4db79d1_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":697936,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The fix is going through review - we hope to have it out soon™.","automated_response":false,"created_at":"2015-11-24T18:10:54.185Z","updated_at":"2015-11-24T18:10:54.185Z","actor":{"username":"arkadiyt","cleared":false,"url":"/arkadiyt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":697956,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Fantastic, I appreciate the update.","automated_response":false,"created_at":"2015-11-24T18:18:42.849Z","updated_at":"2015-11-24T18:18:42.849Z","actor":{"username":"ericr","cleared":false,"url":"/ericr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/965/8e3881ef9e10824c3f2e34adb21290c7d4db79d1_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":705176,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"We consider this issue to be fixed now. Can you please confirm?\n\nThank you for helping keep Twitter secure!","automated_response":false,"created_at":"2015-12-01T23:09:53.661Z","updated_at":"2015-12-01T23:09:53.661Z","actor":{"username":"arkadiyt","cleared":false,"url":"/arkadiyt","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ericr","url":"/ericr"},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":706139,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes, I can confirm that this has been resolved.","automated_response":false,"created_at":"2015-12-02T17:27:07.764Z","updated_at":"2015-12-02T17:27:07.764Z","actor":{"username":"ericr","cleared":false,"url":"/ericr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/965/8e3881ef9e10824c3f2e34adb21290c7d4db79d1_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":706140,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I would like to write a blog post detailing my findings, and as such request public disclosure.","automated_response":false,"created_at":"2015-12-02T17:27:33.551Z","updated_at":"2015-12-02T17:27:33.551Z","first_to_agree":true,"actor":{"username":"ericr","cleared":false,"url":"/ericr","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/965/8e3881ef9e10824c3f2e34adb21290c7d4db79d1_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":706165,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-12-02T17:42:20.741Z","updated_at":"2015-12-02T17:42:20.741Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":706166,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-12-02T17:42:20.956Z","updated_at":"2015-12-02T17:42:20.956Z","actor":{"username":"andrewsorensen","cleared":false,"url":"/andrewsorensen","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"twitter","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}