{"id":520717,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MjA3MTc=","url":"https://hackerone.com/reports/520717","title":"Old WebKit HTML agent in Template Preview function has multiple known vulnerabilities leading to RCE","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2019-04-02T08:35:17.150Z","submitted_at":"2019-04-02T08:35:17.150Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ajxchapman","url":"/ajxchapman","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":27778,"url":"https://hackerone.com/lob","handle":"lob","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/3iuWdLmeoKPjJgXWBF5QNiSn/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/3iuWdLmeoKPjJgXWBF5QNiSn/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Lob","twitter_handle":"lob","website":"https://lob.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-04-23T20:37:09.412Z","bug_reporter_agreed_on_going_public_at":"2019-04-23T20:33:30.866Z","team_member_agreed_on_going_public_at":"2019-04-23T20:37:09.331Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nThe Template Preview function allows users to render arbitrary HTML to a PDF document, this includes the ability to execute arbitrary Javascript. The HTML agent used to render the HTML is based on an old version of WebKit which has known security issues, for which public exploits and Proof of Concepts (PoCs) are available. Exploitation of these issues could lead to Remote Code Execution (RCE) on the AWS instance running the HTML renderer, potentially exposing sensitive user or configuration data.\n\n## Details:\nThe WebKit agent version appears to date from ~2013 based on version numbers and feature availability. This version has multiple known vulnerabilities for which many public exploits are available.\n\nSpecifically, the following resources demonstrate exploiting a memory leak and a Use after Free (UaF) issue to gain Remote Code Execution in a vulnerable WebKit version:\n* https://github.com/Cryptogenic/PS4-5.05-Kernel-Exploit/blob/master/expl.js\n* https://github.com/AlexAltea/orbital/blob/master/tools/dumper/exploit/500/index.html\n\nThese exploits are targeted at a different version and system (PlayStation 4) so do not directly result in RCE on against the Template Preview WebKit agent. However, the techniques they use can be translated to target the WebKit agent used. \n\nI have translated the two key exploit techniques used in the above exploits to target the Template Preview agent (see `Steps to Reproduce`). The first PoC I have produced exploits the memory leak to disclose internal process heap memory pointers. The second PoC demonstrates the UaF issue by completely crashing the Template Preview WebKit agent.\n\nIt should be noted at this point I have not invested the time to fully translate these exploits to gain RCE on Template Preview WebKit agent. Based on the results observed, successfully exploiting the memory leak and UaF, it would just be a matter of effort to achieve this.\n\n## Steps To Reproduce:\n\nTo demonstrate the identified memory leak issue create a new HTML Template with the following contents:\n```html\n\u003chtml\u003e\n\u003cbody\u003e\n  \u003ciframe style=\"width: 100%; min-height: 20000px;\" src=\"http://www.webhooks.pw/static/pocs/78d20a750cd8c80697746e60cfde103773ea1c02/leak.html\"\u003e\u003c/iframe\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nTo demonstrate the identified Use after Free issue create a new HTML Template with the following contents:\n```html\n\u003chtml\u003e\n\u003cbody\u003e\n  \u003ciframe style=\"width: 100%; min-height: 20000px;\" src=\"http://www.webhooks.pw/static/pocs/78d20a750cd8c80697746e60cfde103773ea1c02/crash.html\"\u003e\u003c/iframe\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n```\n\nOnce the template is created, preview the template using the `Preview` function. This will cause the backend WebKit agent to render the given HTML page hosted at `http://www.webhooks.pw/static/pocs/78d20a750cd8c80697746e60cfde103773ea1c02/`. \n\n`leak.html` exploits the memory leak vulnerability to extract a 64bit pointer into the process heap where JSObjects are created. The screenshots below show the output of two separate runs of this template:\n{F459846} {F459847}\nIn these screenshots you can clearly see that the memory location leaked changes, this is due to the ASLR memory randomisation application to the process when it is started. Each time this template is previewed the pointer disclosed will be slightly different due to ASLR. The full PDF files are available as attachments {F459840} and {F459839}\n\n`crash.html` demonstrates the Use after Free vulnerability by crashing the WebKit renderer. The screenshot below details the error displayed to the user when this template is rendered, indicating that the WebKit agent crashed without producing any output:\n{F459843}\n\n## Supporting Material/References:\n\nAttachments {F459840} and {F459839} show the output of two separate runs of this template. In these generated PDF files you can clearly see that the memory location leaked changes, this is due to the ASLR memory randomisation application to the process when it is started.\n\nAddition resources detailing the specific vulnerabilities targeted in this report:\n* https://bugs.chromium.org/p/project-zero/issues/detail?id=1187\n* https://github.com/Cryptogenic/Exploit-Writeups/blob/master/WebKit/setAttributeNodeNS%20UAF%20Write-up.md\n\n## Impact\n\nExploitation of this issue could lead to Remote Code Execution on the AWS instance running the HTML renderer, potentially exposing sensitive user or configuration data.","bounty_amount":"1500.0","formatted_bounty":"$1,500","weakness":{"id":50,"name":"Use After Free"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":459839,"file_name":"leaked_address2.pdf","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/459/839/d68df55d33009bca57628f2e161b5d325eaec2a8/leaked_address2.pdf?response-content-disposition=attachment%3B%20filename%3D%22leaked_address2.pdf%22%3B%20filename%2A%3DUTF-8%27%27leaked_address2.pdf\u0026response-content-type=application%2Fpdf\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150901Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d14fd3c01116c8f34f408c8910dbfe6a15ada62facd05adb339d204271e8a54e","file_size":61223,"type":"application/pdf"},{"id":459840,"file_name":"leaked_address1.pdf","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/459/840/f5d92b4849c5858b671c77cfed0fade884342f26/leaked_address1.pdf?response-content-disposition=attachment%3B%20filename%3D%22leaked_address1.pdf%22%3B%20filename%2A%3DUTF-8%27%27leaked_address1.pdf\u0026response-content-type=application%2Fpdf\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150901Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=aaa8697dcbbf04dc72309d28bf129082facf7add5da05c8f56958cbcefe7ef2d","file_size":61120,"type":"application/pdf"},{"id":459843,"file_name":"Screenshot_from_2019-04-02_09-09-47.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/459/843/b91d3800e4c1f34c95af2c18b1e439958bb54d20/Screenshot_from_2019-04-02_09-09-47.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-04-02_09-09-47.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-04-02_09-09-47.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150901Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=5c230de3ed9e66f8b70f1ae146e20248005a6ef1c336869994adff407b1c2346","file_size":21115,"type":"image/png"},{"id":459846,"file_name":"Screenshot_from_2019-04-02_09-32-03.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/459/846/75c34f9d8b890e27e4fd7434d181139ccff72656/Screenshot_from_2019-04-02_09-32-03.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-04-02_09-32-03.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-04-02_09-32-03.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150901Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=38ec7e62c2dfb0f67ec6e2304f1863ab07fc1efcf2add7c8673faf0126d85a26","file_size":30935,"type":"image/png"},{"id":459847,"file_name":"Screenshot_from_2019-04-02_09-32-15.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/459/847/8c905059d855127ac3bed65024c64239e39a52e8/Screenshot_from_2019-04-02_09-32-15.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-04-02_09-32-15.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-04-02_09-32-15.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150901Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ed91bd090a02a1ebefa4d8eb87e88096a4c1c5ba389372da3fa03d3ef24c383d","file_size":31811,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":68,"voters":["poutine_hero","manoelt","spaceraccoon","nytr0gen","checkm50","dee-see","ajxchapman","cdl","foobar7","seczi","and 58 more..."],"severity":{"rating":"critical","score":9.8,"author_type":"User","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"high","integrity":"high","availability":"high"}},"structured_scope":{"databaseId":8204,"asset_type":"URL","asset_identifier":"dashboard.lob.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4442738,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Re-reading this report I realised it might not be obvious that the Template Preview functionality I am referring to is at https://dashboard.lob.com/#/templates, seen in the screenshot below:\n{F459866}","automated_response":false,"created_at":"2019-04-02T09:20:02.211Z","updated_at":"2019-04-02T09:20:02.211Z","actor":{"username":"ajxchapman","cleared":true,"url":"/ajxchapman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":459866,"filename":"Screenshot_from_2019-04-02_10-14-09.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/459/866/6225cb5b415384e47220b4503bae03eb39f36237/Screenshot_from_2019-04-02_10-14-09.png?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-04-02_10-14-09.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-04-02_10-14-09.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T150902Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=657247c48e8356acd0749be4c610a4c88ff32562af4ed5e6ed0b6d7dd8b39433"}],"genius_execution_id":null,"team_handle":"lob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4449905,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2019-04-02T18:00:50.175Z","updated_at":"2019-04-02T18:00:50.175Z","actor":{"username":"arkadiyt-lob","cleared":false,"url":"/arkadiyt-lob","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4495078,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping keep Lob secure!","automated_response":false,"created_at":"2019-04-05T23:04:21.272Z","updated_at":"2019-04-05T23:04:21.272Z","actor":{"url":"/lob","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/3iuWdLmeoKPjJgXWBF5QNiSn/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Lob"}},"bounty_amount":"1500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"lob","collaborator":{"username":"ajxchapman","url":"/ajxchapman"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4495079,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hey Alex,\n\nPer our program policy we're paying out $1500 for this:\n\u003e **RCE Note:** One of the most likely places in our architecture for a RCE to occur is in our content rendering pipeline. As a result we have sandboxed all rendering, such that even if you have full code execution you cannot read the mail content of other customers. Therefore RCEs in our rendering pipeline will only pay out $1500, unless you can find a sandbox escape to read other customers' data, which would then qualify for a full $5000. Any RCE outside of our rendering pipeline would also get a full $5000.\n\nFor some context, we're aware that we are running a very outdated version of QTWebkit which has many known vulnerabilities. We do have plans to move to a more modern headless browser like chromium via puppeteer or similar, but this is a long term project that is multiple quarters away at least.\n\nIn terms of the fix, QTWebkit has been sunset for a while now, but we have backported fixes from Webkit. In particular for the information leak we've backported https://github.com/WebKit/webkit/commit/96884094ef015afbaf4a8dea807a913040a619a6, and for the UAF we've backported https://github.com/WebKit/webkit/commit/44cadb4e739b863def044e794acb6f59529a7db0.\n\nFrom your perspective you'll see the same behavior for both proof of concepts now (browser crash). We believe this should resolve both issues.\n\nThanks for the great report,","automated_response":false,"created_at":"2019-04-05T23:04:32.859Z","updated_at":"2019-04-05T23:04:32.859Z","actor":{"username":"arkadiyt-lob","cleared":false,"url":"/arkadiyt-lob","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"ajxchapman","url":"/ajxchapman"},"genius_execution_id":null,"team_handle":"lob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4509157,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update @arkadiyt-lob, I appreciate the details on the fix.\n\nCheers","automated_response":false,"created_at":"2019-04-08T16:04:32.908Z","updated_at":"2019-04-08T16:04:32.908Z","actor":{"username":"ajxchapman","cleared":true,"url":"/ajxchapman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"lob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4629666,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Hi team, do you have any objections to disclosing this issue? Thanks","automated_response":false,"created_at":"2019-04-23T20:33:30.911Z","updated_at":"2019-04-23T20:33:30.911Z","first_to_agree":true,"actor":{"username":"ajxchapman","cleared":true,"url":"/ajxchapman","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/141/831/67daf6985b76c1867ff3f442fe5910bb329ee0b4_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"lob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4629677,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-04-23T20:37:09.357Z","updated_at":"2019-04-23T20:37:09.357Z","actor":{"username":"arkadiyt-lob","cleared":false,"url":"/arkadiyt-lob","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lob","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4629678,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-04-23T20:37:09.431Z","updated_at":"2019-04-23T20:37:09.431Z","actor":{"username":"arkadiyt-lob","cleared":false,"url":"/arkadiyt-lob","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"lob","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}