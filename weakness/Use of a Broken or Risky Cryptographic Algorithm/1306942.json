{"id":1306942,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMzA2OTQy","url":"https://hackerone.com/reports/1306942","title":"Use of a Broken or Risky Cryptographic Algorithm","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2021-08-16T15:14:50.331Z","submitted_at":"2021-08-16T15:14:50.403Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"418sec","url":"/418sec","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2367,"url":"https://hackerone.com/revive_adserver","handle":"revive_adserver","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/367/4f47a5b4a364515d4bbdc17550d67ea5415363cd_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Revive Adserver","twitter_handle":"revive_adserver","website":"https://www.revive-adserver.com","about":"Revive Adserver is a free open source ad serving system"}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2021-22948"],"singular_disclosure_disabled":false,"disclosed_at":"2021-09-15T12:51:43.134Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2021-09-14T07:46:08.722Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"revive-adserver utilizes a PRNG for session-token generation, this means that an attacker could theoretically be able to generate session tokens at random and take over accounts at random.\n\n[This function does not generate cryptographically secure values, and should not be used for cryptographic purposes.](https://www.php.net/manual/en/function.uniqid.php)\n\nLocation: https://github.com/revive-adserver/revive-adserver/blob/6e665eac9b20ff21c167eae420b73a976f3bb52a/www/admin/lib-sessions.inc.php#L228\n\nReferences: https://www.php.net/manual/en/function.uniqid.php\n\n## Impact\n\nThis vulnerability is capable of allowing mass account takeover by having attackers generate other users' session tokens.","weakness":{"id":41,"name":"Use of a Broken or Risky Cryptographic Algorithm"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2021-10-14T07:46:08.837Z","allow_singular_disclosure_after":238112.19525566,"singular_disclosure_allowed":false,"vote_count":14,"voters":["run_win","0nlymohammed","3x3s","khizer47","akashhamal0x01","cryptographer","fat-fingers","strixus","jessichick","madmikedlx","and 4 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":154,"asset_type":"SOURCE_CODE","asset_identifier":"https://github.com/revive-adserver/revive-adserver","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":13025566,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks for your report. The issue will be fixed in the next release, currently scheduled for mid-september. We will provide a patch here for you to verify the fix beforehand.","automated_response":false,"created_at":"2021-08-17T07:26:55.730Z","updated_at":"2021-08-17T07:26:55.730Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13031067,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks!","automated_response":false,"created_at":"2021-08-17T11:49:26.181Z","updated_at":"2021-08-17T11:49:26.181Z","actor":{"username":"418sec","cleared":false,"url":"/418sec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13127585,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"The attached patch should resolve the issue both for the session ID and the CSRF token.","automated_response":false,"created_at":"2021-08-23T12:45:58.106Z","updated_at":"2021-08-23T12:45:58.106Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"418sec","url":"/418sec"},"attachments":[{"id":1422240,"filename":"h1-1306942.diff","type":"text/x-diff","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/0i7yoy8wuoi6vw18pstaffiypyh5?response-content-disposition=attachment%3B%20filename%3D%22h1-1306942.diff%22%3B%20filename%2A%3DUTF-8%27%27h1-1306942.diff\u0026response-content-type=text%2Fx-diff\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4NIHB2M2%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T133736Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJGMEQCIE3FUcgRK7FM%2F7U9PAkh6%2BI7wZViD1MP1Y8qZWLRN1eUAiAgc4SQu0yGJV%2BOQRn82JsTD2%2Bd2fHZQycxL60pz%2B7CjyqDBAjt%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMkR9JAvrXeOfq9Rc6KtcDp5bGOpV6FTgydp%2FZOb6Bh6HFPtwnCVZfa015OiSuBfCxPwur%2F7aSPKTNE0sy0w9C45qL0zZ1nOQQos0M24uDH67J2wRZXM50ImEA29W1ENYnCggW3Oj1ThbKF4WgRsg%2F9mjcm%2BZmkVxvLoYJ9V%2BPAToGVUPNdCuARshEYKICR0Xo5x6JoDNaCt8Ld9eGqOBMXV3rned7uAPh8EmsbYJGE3kgeYkoAT36Qaqe4UgPgyO9VFwa9aDWRX%2B50CKWSjbjZzr%2BF%2B9jH4MB%2FxFZ4EWRHEor6ZAw08vWfwqAZLqqZdMNm9vuS82Y9DrOKW2mwiXSVAN3ddQvsOMXsKnTXkUhnfuaQmZvTtYFFm%2BIF8eMq92q4rbYHzak7PfNtWyYQ5raA9JIgznaWFJzJX%2BJlzu%2Bu3r2q3jjPLUM80AxozLcRqWVvYBpiIJlFx45cKPkX%2F2%2BeKoncWc%2B6ePWFPme30ZUDKqp6naa4cEDN31MhQC6Orokr1YD%2FJvOnl4SUarbB1%2BVgfPNBbXbzGIn%2BQ51fempHBLdSWygAxQb8EgPDJYVXZxvBJySlPreu1xMH98Dq97W1%2FcRuSdU1ytWMJPT5MEKol3iFlX9S3vBhB4zpCiL0Qjhs8rBVdayMKLXkIsGOqYB2%2BJTBbMxNO8iefRZNNANeiPRoGrUFs7jVSy6MeL55bB1oEjsBrS1ldm2HFxpIsKxeGY%2Fw5R4r6d07DNpzBAlMx0mvj%2FrMVfwHZDUaLkkIW7L5kfZJyauAUQfU1Yr9%2Flzl1bTl9jiK08pDtPhZS7%2FjLscylmOg0jy%2BlazgeqN9hRW54AGkI6XkZty9qqJMe%2BYbSVGEfkYqEbJxp7dv5pFW%2Ftu9oswsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=93dd231a15e811b8d0058ba571016bef5aebc1c2fdbd9ea79cb1b3265aa993cd"}],"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13349293,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"If everything goes according to our plans we will be releasing a new version next week. How would you like to be mentioned of the security advisory (h1 user name, real name, etc)?","automated_response":false,"created_at":"2021-09-07T13:10:50.503Z","updated_at":"2021-09-07T13:10:50.503Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13351343,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey!\n\nThat's great news.\n\nThe original discloser is from our platform huntr.dev, which sponsors $250/month of security research for every public GitHub repository. I've messaged him asking how he'd like to be credited, and will update you once he replies.\n\nIf you'd like to message him directly, I'd be happy to authorise you to access the report page: https://huntr.dev/bounties/0dec4948-d89c-42d5-9661-c24c368c0b6f/\n\nEither an email I can send a magic link to or a GitHub user of your choice would suffice.\n\nThanks again!","automated_response":false,"created_at":"2021-09-07T15:10:37.580Z","updated_at":"2021-09-07T15:10:37.580Z","actor":{"username":"418sec","cleared":false,"url":"/418sec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13444457,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Thanks again for your report. Revive Adserver 5.3.0 will be released today, along with our security advisory and this report will be disclosed as part of the process.","automated_response":false,"created_at":"2021-09-14T07:46:08.759Z","updated_at":"2021-09-14T07:46:08.759Z","first_to_agree":true,"actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13471452,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"As mentioned, disclosing the bug in order for the CVE-ID process to go thrugh.","automated_response":false,"created_at":"2021-09-15T12:51:43.030Z","updated_at":"2021-09-15T12:51:43.030Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13542598,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks. The discloser has responded as follows:\n\nThat sounds great, I'm glad to see this being fixed!\nI'd like to be credited via name (Michael Rowley), email (michaellrowley@protonmail.com) or Github (@michaellrowley) if possible but I'm not too picky so any of them should be fine.\n\nI hope there's still something that can be done to credit him? Apologies for the tardy response!","automated_response":false,"created_at":"2021-09-20T14:53:19.567Z","updated_at":"2021-09-20T14:53:19.567Z","actor":{"username":"418sec","cleared":false,"url":"/418sec","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":13542909,"is_internal":false,"editable":false,"type":"Activities::CveIdAdded","message":"","automated_response":false,"created_at":"2021-09-20T15:07:36.021Z","updated_at":"2021-09-20T15:07:36.021Z","cve_ids":["CVE-2021-22948"],"actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":13542957,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"When published, the CVE-ID should cointain proper credits. If not, this report is public, so the above comment should suffice. Thanks.","automated_response":false,"created_at":"2021-09-20T15:12:05.030Z","updated_at":"2021-09-20T15:12:05.030Z","actor":{"username":"mbeccati","cleared":false,"url":"/mbeccati","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/Vb1MGAtUFpEE4kdMaxxr1ACZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"revive_adserver","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}