{"id":145463,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNDU0NjM=","url":"https://hackerone.com/reports/145463","title":"Nextcloud server software: Content Spoofing","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-06-17T16:31:11.824Z","submitted_at":"2016-06-17T16:31:11.824Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"ishahriyar","url":"/ishahriyar","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/018/459/49b3c418eb2d3dbc8e14a0dee670f4b432ba5f73_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":["CVE-2016-9460"],"singular_disclosure_disabled":false,"disclosed_at":"2016-07-19T10:30:00.935Z","bug_reporter_agreed_on_going_public_at":"2016-07-19T10:30:00.850Z","team_member_agreed_on_going_public_at":"2016-07-19T09:56:43.124Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"In Nextcloud the \"dir\" parameter is vulnerable to content spoofing attack.\nIf anyone puts a valid directory name in dir parameter then it goes that directory other wise it redirects\nto the home directory (/)\nBy putting `../../` in dir parameter I was able to stop the redirect then I had put some messages after that and that messages reflected with the same given format.\n\nSo here an  attacker can send his messages directly through url.  \nPoc link\n`http://192.168.0.118/nextcloud/index.php/apps/files/?dir=../../Welcome+to+Nexcloud+You+can+get+pro+account+by+navigating+this+example.com`\n\nThanks.","bounty_amount":"50.0","formatted_bounty":"$50","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":100008,"file_name":"csnext.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/100/008/59e57420db64276f76b5b6a645fb4bd07db7df4d/csnext.png?response-content-disposition=attachment%3B%20filename%3D%22csnext.png%22%3B%20filename%2A%3DUTF-8%27%27csnext.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQWRDWPEXO%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134226Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDdpfP9zaQzdootuAesQcyxQfGfhPxZKuX1i7ijKLAzlAIgL5my807PEusr0VkqeU29XvZtEmCSLbM%2F7eKmnAELK9MqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDLFQh%2Fbvd7dUg1KFQyrXA%2Fp%2FVtjehJVp7DZYy5u7sRWqZAssugTjxjLMX9n3LuBamcp6G%2Bwyw1kdH5Fc0oMbmVnKCYku75m349ci99IeZGYssnHPQFOGi3KPZcYmBTpCSWJYXklFmUzTDVSnxhcahSThqLhsURXVfnsh6wXSKZz6MsS7fD7HYiuK725Q%2F6sDk7h3pCuB5fUOqyZvOi6e%2FdSM5nyuKqUFkte%2F6i0uholiPHuOhv3puwk%2FK6F%2FiNA6QbCLyZcsFIj5wNcphNxGCbAX8GNv59qxPkBv7zU5QMZhaSRKnyFLoxSNWLKFqeO4qdN%2FgRbEF2RLvY5V1AD1BbElezpO2DYcV6sIiHwCYBPAVtJWc0Oep1T8Sx%2FIWEFxpRS%2B4EQR6%2BcQhrIR2caxSjEaPr13FV3IBlGYyL4TqPiwhW8W9gb3y9c3v7PIUkqs8IYIlAbA%2BK0arNEJfKBmrpxI03L5MtPD0eO6pxGJ9DvZkCWVCaXiTO6oSen4PpDOLghYHo%2B4Vpqvo3%2FpROjCxToAEvdKcvazzutHXo%2FsJlsjoo%2Fmx%2B1Ek92%2BufvnULE1KShcl4rj7BNA4T9Jjuo0ja%2BLxer65UO9tkrad6HgKA9hXXtyDBrlAmhTDWFKsmcmq2ihTQ7PrDCl4pCLBjqlAVM272WWPnlOeGyGQ9vB3AQrwELsHDPU0KiSwP4QYEOtuC3iFTxC%2FXRs42S51Jb7aTjsW4m6tY2xevuwO4tmkEyWJnLxLHRvktGKLmigB4rFLjusFml2FTXw5xWvfY786%2F8KQpyklyKdvZKCIlTGk1BlxxAAC17iJ1VlZV%2BzWSY7WJd1%2Fhm%2BXXw9P5X6Ch%2Fx17cYnn0uAeICgpjy1lOaC5Wkd0STsQ%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=2f127c77ff4c6422382d28f1d251c70ab36335765ca333ef410a204dd38a5a2e","file_size":68661,"type":"image/png"}],"allow_singular_disclosure_at":"2016-08-18T09:56:43.313Z","allow_singular_disclosure_after":-162445543.5515454,"singular_disclosure_allowed":true,"vote_count":2,"voters":["bugdisclose","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1019539,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2016-06-17T16:31:12.013Z","updated_at":"2016-06-17T16:31:12.013Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1020342,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thanks a lot for your report, @ishahriyar and nice to see you here as well!\n\nI can confirm this and will escalate this internally. Once we have more information on this we'll get back to you.","automated_response":false,"created_at":"2016-06-17T22:13:14.635Z","updated_at":"2016-06-17T22:13:14.635Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1025239,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Congratulations! We have determined this to be eligible for a reward of $50. Given the nature of this bug we consider it to be low severity.\n\nThanks a lot for making the internet a safer place and keep rocking/hacking. Please keep in mind that we didn't patch the vulnerability yet, so please do not share this information with any third-parties.","automated_response":false,"created_at":"2016-06-20T19:08:40.339Z","updated_at":"2016-06-20T19:08:40.339Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"bounty_amount":"50.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"nextcloud","collaborator":{"username":"ishahriyar","url":"/ishahriyar"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1025974,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @lukasreschke  for the bounty :) .","automated_response":false,"created_at":"2016-06-21T04:47:59.575Z","updated_at":"2016-06-21T04:47:59.575Z","actor":{"username":"ishahriyar","cleared":false,"url":"/ishahriyar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/459/49b3c418eb2d3dbc8e14a0dee670f4b432ba5f73_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1053572,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks a lot for your report. We believe to have resolved this problem in the [just released 9.0.52 release](https://nextcloud.com/nextcloud-9-update-brings-security-open-source-enterprise-capabilities-and-support-subscription-ios-app/).\n\nWe'd greatly appreciate it if you could take a second to confirm this patch. We'd then proceed as following:\n\n1. In 14 days we will release a detailed advisory describing this vulnerability\n2. We'll request public disclosure of this report at the same time\n\nOur advisories will contain a CVE identifier and credit you for the finding. If you want to be credited differently than written on your HackerOne profile please leave a comment with:\n\n1. Name / Pseudonyme\n2. Company (optional)\n3. Website (optional)\n4. Mail address (optional)\n\nFor obvious reasons we'd appreciate if you would not disclose any information about these vulnerability until the 19th of July 2016.","automated_response":false,"created_at":"2016-07-05T13:04:36.236Z","updated_at":"2016-07-05T13:04:36.236Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"ishahriyar","url":"/ishahriyar"},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1056258,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes the previously described problem has been solved. But it's also taking time to check all inputs/directories. So if anyone puts his messages after a large number of invalid directories then it will reflect the attackers messages for a while until the checking is done.\nThanks.","automated_response":false,"created_at":"2016-07-06T19:32:42.857Z","updated_at":"2016-07-06T19:32:42.857Z","actor":{"username":"ishahriyar","cleared":false,"url":"/ishahriyar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/459/49b3c418eb2d3dbc8e14a0dee670f4b432ba5f73_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1071581,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @lukasreschke  ,\nWhat's the alternative  to be credited instead of being a CVE identifier?","automated_response":false,"created_at":"2016-07-16T05:21:39.940Z","updated_at":"2016-07-16T05:21:39.940Z","actor":{"username":"ishahriyar","cleared":false,"url":"/ishahriyar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/459/49b3c418eb2d3dbc8e14a0dee670f4b432ba5f73_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1073498,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e Yes the previously described problem has been solved. But it's also taking time to check all inputs/directories. So if anyone puts his messages after a large number of invalid directories then it will reflect the attackers messages for a while until the checking is done.\n\nGood catch. We've added a slightly improved patch to the next release, since this is only very timely limited we consider it acceptable risk for now though.\n\n\u003e What's the alternative to be credited instead of being a CVE identifier?\n\nWe're issuing a complete advisory on our website \"nextcloud.com\", on that we will credit you with a name of your choosing and an issue description (as well as a backlink to HackerOne). The CVE will simply cross-reference that item.\n\nIf you want to remain anonymously that's also totally fine, in this case please just let us know!","automated_response":false,"created_at":"2016-07-18T10:44:13.888Z","updated_at":"2016-07-18T10:44:13.888Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1073511,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @lukasreschke ,\n Here the information for  CVE identifier.\nName : Md. Ishrat Shahriyar\nTwitter: https://twitter.com/meshahriyar","automated_response":false,"created_at":"2016-07-18T10:59:09.576Z","updated_at":"2016-07-18T10:59:09.576Z","actor":{"username":"ishahriyar","cleared":false,"url":"/ishahriyar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/459/49b3c418eb2d3dbc8e14a0dee670f4b432ba5f73_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1075618,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"We've published an advisory at https://nextcloud.com/security/advisory/?id=nc-sa-2016-003 and are awaiting the CVE assignment. Thanks a lot again, @ishahriyar for pointing out this vulnerability!","automated_response":false,"created_at":"2016-07-19T09:56:43.198Z","updated_at":"2016-07-19T09:56:43.198Z","first_to_agree":true,"actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1075655,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-07-19T10:30:00.884Z","updated_at":"2016-07-19T10:30:00.884Z","actor":{"username":"ishahriyar","cleared":false,"url":"/ishahriyar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/459/49b3c418eb2d3dbc8e14a0dee670f4b432ba5f73_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1075656,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-07-19T10:30:00.983Z","updated_at":"2016-07-19T10:30:00.983Z","actor":{"username":"ishahriyar","cleared":false,"url":"/ishahriyar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/018/459/49b3c418eb2d3dbc8e14a0dee670f4b432ba5f73_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":2237,"category":"team","content":"The location bar in the files app was not verifying the passed parameters. An attacker could craft an invalid link to a fake directory structure and use this to display an attacker-controlled error message to the user.\n\nA detailed advisory can be found at https://nextcloud.com/security/advisory/?id=nc-sa-2016-003.\n\n------\nThanks a lot, @ishahriyar   for pointing out this vulnerability!","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":37891,"username":"lukasreschke","name":"Lukas Reschke","bio":"","cleared":false,"website":"https://statuscode.ch","location":"Switzerland","created_at":"2015-08-05T13:37:40.660Z","url":"https://hackerone.com/lukasreschke","anc_triager":false,"hackerone_triager":false,"hackerone_employee":false,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBaFlXIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--247fe95a40e99ca7d18708743afb883e8a4441f1/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/878997_(1).png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}