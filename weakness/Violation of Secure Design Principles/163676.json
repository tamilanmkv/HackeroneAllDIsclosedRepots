{"id":163676,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xNjM2NzY=","url":"https://hackerone.com/reports/163676","title":" Legal | Application is Missing CSP(Content Security Policy) Header ","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2016-08-26T22:14:47.426Z","submitted_at":"2016-08-26T22:14:47.426Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"sadhu16","url":"/sadhu16","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/070/036/0d038cea418ac972b0f0410481381c1a11610436_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1601,"url":"https://hackerone.com/legalrobot","handle":"legalrobot","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Legal Robot","twitter_handle":"LegalRobot","website":"https://www.legalrobot.com","about":"Automated legal document review using artificial intelligence"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2016-08-31T06:12:39.693Z","bug_reporter_agreed_on_going_public_at":"2016-08-31T06:12:39.494Z","team_member_agreed_on_going_public_at":"2016-08-29T07:19:39.112Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"-Content Security Policy Header used to allow only source code to execute in the application from the domain mentioned in its list. By using this we can restrict code to execute which is written in application either by developer or by Hacker\n\n-Since application contains no such header i am going to  inject an image from third party domain which is not of application domain\n\n\u003cimg src=\"https://s-media-cache-ak0.pinimg.com/564x/ab/2d/bd/ab2dbda0c6c11455527c0dd34d5f5bf6.jpg\" height=\"500\" width=\"500\"/\u003e\n\nthird party domain\nhttps://s-media-cache-ak0.pinimg.com/564x/ab/2d/bd/ab2dbda0c6c11455527c0dd34d5f5bf6.jpg\n\nRefer-https://www.owasp.org/index.php/Content_Security_Policy_Cheat_Sheet","bounty_amount":"20.0","formatted_bounty":"$20","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":115194,"file_name":"csp_exploit.wmv","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/115/194/d2b97d8ab051df74db0c4c328169ab5265960bfd/csp_exploit.wmv?response-content-disposition=attachment%3B%20filename%3D%22csp_exploit.wmv%22%3B%20filename%2A%3DUTF-8%27%27csp_exploit.wmv\u0026response-content-type=video%2Fx-ms-asf\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134837Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fe10230ae3918b5d59804f293f99fa98038deb8966b0d2bfc039bce12ee09e13","file_size":7354092,"type":"video/x-ms-asf"}],"allow_singular_disclosure_at":"2016-09-28T07:19:39.202Z","allow_singular_disclosure_after":-158912938.79494527,"singular_disclosure_allowed":true,"vote_count":2,"voters":["malcolmx","dyabla"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1156974,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report. Our www subdomain contains no 3rd party content (just static marketing pages) and our app subdomain does provide an extensive CSP header. Can you elaborate on where you think the problem is?\n\nUnfortunately we don't accept wmv or asf files, can you provide screenshots?","automated_response":false,"created_at":"2016-08-26T22:48:43.062Z","updated_at":"2016-08-26T22:48:43.062Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1156976,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2016-08-26T22:49:58.142Z","updated_at":"2016-08-26T22:49:58.142Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1157409,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @danrubins\n\nPlease find the attached screenshots where i have already injected an image from 3rd party server -https://s-media-cache-ak0.pinimg.com/564x/ab/2d/bd/ab2dbda0c6c11455527c0dd34d5f5bf6.jpg\n\nwhich is not listed by your application as its lacking Content Security Policy Header.\n\nIn Screenshots you can clearly see that application is allowing content to be executed in it domain.","automated_response":false,"created_at":"2016-08-27T08:46:25.856Z","updated_at":"2016-08-27T08:46:25.856Z","actor":{"username":"sadhu16","cleared":false,"url":"/sadhu16","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/036/0d038cea418ac972b0f0410481381c1a11610436_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":115253,"filename":"Missing_CSP.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/115/253/079ed476cf7e694cc71090cfdacc0fc616b4ee96/Missing_CSP.png?response-content-disposition=attachment%3B%20filename%3D%22Missing_CSP.png%22%3B%20filename%2A%3DUTF-8%27%27Missing_CSP.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134838Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9124214c85a31feff933195edb1f7fc15dc1dc6d1837800f57e19ff59b52bd36"},{"id":115254,"filename":"csp_-legalrobot.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/115/254/1ca0fb85ad4e37f220d4f2f977cc0fad20121be2/csp_-legalrobot.png?response-content-disposition=attachment%3B%20filename%3D%22csp_-legalrobot.png%22%3B%20filename%2A%3DUTF-8%27%27csp_-legalrobot.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ3XETQKVM%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T134838Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCGITGEBL0GDazIgFIa28tiYmEhXENYyhaNz5SA%2FlGoWgIgUpM2O%2BqLplk1PxLgHvwucUcfaWBDs4lcpMfbeWt8lf0qgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKzBywxhiDPCGniAXCrXA0hN3FmE2a%2FvX745J3E%2FVZOyco%2FXdDJhTa6QLBz8ruxItJd7RBy%2BDgWvdA9F9VhH6hQi1%2BoGROPLiNtVXscv2SAyqwnGAvovNwUJ1XHdXq9csPneVktpMYUl5e6BGW1xCryz1JW0SV%2BUfaSbieJMT38q3eYU9Qxk5dVB%2FFSLDg1wEknhr%2FrXVV%2FyMqUg1dTUYtXEjLNILLRPWX%2F4wv3E6jg3evrZ7gOO5fAJ9yd3K5iXRj4PV28TPJwb4Bp0K3AV23Xw17YRvstL2wS%2FKJ5kkbPQixYXwVbw8yOEBuTf5C9xK0ZT%2BUy2XrR%2BHohMKCcUEmtk4PUYdUQFeneehIWQAkbd4qIQq1wWh3%2BtFZuz9DX0pjS8WWix5bToWfIKFuKulPfC5YwvJmaPyfSRVTaZ6I14bWPkalqD2SgW4Vy%2B09y41yRaXPxOlIrJMFvQS2IEJ1HEHz4ZUR1yXSp0gHeUDD8o18FKUmWJbFX0f4qg6QMujUtz72wUwuuVALx3RPw6LWvm7guP0GVvaCkepTd9y%2FQPIJ5BMWpXjOzk8woMpmPNPVmiY%2B0aJf85ceJPSOr4SQhScx2VlsmYJMnP01anhvN0NHIzV5cw9ydQaVt5O0LNrdQYH%2FIyrzC885CLBjqlAaE%2FfvTfYEPLtbspKR1t8pqzvolC92qkeVrvH%2BpD5KXCuP33P%2Bp2tmR3wVnz2EohJYzmGrrnBvRXs0coN12U37MszdI%2Bvzj6PkJc0Y4l0wDgwvf1eWilxQANi8xmwPgCDVfgGtOQp6uxiNpwW3IAibhcqSDm28IB01CUcpdI9PzabCC%2B8IpU1mKKntGaQJtzs4L%2BAHeAe57KgaMrEoYitz0ixKUbTw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ba2e985bb25c57e284fefed0d88b17d03ef0ce205fea02d1e64e26934a64eaf4"}],"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1157454,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\nTeam in my attached screenshot i have shown that csp headers are not set in response sent by application server please have a look once.\n\nNow as your application is missing content security policy header which makes it possible for attacker to execute the resources or content from 3rd party server to your application and that 3rd party server is not associated to your application anywhere but its being used by an attacker to render malacious content to your application\n\nRefer these links as they might help in specifying the scenario\n\nhttps://www.owasp.org/index.php/Content_Security_Policy_Cheat_Sheet\n\nhttps://corner.squareup.com/2016/05/content-security-policy-single-page-app.html\nhttps://content-security-policy.com/\n\nvideo explanation:\nhttps://www.youtube.com/watch?v=7ksZ4szi0WY\nhttps://www.youtube.com/watch?v=JbfNWg6JS4U\n\nHope this would help you guys :)\n ","automated_response":false,"created_at":"2016-08-27T10:15:23.268Z","updated_at":"2016-08-27T10:15:23.268Z","actor":{"username":"sadhu16","cleared":false,"url":"/sadhu16","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/036/0d038cea418ac972b0f0410481381c1a11610436_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1157893,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you for the additional information. A very similar issue has already been reported for the www subdomain under report #149572. The root cause is that AWS S3 (where we host our static pages for www.legalrobot.com) will not allow us to provide security headers like x-frame-options or content security policy. I see that I've already included you on that report, so keep an eye out there for how this develops. We will award a small bounty for this report since this is a slightly different issue, albeit the same route cause.\n\nWe're going to keep this private until #149572 is resolved, then we'll request public disclosure.","automated_response":false,"created_at":"2016-08-27T20:21:43.716Z","updated_at":"2016-08-27T20:21:43.716Z","actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"sadhu16","url":"/sadhu16"},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1157894,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2016-08-27T20:21:51.167Z","updated_at":"2016-08-27T20:21:51.167Z","actor":{"url":"/legalrobot","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/601/0f164c3d9618b04b006b859517ff032ec57ab42a_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Legal Robot"}},"bounty_amount":"20.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"legalrobot","collaborator":{"username":"sadhu16","url":"/sadhu16"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1159148,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-08-29T07:19:39.174Z","updated_at":"2016-08-29T07:19:39.174Z","first_to_agree":true,"actor":{"username":"danrubins","cleared":false,"url":"/danrubins","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/222/c1d0d51f40e0c570e2153b6801fe54c997c757f0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1164027,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-08-31T06:12:39.551Z","updated_at":"2016-08-31T06:12:39.551Z","actor":{"username":"sadhu16","cleared":false,"url":"/sadhu16","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/036/0d038cea418ac972b0f0410481381c1a11610436_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1164028,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-08-31T06:12:39.717Z","updated_at":"2016-08-31T06:12:39.717Z","actor":{"username":"sadhu16","cleared":false,"url":"/sadhu16","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/070/036/0d038cea418ac972b0f0410481381c1a11610436_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"legalrobot","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}