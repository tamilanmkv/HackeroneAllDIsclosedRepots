{"id":199243,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8xOTkyNDM=","url":"https://hackerone.com/reports/199243","title":"No user confirmation when an auto-updated extension gets more permissions","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-01-18T04:39:31.825Z","submitted_at":"2017-01-18T04:39:31.825Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"i1iii11iiiii111iii1","url":"/i1iii11iiiii111iii1","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-01-20T09:12:43.854Z","bug_reporter_agreed_on_going_public_at":"2017-01-20T09:12:43.788Z","team_member_agreed_on_going_public_at":"2017-01-20T00:00:27.432Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\n\nIn Chrome, when extensions are auto-updated, if the permissions change, the extension is preventatively disabled and the user has to confirm they wish to re-enable it with the additional permissions. While it appears Brave has a functioning Extension auto-updater (e.g. for the PDF extension), a simulation of an update to that Extension suggests that Brave will silently auto-update (and leave enabled) Extensions which request additional permissions.\n\nAgreeing to run a certain extension (which needs a certain set of permissions) is not the same thing as the user consenting for a future update where the permission set grows to include, say, https://*/* or something. Users are shown those permissions in about:extensions and disable extensions that include things that they don't consent to. Auto-update should not be a silent mechanism for third party providers of extensions to elevate their privileges without the user's knowledge.\n\nI realize that, today, the only extension is the PDF viewer, but your recent blog post says you're working on supporting other third party extensions and DevRel says they will use the auto-updater, so this is a heads up that this becomes exploitable once you start supporting other extensions. If that means this doesn't qualify for HackerOne no worries, I am not interested in disclosure or money or whatever just wanted to pass along a friendly note. \n\n## Products affected: \n\nFrom about:brave:\n\nName\tVersion\nBrave\t0.12.15\nMuon\t1.4.31\nlibchromiumcontent\t53.0.2785.143\nV8\t5.3.332.47\nNode.js\t6.5.0\nUpdate Channel\tdev\nos.platform\twin32\nos.release\t10.0.14393\nos.arch\tx64\n\n## Steps To Reproduce:\n\nInstall brave. View about:extensions so that it will auto-open the next time you launch Brave.\nQuit brave.\nNavigate to C:\\Users\\you\\AppData\\Roaming\\brave\\Extensions\\jdbefljfgobbmcidnmpjamcbhnbphjnb in Windows explorer.\n\nRename folder from 1.6.387 to 1.6.385\nOpen folder\nEdit manifest.json to change version number declared in manifest to 1.6.385\nAlso remove \"tabs\" permission from manifest.\n\n(I'm not super familiar with Brave so if there's some other registry of extensions I should have manipulated to better simulate this update scenario, please advise and accept my apologies if this scenario is somehow invalid.)\n\nLaunch Brave\n\nObserved: Brave extension auto-updater kicks in. I briefly saw 1.6.385 in the window before it updated to 1.3.387.\nBrave obtains 1.6.387 and it unpacks it in my extensions folder alongside 1.6.385. Permissions go back to having \"tabs\".\n\nNote that I was only able to reproduce on the first try, second try I had problems. I think I am running into some frequency limit for auto-update checks, I ran through the steps a second time (deleted the 387 folder and bounced Brave again) but this time it didn't auto update so was stuck back at my 1.6.385 simulation.  To get it to reliably reproduce, I had to blow away my entire c:\\Users\\you\\AppData\\Roaming\\brave folder, launch once to get clean appdata, then repeat the steps above. This try (third try) reproduced the problem, so be advised that reproducing this might be a little fiddly. Sorry. Someone familiar with the design of Brave can certainly comment on if this how this was designed to work though - I suspect this may be as-currently-designed behavior?\n\n## Supporting Material/References:\n\nBrave DevRel statement that third party extensions will be coming and updated using this auto-updater:\nhttps://twitter.com/BraveSampson/status/821549058485604352","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-02-19T00:00:27.472Z","allow_singular_disclosure_after":-146498400.20999187,"singular_disclosure_allowed":true,"vote_count":3,"voters":["skansing","eveeez","spetr0x"],"severity":{"rating":"low","author_type":"Team"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1431579,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for noting this. It's a valid design criticism but one that we have avoided addressing until now because the list of extensions is small and curated by us (in fact we maintain our own PDFJS extension fork: https://github.com/diracdeltas/pdf.js). \n\nwould like to open this up for public discussion if that's ok.","automated_response":false,"created_at":"2017-01-19T23:58:26.842Z","updated_at":"2017-01-19T23:58:26.842Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1431582,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"apparently i have to close it to request public disclosure","automated_response":false,"created_at":"2017-01-20T00:00:21.217Z","updated_at":"2017-01-20T00:00:21.217Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"i1iii11iiiii111iii1","url":"/i1iii11iiiii111iii1"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1431583,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-01-20T00:00:27.452Z","updated_at":"2017-01-20T00:00:27.452Z","first_to_agree":true,"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1431635,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Kind of surprised by this response. You claim to be building a browser that's more secure than Chrome. You're going out of your way to enable an exploitation path that Chrome mitigates with user consent, and your alternative mitigation is basically \"people who work at Brave will very carefully review the source code of every update to every third party extension in the curated list we host to make sure nothing bad ever happens.\" That's like saying, we don't need a sandbox, we're going to carefully review code and make sure there's no buffer overflows, it's the difference between security through an architectural feature vs security through nobody ever overlooking something and being perfect all the time.\n\n(Extensions, which, are frequently minified, so I question your ability to curate this effectively from a security review standpoint.)\n\nWe know from the docs on github that extensions like Lastpass are in the early supported list. If lastpass wants to start using geolocation or something, you're just going to make that decision on behalf of the customer?\n\nWhy even have a permission model visible to the user at all, if you're going to let it change out from under the user after they've reviewed the information in about:extensions?\n\nDo you feel any responsibility at all that when you heavily advertise to users that this browser is based off of Chrome, that users have certain security expectations, and when you violate those security expectations (particularly ones around user consent) by adopting intentionally-more-permissive behavior than Chrome, maybe that's a problem?\n\nUltimately, this design choice substitutes the sensibility of Brave for the sensibility of the user. You may not see any problem with some extension's newest version requesting \"access to all web sites\" or geolocation but a customer might.  Your target userbase are, ostensibly, users who are most interested in security. This is really surprising attitude towards the role of their consent.\n\nTo be clear: I'm explicitly disclaiming right now that I have any interest in money or fame for this, so my motivation is not that. I opened a throwaway hackerone account just to report this. I'm not requesting to disclose this (you are) and I'm not going to take any action like clicking the button to disclose immediately, in order to give you the full timeout period to rethink your decision. Thanks for listening.","automated_response":false,"created_at":"2017-01-20T00:52:08.176Z","updated_at":"2017-01-20T00:52:08.176Z","actor":{"username":"i1iii11iiiii111iii1","cleared":false,"url":"/i1iii11iiiii111iii1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1431755,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I should clarify, my reaction above is based on interpreting \"Resolved\" as \"we don't plan to fix this in the forseeable future, we're content to stick with just curating the list of extensions, and we're OK with publicly documenting that.\" If that's not the case then sorry for the miscommunication - it's a little confusing because apparently I got some sort of thank-you points for this which suggests maybe you agree this is a bug but marking it resolved and moving to disclosure seems to suggest there'd be no further action on it.","automated_response":false,"created_at":"2017-01-20T03:07:25.595Z","updated_at":"2017-01-20T03:07:25.595Z","actor":{"username":"i1iii11iiiii111iii1","cleared":false,"url":"/i1iii11iiiii111iii1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1431922,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e I should clarify, my reaction above is based on interpreting \"Resolved\" as \"we don't plan to fix this in the forseeable future, we're content to stick with just curating the list of extensions, and we're OK with publicly documenting that.\"\n\nAbsolutely not, I'm only \"resolving\" this issue so we can open up the discussion to contributors who are not on hackerone (see comment above about \"resolving\" being a prerequisite for public disclosure). We do plan to implement some sort of permissions UX; in fact there have been internal discussions about this already before this issue was posted.","automated_response":false,"created_at":"2017-01-20T06:48:40.693Z","updated_at":"2017-01-20T06:51:25.266Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1432108,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"OK. Seems weird to disclose something before fixing it but if that's how you want to go I'll hit the button.","automated_response":false,"created_at":"2017-01-20T09:09:55.697Z","updated_at":"2017-01-20T09:09:55.697Z","actor":{"username":"i1iii11iiiii111iii1","cleared":false,"url":"/i1iii11iiiii111iii1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1432117,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-01-20T09:12:43.810Z","updated_at":"2017-01-20T09:12:43.810Z","actor":{"username":"i1iii11iiiii111iii1","cleared":false,"url":"/i1iii11iiiii111iii1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1432118,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-01-20T09:12:43.873Z","updated_at":"2017-01-20T09:12:43.873Z","actor":{"username":"i1iii11iiiii111iii1","cleared":false,"url":"/i1iii11iiiii111iii1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1432178,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\u003e OK. Seems weird to disclose something before fixing it but if that's how you want to go I'll hit the button.\n\nThanks. FWIW we are pro early disclosure on issues that are already known or not highly exploitable.","automated_response":false,"created_at":"2017-01-20T09:46:10.318Z","updated_at":"2017-01-20T09:46:10.318Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1432179,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-01-20T09:46:33.463Z","updated_at":"2017-01-20T09:46:33.463Z","additional_data":{"old_severity":"Medium","new_severity":"Low","old_severity_id":20130,"new_severity_id":20605},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2542541,"is_internal":false,"editable":false,"type":"Activities::NotEligibleForBounty","message":"","automated_response":false,"created_at":"2018-03-29T03:00:08.195Z","updated_at":"2018-03-29T03:00:08.195Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2542839,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Did this ever get fixed in Muon or is it only really being fixed by the upcoming move back to being wholesale Chromium?","automated_response":false,"created_at":"2018-03-29T07:16:07.109Z","updated_at":"2018-03-29T07:16:07.109Z","actor":{"username":"i1iii11iiiii111iii1","cleared":false,"url":"/i1iii11iiiii111iii1","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}