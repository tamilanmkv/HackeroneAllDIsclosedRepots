{"id":205250,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDUyNTA=","url":"https://hackerone.com/reports/205250","title":"Missing SPF Flags on nextcloud.com","state":"Closed","substate":"duplicate","readable_substate":"Duplicate","created_at":"2017-02-10T13:37:26.435Z","submitted_at":"2017-02-10T13:37:26.435Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"ph_spade","url":"/ph_spade","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":13291,"url":"https://hackerone.com/nextcloud","handle":"nextcloud","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Nextcloud","twitter_handle":"nextclouders","website":"https://nextcloud.com","about":"Access, share and protect your files, calendars, contacts, communication \u0026 more at home and in your enterprise."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-02-10T14:24:47.052Z","bug_reporter_agreed_on_going_public_at":"2017-02-10T14:02:45.155Z","team_member_agreed_on_going_public_at":"2017-02-10T14:24:47.022Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"**Hello NextCloud**\n\n**Details**\ni just test your domain which is nextcloud.com and i surprised that i can send a **legit** email\nto a user.\n\n**Impact**\n\nAttacker can use this to send a Legit Email to the Victim and attacker can send a Malicious Web Links and Phishing Sites.\n\n**Video Proof of Concept**\n\nhttps://mega.nz/#!rtQHxQqa!sd4U7XHvCGvBS-WJMxfzm-NiJVt8ADrxQI3Wwx81raw\n\nReference (Similar Reports):: #54779 \u0026 #57736\n\nLet me know if i miss something.\nLooking forward to it's fix.\nBest Regards,\n@ph_spade","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":200762,"original_report_url":"https://hackerone.com/reports/200762","attachments":[],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["mpz","rbcafe","spetr0x","ph_spade","sk0wt"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1477068,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks a lot for reporting this potential issue back to us!\n\nOur security team will take a look at this issue as soon as possible. We will reply to your report within 72 hours, usually much faster. For obvious reasons we'd like to ask you to not disclose this issue to any other party.","automated_response":true,"created_at":"2017-02-10T13:37:26.536Z","updated_at":"2017-02-10T13:37:26.536Z","actor":{"url":"/nextcloud","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/013/291/68f57538488b5716cdeeb6b78955f9e46685bc09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Nextcloud"}},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1477071,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"oh yeah thanks NextCloud Bot ^_^","automated_response":false,"created_at":"2017-02-10T13:37:54.075Z","updated_at":"2017-02-10T13:37:54.075Z","actor":{"username":"ph_spade","cleared":false,"url":"/ph_spade","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1477102,"is_internal":false,"editable":false,"type":"Activities::BugDuplicate","message":"","automated_response":false,"created_at":"2017-02-10T13:52:36.675Z","updated_at":"2017-02-10T13:52:36.675Z","original_report_id":200762,"actor":{"username":"nickvergessen","cleared":false,"url":"/nickvergessen","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/5DBbeB7om4ZiKgskrEoeTyGH/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1477112,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Oh Sorry Next Cloud.\nI see that your'e aware of this.\n{F159424}\n:)\n","automated_response":false,"created_at":"2017-02-10T14:02:45.173Z","updated_at":"2017-02-10T14:02:45.173Z","first_to_agree":true,"actor":{"username":"ph_spade","cleared":false,"url":"/ph_spade","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":159424,"filename":"nextcloud.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/159/424/fbc71032315bf505aa1ad64c2747fbe4bcbe419b/nextcloud.png?response-content-disposition=attachment%3B%20filename%3D%22nextcloud.png%22%3B%20filename%2A%3DUTF-8%27%27nextcloud.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQUWIS6VCD%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140238Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJIMEYCIQD5qsiIq7Ck1i9U3MTr1Jo1%2F3EDxH2PPmsZwQtKB8ZKHgIhAJ3GPiydxb4RL1gx8xsJzOsLrxI5jwwj0tTnFObt0P14KoMECO7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAhoMMDEzNjE5Mjc0ODQ5IgzIOEXrWQ9u1AQUX0Uq1wOcZjaNugHMVKWeqymcjzBFh6Y1k6CMr8RU%2By%2FCZ4rv9GZiC2wT8OmGhsgt00HKgFWK1MpUtynFdgo25n2Z3Hw%2BIbYI8vc1JJdIjhuurHucoJNgsKCs02JzKj8GyJUC61pv0yaDJyGUVPN694UkMEyn%2FPWTQr%2BUTeBhbmczKhCGUj%2FpPN2iIbYsRZixR6LxxOf2cvjX2jSZkAk%2FSVsApfA8g%2BhlsBjDUA9%2B8YRWNjxfWtxQ%2Foo1xWaWyO6R0C2NxkUOjfjpECLEYEQ7vJ%2Bmu27ctvQxX8DIgxS97NsRC7LzasVsLHVmntXBAZ7PuEI4sWc5xs%2Fk66Q906%2BB%2BzvloL3Axk31g5hiymuem0csQnadqDxLt8p2LjIDw8YcQPN5NH0kGSb6mQrkldEFgJqP84RMAJRIxUJWDd%2B%2BPuzQFsioIExGAI0yAK1L2jOitJOooOZlWfFIzjDUn7dj9xSziPydE91tqmI514stzkBU2GFbRIrklzPo3g7n0zD%2FNL7OLEHlmYWBTM9ot%2B6bu4Bck8DrV4VVi9QHnC5ukEnqLU7NSIQGPaibC1SdOVjM2Iv6X9PdR0rR6F07TM%2FRs9G%2B%2BYIK1kHXDHgTN6Tqa9Kn%2B8BfoEt%2BZqnCJGYwv%2ByQiwY6pAFugzNge1CtFW4ATDcRX3hNOdndjPYZIsRGJutSgqHjCwxt8awsI7yZQ6vRxlp6LSSmoSK%2BkQ3evRcXC09cJ%2F1e4JrEeYASE3WVsCxAQVnPVIMtkim2T%2BFMB87kfQL6qAH6iiBO2KVli0mZ4%2BX%2ByxoxRVipnwQh%2B2l8LEnW1ug4kWwPqBp1%2F3G0D3IViaM%2F6KEe0O675l3jsd9YY%2BgtdY9L6zl0yg%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b2abcb353aae05942fba442f47f81181a51141b105f7aa53d7bd1db191730150"}],"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1477146,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Please hover over the avatar, you'll see that Google Mail will tell you that it can't verify that the mail has been sent by nextcloud.com.\n\nAlso, we do have a SPF policy:\n\n```\n➜  ~ dig TXT nextcloud.com\n\n; \u003c\u003c\u003e\u003e DiG 9.8.3-P1 \u003c\u003c\u003e\u003e TXT nextcloud.com\n;; global options: +cmd\n;; Got answer:\n;; -\u003e\u003eHEADER\u003c\u003c- opcode: QUERY, status: NOERROR, id: 38228\n;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 0\n\n;; QUESTION SECTION:\n;nextcloud.com.\t\t\tIN\tTXT\n\n;; ANSWER SECTION:\nnextcloud.com.\t\t1946\tIN\tTXT\t\"v=spf1 mx include:sendgrid.net -all\"\nnextcloud.com.\t\t1946\tIN\tTXT\t\"google-site-verification=Z53uT_lAq83WHthD1qvwMwxzDZPOQFRb-BGsFRyjOlw\"\n\n;; Query time: 12 msec\n;; SERVER: 172.20.10.1#53(172.20.10.1)\n;; WHEN: Fri Feb 10 15:20:20 2017\n;; MSG SIZE  rcvd: 160\n```\n\nWhat we don't have yet in place is a strict DMARC policy but only a permissive one. This is something that we're working on however:\n\n```\n➜  ~ dig TXT _dmarc.nextcloud.com\n\n; \u003c\u003c\u003e\u003e DiG 9.8.3-P1 \u003c\u003c\u003e\u003e TXT _dmarc.nextcloud.com\n;; global options: +cmd\n;; Got answer:\n;; -\u003e\u003eHEADER\u003c\u003c- opcode: QUERY, status: NOERROR, id: 20174\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0\n\n;; QUESTION SECTION:\n;_dmarc.nextcloud.com.\t\tIN\tTXT\n\n;; ANSWER SECTION:\n_dmarc.nextcloud.com.\t4502\tIN\tTXT\t\"v=DMARC1\\; rua=mailto:887485355296292@rep.dmarcanalyzer.com\\; ruf=mailto:887485355296292@for.dmarcanalyzer.com\\; p=none\\; sp=none\\; fo=0\\;\"\n\n;; Query time: 48 msec\n;; SERVER: 172.20.10.1#53(172.20.10.1)\n;; WHEN: Fri Feb 10 15:21:45 2017\n;; MSG SIZE  rcvd: 183\n```","automated_response":false,"created_at":"2017-02-10T14:24:47.036Z","updated_at":"2017-02-10T14:24:47.036Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1477147,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-02-10T14:24:47.065Z","updated_at":"2017-02-10T14:24:47.065Z","actor":{"username":"lukasreschke","cleared":false,"url":"/lukasreschke","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/037/891/e7fea4d5383dc07d1fe767b02f3bda2bc7639c63_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1477166,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"i can see that \"it can't verify that the mail has been sent by nextcloud.com\".\n\nSometimes Victim's is not able to see that and still follows what the email says...\n\nanyways i still look forward to its fix or mitigations.","automated_response":false,"created_at":"2017-02-10T14:33:04.750Z","updated_at":"2017-02-10T14:33:04.750Z","actor":{"username":"ph_spade","cleared":false,"url":"/ph_spade","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"nextcloud","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}