{"id":218324,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yMTgzMjQ=","url":"https://hackerone.com/reports/218324","title":"An unsafe design practice in the Passphrase may result in Secret being accidentally changed.","state":"Closed","substate":"informative","severity_rating":"high","readable_substate":"Informative","created_at":"2017-04-03T15:46:42.562Z","submitted_at":"2017-04-03T15:46:42.562Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kevin_c","url":"/kevin_c","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":18,"url":"https://hackerone.com/phabricator","handle":"phabricator","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/018/61446f7e6f0684c8c9f7c36c918b7ecd58183588_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Phabricator","twitter_handle":"phabricator","website":"http://phacility.com/phabricator/","about":"Phabricator is a collection of open source web applications that help software companies build better software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2017-04-04T05:10:38.594Z","bug_reporter_agreed_on_going_public_at":"2017-04-04T03:59:17.595Z","team_member_agreed_on_going_public_at":"2017-04-04T05:10:38.536Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Summary:\nAn unsafe design practice in the Passphrase may result in Secret being accidentally changed.\nPreface:\nIf a user wants to share his/hers secrets, he/she may use the Passphrase. But when he/she created the credential and setted who can view it and who can edit it, they will soon discover that if they not set the edit permission to the one they want to share secret with, it is impossible success. Naturally, they would give the edit permission to everyone they want to share the secret with. So, here is the problem. It means they can change the secret. If someone ignores the edit records, he/she may under attack inadvertently. Because the secret has been modified.\nReproduction steps:\nOpen three different browsers (to simulate three different users)\nBROWSER A: Log in as user A\nBROWSER B: Log in as user B\nBROWSER C: Log in as user C\nBROWSER A: Go to the Passphrase and create new credential. Make it visible to both user A user B and user C. Make it editable to only user A.\nBROWSER B: Open the https://yourdomain.com/K1(your id) and discover it is impossible to show the secret.\nBROWSER A: Make it editable to both user A user B and user C.\nBROWSER B: User B can see the secret and can change it.\nBROWSER C: Open the https://yourdomain.com/K1(your id) but only can see the the secret has been modified.\n\nPlease fix it right away.\n\nBest regards,\nKevin C.","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":2,"voters":["linkks","spetr0x"],"severity":{"rating":"high","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":1580765,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"It is expected that giving a user permission to edit a credential allows them to edit that credential. It would be surprising if the software *did not* work like this. This is not a security vulnerability.\n\nSee also: \u003chttps://secure.phabricator.com/T4721\u003e","automated_response":false,"created_at":"2017-04-03T15:57:55.252Z","updated_at":"2017-04-03T15:57:55.252Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1582122,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It is a fact I want to tell you. A lot of people including my employees and customers, using the Passphrase as a secret sharing tool. To achieve their goals, they give the edit permission to EVERYONE they want to share with(even over 1000 users). But NOBODY told them NOT TO DO, it is NOT a secret sharing tool. I did a test, I replaced the self-signed certificates and public keys they shared, and NOBODY discover the secrets are FAKE until I told them. It is amazing. The impact of the attack depends on the importantance of the secrets. This kind of design logic is IRRESPONSIBLE to the users and put them in DANGER.","automated_response":false,"created_at":"2017-04-04T03:50:04.452Z","updated_at":"2017-04-04T03:50:04.452Z","actor":{"username":"kevin_c","cleared":false,"url":"/kevin_c","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1582129,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"I think this report should be taken seriously.","automated_response":false,"created_at":"2017-04-04T03:59:17.609Z","updated_at":"2017-04-04T03:59:17.609Z","first_to_agree":true,"actor":{"username":"kevin_c","cleared":false,"url":"/kevin_c","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1582170,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Sure, I'm happy to disclose this publicly.","automated_response":false,"created_at":"2017-04-04T05:10:38.569Z","updated_at":"2017-04-04T05:10:38.569Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1582171,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-04-04T05:10:38.615Z","updated_at":"2017-04-04T05:10:38.615Z","actor":{"username":"epriestley","cleared":false,"url":"/epriestley","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/000/043/3ebca5250ea5abd54b49ccc9d69c636af4585b2e_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":1582190,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Will you make a difference?","automated_response":false,"created_at":"2017-04-04T05:30:07.581Z","updated_at":"2017-04-04T05:30:07.581Z","actor":{"username":"kevin_c","cleared":false,"url":"/kevin_c","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":1584512,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"A safe design practice is not only to ensure the safety of the code, but also to ensure that it is properly used by the use.\n","automated_response":false,"created_at":"2017-04-05T09:25:35.536Z","updated_at":"2017-04-05T09:25:35.536Z","actor":{"username":"kevin_c","cleared":false,"url":"/kevin_c","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"phabricator","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}