{"id":289000,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8yODkwMDA=","url":"https://hackerone.com/reports/289000","title":"Vulnerable exported broadcast receiver","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2017-11-10T00:51:21.802Z","submitted_at":"2017-11-10T00:51:21.802Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"b3nac","url":"/b3nac","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/125/523/65b7a47c2fea7ce71861bc6158b6c7d27408aada_original.jpeg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21024,"url":"https://hackerone.com/bitwarden","handle":"bitwarden","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/uHvBgHfLjcd9SPWDmjdYVf21/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/uHvBgHfLjcd9SPWDmjdYVf21/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Bitwarden","twitter_handle":"bitwarden","website":"https://bitwarden.com","about":"Open source password management solutions for individuals, teams, and business organizations."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2017-11-10T05:24:14.592Z","bug_reporter_agreed_on_going_public_at":"2017-11-10T05:24:14.480Z","team_member_agreed_on_going_public_at":"2017-11-10T04:19:01.052Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Good evening,\n\nThis is actually in your code base this time.  :)\n\nSince the following broadcast receiver has export=true it can be exploited by 3rd parties.\n\n#Vulnerability\n\ncom.x8bit.bitwarden.PackageReplacedReceiver has exported set to true making the receiver vulnerable to tampering.\n\n{F238236}\n\n#POC\n\nI was able to send information to the receiver and get a response with Drozer. This gives me further information to craft the right payload.\n\n{F238227}\n\n#Fix\nIn the manifest changing exported to false or if the broadcast needs to be exported the following would be the correct fix.\n\nAt the top of the manifest with the other permissions.\n\n```\n\u003cpermission android: name=\"com.x8bit.bitwarden.PackageReplacedReceiverPermission\" android:protectionLevel=\"signature\" /\u003e\n```\n\nModified receiver manifest entry.\n```\n\u003creceiver android:name=\"com.x8bit.bitwarden.PackageReplacedReceiver\" android:exported=\"true\" android:permission=\"com.x8bit.bitwarden.PackageReplacedReceiverPermission\"\u003e\n            \u003cintent-filter\u003e\n                \u003caction android:name=\"android.intent.action.MY_PACKAGE_REPLACED\" /\u003e\n            \u003c/intent-filter\u003e\n        \u003c/receiver\u003e\n```\n\nAdding the signature custom permission makes it so the broadcast can only be used with applications that were signed with the same key.\n\nPlease let me know if you have any questions. Great job on this app by the way. It's one of the most secure apps I've seen so far on H1.\n\n#Resources\nhttps://oldbam.github.io/android/security/android-vulnerabilities-insecurebank-broadcast-receivers\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":238227,"file_name":"TestingtheBroadcast.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/238/227/f6a4f414475871c8d147b308e953297dbd646a2f/TestingtheBroadcast.PNG?response-content-disposition=attachment%3B%20filename%3D%22TestingtheBroadcast.PNG%22%3B%20filename%2A%3DUTF-8%27%27TestingtheBroadcast.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143903Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1fd70a8c410307519980af1d8e10693d2e60db414f4dcb1c5387ec9446fbd8fb","file_size":4452,"type":"image/png"},{"id":238236,"file_name":"Vuln_Receiver.PNG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/238/236/461454b2e9b3ab13622e54191c06094d9da1fa11/Vuln_Receiver.PNG?response-content-disposition=attachment%3B%20filename%3D%22Vuln_Receiver.PNG%22%3B%20filename%2A%3DUTF-8%27%27Vuln_Receiver.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143903Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=4cca7a5af4d18e137adae508841b2e97a5fe140a3e9abd4b2ebda0cf448aabed","file_size":5939,"type":"image/png"}],"allow_singular_disclosure_at":"2017-12-10T04:19:01.147Z","allow_singular_disclosure_after":-121083602.46531583,"singular_disclosure_allowed":true,"vote_count":20,"voters":["zzero","jokebookservice1","drsniper","shailesh4594","nipe","brodie_codie","eveeez","glomerulust","alfredsaonoy","exadmin","and 10 more..."],"severity":{"rating":"low","author_type":"Team"},"structured_scope":{"databaseId":771,"asset_type":"GOOGLE_PLAY_APP_ID","asset_identifier":"com.x8bit.bitwarden","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2147996,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the report. Please confirm the fix with the latest build https://ci.appveyor.com/api/buildjobs/jt5692n73p9kf7ky/artifacts/com.x8bit.bitwarden-1036.apk","automated_response":false,"created_at":"2017-11-10T02:27:10.434Z","updated_at":"2017-11-10T02:27:10.434Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2148055,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"No problem glad to help! I can confirm the broadcast receiver is no longer exported. \n\n{F238250}\n","automated_response":false,"created_at":"2017-11-10T03:04:27.069Z","updated_at":"2017-11-10T03:04:27.069Z","actor":{"username":"b3nac","cleared":false,"url":"/b3nac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/523/65b7a47c2fea7ce71861bc6158b6c7d27408aada_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":238250,"filename":"BroadcastReceiver.PNG","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/238/250/ba91b6fb15605f93a1db067c9309e8a1411ca5f4/BroadcastReceiver.PNG?response-content-disposition=attachment%3B%20filename%3D%22BroadcastReceiver.PNG%22%3B%20filename%2A%3DUTF-8%27%27BroadcastReceiver.PNG\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQZ6XJQAFX%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T143903Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCICOXvTwruabcCgvIvFwMLdD63I7wJU77da1qgiZ0fcgxAiEA2iE07eZZp56fgfdC8AqwOSxwRZmRPTllfbb0Tbxm9MYqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDDj8b5u85%2FF%2BsdTPzirXA4Q26F09GEsezqo%2FDgU%2BN1ov6Z0mJp8NxapcqVf3Oua4oSgb5aQpGLsAXhdiEaUoWsXCtHv4ujnK6mqk7E9O2WKXNjLPpfRYiEQ71CFLUQhpz1VlTUi8AaLKGm2tOz7W6Dg1b3xxjZfihfmfR6OPDce2Z600EmMbP%2BHpciOGhSEuGzpexDOGRgw4ix10R9155b0anW3PU4UD8Ge2PEqMj3%2FF8sUIZw7AbQUjqw1Ce9mhpbUZZfOQoy0pJ2t8c2T4BgwOhgN1b3fN5pnsElvfIuzUPOy6b490pAv%2BCqmrijPnhfxCFLh0JKO8JRVj8XuMyTl5hv6jZDQVsJsMAcXPrqar7TkmvMjkI%2BN4yDBkbH5NrA1VDNa0of9Y0Ob501UWmq3Ap93egI9bfOc0SJJuPizy58SnDrtHr6nSjyefAjpNL04P0FK2SzeJsSTTwhywI6YMiTBjKrFeC2gfVf8aFUGCIZ5qqWFJVDfVcx%2Fn8CXnNOSFJ4E0AOZCD2bzMOr0zl8cL%2FhRzxRrehVzw%2FTkoxOt0l7KmRzdTPKmnS8oozD2Cyle0v45%2B7sfTk9r6klH%2F2VLwfVaCQMt2wCz6DqzbD4MYWDvCaIbvvrbK5sZIedyaPkbcLAvRDDCjpGLBjqlAU9SRSSUKO2aO0kQO%2BnmnceQh7DtfcGkOUk0CXICIwNK0fD%2BqaMjTEwcyVBBW5oqUBOFZj7aKeXh%2FN47wB%2B%2BNyAlnunaZYfVUOsQGCMywCeVElq5cKhikJpo4VRBfaWxpOo%2Fjfp%2BVIoSdni5MQ6uLsqSIiA%2Fcm2GDHTprLxSZr5sstp5PxiiN53WteMJJW5bqZgjokn7B89wleOrzCJV84UVJ4OV7g%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=25a17a4173baf2d0ef53951c98c140c7a9ee23cba576afcc009a17687136a3d6"}],"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2148061,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Additionally if you want a permission denied for 3rd party apps, that permission rule would do the trick. Otherwise this broadcast receiver is no longer public.","automated_response":false,"created_at":"2017-11-10T03:06:35.294Z","updated_at":"2017-11-10T03:06:35.294Z","actor":{"username":"b3nac","cleared":false,"url":"/b3nac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/523/65b7a47c2fea7ce71861bc6158b6c7d27408aada_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2148089,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I may need to investigate a bit more about how Android handles broadcasting to MY_PACKAGE_REPLACED to ensure that turning off the export will still allow it to function as expected.","automated_response":false,"created_at":"2017-11-10T04:02:13.915Z","updated_at":"2017-11-10T04:02:13.915Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2148102,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"I confirmed it still functions as expected with exported=false. Fix will go out with next release.","automated_response":false,"created_at":"2017-11-10T04:18:06.863Z","updated_at":"2017-11-10T04:18:06.863Z","actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"b3nac","url":"/b3nac"},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2148103,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2017-11-10T04:19:01.091Z","updated_at":"2017-11-10T04:19:01.091Z","first_to_agree":true,"actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2148104,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2017-11-10T04:19:52.757Z","updated_at":"2017-11-10T04:19:52.757Z","additional_data":{"old_severity":null,"new_severity":"Low","old_severity_id":null,"new_severity_id":93929},"actor":{"username":"kspearrin","cleared":false,"url":"/kspearrin","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/NfF9KdzShJTHMmhSb4ajYq1p/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":2148150,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Awesome! I was just about to post the adb command showing the same result. Have a great night.","automated_response":false,"created_at":"2017-11-10T05:24:14.524Z","updated_at":"2017-11-10T05:24:14.524Z","actor":{"username":"b3nac","cleared":false,"url":"/b3nac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/523/65b7a47c2fea7ce71861bc6158b6c7d27408aada_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2148151,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2017-11-10T05:24:14.637Z","updated_at":"2017-11-10T05:24:14.637Z","actor":{"username":"b3nac","cleared":false,"url":"/b3nac","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/125/523/65b7a47c2fea7ce71861bc6158b6c7d27408aada_original.jpeg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"bitwarden","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}