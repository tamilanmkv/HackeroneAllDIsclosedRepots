{"id":315838,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC8zMTU4Mzg=","url":"https://hackerone.com/reports/315838","title":"Non-Cloudflare IPs allowed to access origin servers","state":"Closed","substate":"resolved","severity_rating":"low","readable_substate":"Resolved","created_at":"2018-02-14T01:39:07.667Z","submitted_at":"2018-02-14T01:39:07.667Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"emitrani","url":"/emitrani","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24846,"url":"https://hackerone.com/coalition","handle":"coalition","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/024/846/a513371904f8d6ba04620c19125008435209cc00_original./43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/846/a513371904f8d6ba04620c19125008435209cc00_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Coalition, Inc.","twitter_handle":"SolveCyberRisk","website":"https://www.coalitioninc.com/","about":"Coalition provides comprehensive cyber and technology insurance coverage, and free cyber security tools to protect  businesses."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2018-05-28T04:11:21.614Z","bug_reporter_agreed_on_going_public_at":"2018-04-28T04:11:13.836Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Hello Security Team,\n\n**Summary:** Like report #255978 It is possible to access origin servers served by nginx and not cloudflare. \n\n**Description:** Even though these IP's don't serve a functional version of the app it is possible to enable DDoS attacks by bypassing cloudflare protections.\n\n## Steps To Reproduce:\n\n  1. 52.32.239.55\n  2. 54.69.218.2\n  3. 34.208.41.101\n \nThere are more IP's but I think these are enough as a proof of concept.\n\n## Impact\n\nResponse header from one of origin IP's :\n`Connection:keep-alive\nContent-Encoding:gzip\nContent-Length:4774\nContent-Type:text/html; charset=utf-8\nDate:Wed, 14 Feb 2018 01:28:15 GMT\nRequest-Id:542a2e00-1126-11e8-bfba-c90bcfe9a4b2\nServer:nginx/1.12.1\nStrict-Transport-Security:max-age=16070400\nVary:Accept-Encoding\nX-Content-Type-Options:nosniff\nX-Download-Options:noopen\nX-Frame-Options:deny\nX-XSS-Protection:1; mode=block`\n\nand the regular website:\n\n`cf-ray:3ecc3592fd2a7e21-DTW\ncontent-encoding:br\ncontent-type:text/html; charset=utf-8\ndate:Wed, 14 Feb 2018 01:21:12 GMT\nexpect-ct:max-age=604800, report-uri=\"https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct\"\nrequest-id:57feab10-1125-11e8-a7fe-31e9cef0afb4\nserver:cloudflare\nstatus:200\nstrict-transport-security:max-age=2592000; includeSubDomains\nvary:Accept-Encoding\nx-content-type-options:nosniff\nx-download-options:noopen\nx-frame-options:deny\nx-xss-protection:1; mode=block`\n\nAlso http://54.69.218.2/login serves an insecure login page.","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2018-05-28T04:11:13.935Z","allow_singular_disclosure_after":-106482767.96097752,"singular_disclosure_allowed":true,"vote_count":22,"voters":["kaulse","mik317","ali","emitrani","w2w","muhammad_uwais","eveeez","an0nym0us","apapedulimu","booleanaire","and 12 more..."],"severity":{"rating":"low","author_type":"User"},"structured_scope":{"databaseId":4543,"asset_type":"URL","asset_identifier":"platform.thecoalition.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":2382395,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"It appears that some of the IP addresses you identified are no longer serving the application (we moved the app around last night, so that may be why).  The 34 IP address is rather sticky though and it's appropriate you found it.  I'm curious to the method you used to find it if you wouldn't mind sharing as well.\n\nI agree that this is an issue, but it's not something we can fix immediately, however I think we should fix the issue.  Will keep you updated as we move through that process.","automated_response":false,"created_at":"2018-02-14T13:47:57.365Z","updated_at":"2018-02-14T13:47:57.365Z","actor":{"username":"bigr3d","cleared":false,"url":"/bigr3d","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2382402,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2018-02-14T13:51:47.100Z","updated_at":"2018-02-14T13:51:47.100Z","actor":{"username":"bigr3d","cleared":false,"url":"/bigr3d","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2382671,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bigr3d,\n\nThanks for the fast response.\n\nI found the IP's through a website called cenys.io. Time to time check the following query to see which IP's you own were found by IP enumerating crawlers online at https://censys.io/ipv4?q=thecoalition.com\n\nThere are a couple more you should probably check out at that link. The query also shows which ports are open on those IPs so it has bunch of valuable information.\n\nThe IP I found could enable MITM attacks.\n\nFeel free to look at IPs that are available at the link. Also after fixing the root cause I suggest making this report public as this is a very common problem.\n\nBest,\nEray\n","automated_response":false,"created_at":"2018-02-14T15:06:56.210Z","updated_at":"2018-02-14T15:10:39.106Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2383215,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"To remedy this you can use CloudFlare to block direct IP access to your servers. \n\nFor example if one tries to access HackerOne by direct IP like http://104.16.99.52/ \nCloudFlare is able to block the request.","automated_response":false,"created_at":"2018-02-14T17:22:42.588Z","updated_at":"2018-02-14T17:22:42.588Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2383963,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Appreciate the info, I'll confer internally to see if we can release some of this information, as it is legitimate, and we'll ping you back in a few days.","automated_response":false,"created_at":"2018-02-14T20:01:15.746Z","updated_at":"2018-02-14T20:01:15.746Z","actor":{"username":"bigr3d","cleared":false,"url":"/bigr3d","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2383967,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I appreciate the update. It would probably be best to redact all mentioned IPs and possibly censys.io link.\n\nI look forward to hearing from you again in a few days.","automated_response":false,"created_at":"2018-02-14T20:04:06.103Z","updated_at":"2018-02-14T20:04:06.103Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2412070,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Any updates and does this qualify for some sweet looking socks?","automated_response":false,"created_at":"2018-02-21T16:55:23.128Z","updated_at":"2018-02-21T16:55:23.128Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2465505,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was checking my backlog of triaged reports and realized that I can no longer reach the 34 IP address. The application itself is no longer available via direct access so I assume it is fixed.\n\nHowever, looking at censys.io it is still possible to discover workers etc via nginx servers. It might be possible to DOS the application through them.\n\nhttp://54.69.114.132/\nhttp://35.162.56.203/\nhttp://34.210.210.162/","automated_response":false,"created_at":"2018-03-06T22:01:42.847Z","updated_at":"2018-03-06T22:01:42.847Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2473831,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for the update, regarding the sweet socks, are you in the US or somewhere else?","automated_response":false,"created_at":"2018-03-08T14:06:36.309Z","updated_at":"2018-03-08T14:06:36.309Z","actor":{"username":"bigr3d","cleared":false,"url":"/bigr3d","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2473871,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @bigr3d. I'm in the US and even willing to wear them on campus :)","automated_response":false,"created_at":"2018-03-08T14:27:22.592Z","updated_at":"2018-03-08T14:27:22.592Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2511521,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bigr3d ,\n\nAny updates? This issue seems fixed.","automated_response":false,"created_at":"2018-03-20T19:44:30.600Z","updated_at":"2018-03-20T19:44:30.600Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2581573,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bigr3d ,\n\nAny reason why this isn't marked as resolved? It's been a month since your last update.\n\nRegards,\nEray","automated_response":false,"created_at":"2018-04-09T15:49:37.964Z","updated_at":"2018-04-09T15:49:37.964Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2655381,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @bigr3d ,\n\nJust checking in. It's been 2 months since your last update.","automated_response":false,"created_at":"2018-04-23T17:08:16.075Z","updated_at":"2018-04-23T17:08:16.075Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2668714,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2018-04-26T15:18:54.997Z","updated_at":"2018-04-26T15:18:54.997Z","actor":{"username":"bigr3d","cleared":false,"url":"/bigr3d","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"emitrani","url":"/emitrani"},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2669057,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks for closing and I'm guessing thats a no for sweet looking socks which is okay.","automated_response":false,"created_at":"2018-04-26T17:01:32.380Z","updated_at":"2018-04-26T17:01:32.380Z","actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2674616,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Feel free to redact IP adresses. ","automated_response":false,"created_at":"2018-04-28T04:11:13.878Z","updated_at":"2018-04-28T04:11:13.878Z","first_to_agree":true,"actor":{"username":"emitrani","cleared":true,"url":"/emitrani","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/206/181/54e8d7444534dbe32a21bd75c87febb777a18496_original.PNG/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":2804208,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2018-05-28T04:11:21.647Z","updated_at":"2018-05-28T04:11:21.647Z","actor":{"url":"/coalition","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/846/a513371904f8d6ba04620c19125008435209cc00_original./fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Coalition, Inc."}},"genius_execution_id":null,"team_handle":"coalition","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}