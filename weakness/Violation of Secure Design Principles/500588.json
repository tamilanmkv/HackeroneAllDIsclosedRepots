{"id":500588,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MDA1ODg=","url":"https://hackerone.com/reports/500588","title":"Security headers missed on https://acme-validation.jamieweb.net/","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2019-02-24T21:33:45.456Z","submitted_at":"2019-02-24T21:33:45.456Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mik317","url":"/mik317","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/235/168/b1978368a15e57488f15b4f8aff454d3e3e98184_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":24397,"url":"https://hackerone.com/jamieweb","handle":"jamieweb","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/024/397/b701b28c374242ae359697e109ce293770d49f09_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/397/b701b28c374242ae359697e109ce293770d49f09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"JamieWeb","twitter_handle":"jamieweb","website":"https://www.jamieweb.net","about":""}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2019-03-28T00:51:43.017Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-02-26T00:51:36.346Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nHi JamieWeb team,\nthe `https://acme-validation.jamieweb.net/` domain doesn't present some important security headers.\nThe `X-DNS-Prefetch-Control` header isn't specified with value `off`, so is enabled b default on modern web browsers, and can lead to `information disclosure` ((https://security.stackexchange.com/questions/121796/what-security-implications-does-dns-prefetching-have). \nAdditionally, the `X-Download-Options` isn't present, while a good security implication would be `noopen` (here is explained why is important in certain circumstances: https://github.com/Fyrd/caniuse/issues/3388). \nFinally, the `Public-Key-Pins header` isn't present. It is very helpful because tells to the web browser to associate a public key with a certain web server to prevent `MITM attacks` using `rogue and forged X.509 certificates`. This protects users in case a certificate authority is compromised. Is useful also for the validation of the `SSL` certificate.\n\n## Steps To Reproduce:\n  1. Add a `X-DNS-Prefetch-Control: off` header\n  1. Add a `X-Download-Options: noopen` header\n  1. Add a `Public-Key-Pins` header (for calculate its value follow the https://scotthelme.co.uk/hpkp-http-public-key-pinning/ article)\n\nIf you don't consider this a valid issue, let me know it and I'l autoclose by myself as N/A :)\n\n## Impact\n\nSome security headers missed can lead to prevention of certain attacks that can be exploited using reflected attacks in the local network either in remote contexts.","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":"2019-03-28T00:51:36.412Z","allow_singular_disclosure_after":-80230506.89736119,"singular_disclosure_allowed":true,"vote_count":46,"voters":["reigertje","bl4de","ali","an0nym0us","khizer47","cr4xerbik4sh","7azimo","cryptographer","rubnogueira","nfsec_pl","and 36 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":21499,"asset_type":"URL","asset_identifier":"acme-validation.jamieweb.net","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":4202538,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @mik317,\n\nThanks for your report.\n\nGood spot here - I'm going to add 'X-DNS-Prefetch-Control: off' to all responses and test it in my staging environment. Then hopefully it will be pushed out to the public site either tonight or later in the week.\n\nPublic-Key-Pins is a deprecated header and also quite risky to implement, so I'm going to leave it out. X-Download-Options also seems to be applicable only to older IE versions, so I will also leave it out, however I do have it noted as one to keep an eye on, as there does seem to be an ongoing feature request for this to be implemented in Edge. With Edge soon to be switching to Chromium as the engine though, this may mean that the feature request won't be fulfilled.\n\nI will resolve this report once I have implemented the changes on the live website.\n\nThanks,\nJamie","automated_response":false,"created_at":"2019-02-24T22:06:40.831Z","updated_at":"2019-02-24T22:06:40.831Z","actor":{"username":"jamieonubuntu","cleared":false,"url":"/jamieonubuntu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4202806,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Change has been implemented in staging - deployment to production is planned for Monday night/Tuesday morning GMT.","automated_response":false,"created_at":"2019-02-25T00:35:22.838Z","updated_at":"2019-02-25T00:35:22.838Z","actor":{"username":"jamieonubuntu","cleared":false,"url":"/jamieonubuntu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4205255,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jamieonubuntu ,\nthank you so much :).\n\nI'm going to report the same issue also for the  other websites:)\nBest, Mik","automated_response":false,"created_at":"2019-02-25T11:38:30.858Z","updated_at":"2019-02-25T11:38:30.858Z","actor":{"username":"mik317","cleared":false,"url":"/mik317","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/235/168/b1978368a15e57488f15b4f8aff454d3e3e98184_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4212178,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @mik317,\n\nI have now implemented the X-DNS-Prefetch-Control header on all of my live sites.\n\nThanks again for your help,\nJamie","automated_response":false,"created_at":"2019-02-26T00:50:50.716Z","updated_at":"2019-02-26T00:50:50.716Z","actor":{"username":"jamieonubuntu","cleared":false,"url":"/jamieonubuntu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mik317","url":"/mik317"},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4212181,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2019-02-26T00:51:36.377Z","updated_at":"2019-02-26T00:51:36.377Z","first_to_agree":true,"actor":{"username":"jamieonubuntu","cleared":false,"url":"/jamieonubuntu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4333791,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @jamieonubuntu ,\nbefore report another invalid header, can I know if you're interested in `X-Permitted-Cross-Domain-Policies` ? \nIf yes, let me know it and I'll open another report :)\n\nBest, Mik","automated_response":false,"created_at":"2019-03-15T19:28:50.710Z","updated_at":"2019-03-15T19:28:50.710Z","actor":{"username":"mik317","cleared":false,"url":"/mik317","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/235/168/b1978368a15e57488f15b4f8aff454d3e3e98184_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4338104,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @mik317,\n\nIf you have an attack scenario for the lack of that header, please feel free to report it.\n\nMy current thoughts are that any attack would be limited to edge-case information disclosure. For example, a site running a malicious Flash file may be able to determine that somebody had previously visited my site (and maybe even which pages by querying the local cache?), however this header may not even protect against that.\n\nHowever, if somebody wants to use an old built-in PDF reader or other plugin to access my site, they are welcome to do that, so I'd prefer not to unnecessarily restrict access unless there is a security reason to do so.\n\nAlso, in 2019 there would be easier ways to carry out that attack, for example some malicious JavaScript could probably determine based on response times whether my site was in the local DNS cache, or perhaps even by making some requests to try to see whether there are cached Strict-Transport-Security and Expect-CT policies, indicating that the site has been visited previously.\n\nThanks for your help,\nJamie","automated_response":false,"created_at":"2019-03-16T21:34:55.675Z","updated_at":"2019-03-16T21:34:55.675Z","actor":{"username":"jamieonubuntu","cleared":false,"url":"/jamieonubuntu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":4338121,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thank for the response full of informations :)\n\nBest, Mik","automated_response":false,"created_at":"2019-03-16T21:44:46.600Z","updated_at":"2019-03-16T21:44:46.600Z","actor":{"username":"mik317","cleared":false,"url":"/mik317","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/235/168/b1978368a15e57488f15b4f8aff454d3e3e98184_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":4407310,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2019-03-28T00:51:43.054Z","updated_at":"2019-03-28T00:51:43.054Z","actor":{"url":"/jamieweb","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/024/397/b701b28c374242ae359697e109ce293770d49f09_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"JamieWeb"}},"genius_execution_id":null,"team_handle":"jamieweb","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":14348,"category":"team","content":"The reporter identified that the X-DNS-Prefetch-Control, X-Download-Options and Public-Key-Pins headers were missing.\n\nX-Download-Options and Public-Key-Pins are deprecated/of limited use, so these have not been implemented. However, the X-DNS-Prefetch-Control header has now been implemented on all of my live sites in order to avoid the risk of information disclosure via this feature.","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":217385,"username":"jamieonubuntu","name":"Jamie Scaife","bio":"","cleared":false,"website":"https://www.jamieweb.net","location":"United Kingdom","created_at":"2017-11-15T19:22:21.122Z","url":"https://hackerone.com/jamieonubuntu","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"legacy","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/217/385/69ab567c95b73f28c6f63d81d945fb73a683c19c_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcGg1IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--d6cbb60ebc3edb77a160a34867fd4aebc0c205f2/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/blue.jpg"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}