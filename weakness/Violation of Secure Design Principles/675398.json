{"id":675398,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NzUzOTg=","url":"https://hackerone.com/reports/675398","title":"[invalid][false-positive] csrftoken on profile page","state":"Closed","substate":"not-applicable","readable_substate":"N/A","created_at":"2019-08-17T04:04:01.824Z","submitted_at":"2019-08-17T04:04:01.824Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"tkd8","url":"/tkd8","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":21801,"url":"https://hackerone.com/wakatime","handle":"wakatime","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./3afcb5c896247e7ee8ada31b1c1eb8657e22241f911093acfe4ec7e97a3a959a","medium":"https://profile-photos.hackerone-user-content.com/variants/000/021/801/c3af6aa265b9b7d7d6e5fd52bb768e43b06d4a44_original./eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"profile":{"name":"WakaTime","twitter_handle":"wakatime","website":"https://wakatime.com","about":"Automated metrics about your programming from text editor plugins."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2019-08-20T07:32:21.557Z","bug_reporter_agreed_on_going_public_at":null,"team_member_agreed_on_going_public_at":"2019-08-20T07:08:03.509Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"step of reproduce-\n1. Go to https://wakatime.com and create account.\n2. login account after that go public profile.\n3. after that change the full name and intercept brup suite and delete csrftoken.\n4. After forward then you see name was changed.\n\n## Impact\n\nViolation of Secure Design Principles","vulnerability_information_html":"\u003cp\u003estep of reproduce-\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eGo to \u003ca title=\"https://wakatime.com\" href=\"/redirect?url=https%3A%2F%2Fwakatime.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://wakatime.com\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e and create account.\u003c/li\u003e\n\u003cli\u003elogin account after that go public profile.\u003c/li\u003e\n\u003cli\u003eafter that change the full name and intercept brup suite and delete csrftoken.\u003c/li\u003e\n\u003cli\u003eAfter forward then you see name was changed.\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"impact\"\u003eImpact\u003c/h2\u003e\n\n\u003cp\u003eViolation of Secure Design Principles\u003c/p\u003e\n","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":557814,"file_name":"1sta.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8GycmEew7KMxnRAMzfGGWHFT?response-content-disposition=attachment%3B%20filename%3D%221sta.png%22%3B%20filename%2A%3DUTF-8%27%271sta.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063656Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=89ba01c216d8b6a34bf2b76b88601d21c9f9342ac11d8b17bb8b86afef4e31de","file_size":99196,"type":"image/png"},{"id":557815,"file_name":"2ndb.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sYL8ZKkcmSMPLDqMb3DDaeQX?response-content-disposition=attachment%3B%20filename%3D%222ndb.png%22%3B%20filename%2A%3DUTF-8%27%272ndb.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063656Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=ef19101f3e85bd9e332b8c8639f50ff79bfefd97f80f298dbd92cbaed1592912","file_size":141613,"type":"image/png"}],"allow_singular_disclosure_at":null,"vote_count":3,"voters":["sameerphad72","amad3u6","cryptographer"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"can_edit_custom_fields_attributes":false,"activities":[{"id":5599000,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Please verify this and double check to make sure this isn't a false positive. I'm not able to reproduce it.","markdown_message":"\u003cp\u003ePlease verify this and double check to make sure this isn\u0026#39;t a false positive. I\u0026#39;m not able to reproduce it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-18T06:23:49.423Z","updated_at":"2019-08-18T06:23:49.423Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5603324,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I checked it there is some issue in csrftoken and am verify it.","markdown_message":"\u003cp\u003eI checked it there is some issue in csrftoken and am verify it.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-19T07:41:20.412Z","updated_at":"2019-08-19T07:41:20.412Z","actor":{"username":"tkd8","cleared":false,"url":"/tkd8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5607521,"is_internal":false,"editable":false,"type":"Activities::BugInformative","message":"On this website, AJAX requests use the `X-CSRF-Token` header. The `csrftoken` cookie is only used for non-AJAX form submit post requests.","markdown_message":"\u003cp\u003eOn this website, AJAX requests use the \u003ccode\u003eX-CSRF-Token\u003c/code\u003e header. The \u003ccode\u003ecsrftoken\u003c/code\u003e cookie is only used for non-AJAX form submit post requests.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-19T14:18:16.799Z","updated_at":"2019-08-19T14:18:16.799Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5612400,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"but i bypass csrftoken ?","markdown_message":"\u003cp\u003ebut i bypass csrftoken ?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-20T04:03:53.632Z","updated_at":"2019-08-20T04:06:26.686Z","actor":{"username":"tkd8","cleared":false,"url":"/tkd8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5612415,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"poc","markdown_message":"\u003cp\u003epoc\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-20T04:17:27.067Z","updated_at":"2019-08-20T04:17:27.067Z","actor":{"username":"tkd8","cleared":false,"url":"/tkd8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":559695,"filename":"proof.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/DryXFxp4VFAYUyzss7tUcUBD?response-content-disposition=attachment%3B%20filename%3D%22proof.mp4%22%3B%20filename%2A%3DUTF-8%27%27proof.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQVBWWKZ4H%2F20201229%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20201229T063656Z\u0026X-Amz-Expires=3600\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCmEbZvVQ%2FI1GHRJjrhZK2Y6zh4lCWK725%2FwOpNu%2BnZkAIhAIZlqGHog%2B4PZMdnvhSU5APZbycPDz1wpNXbi5uE94ueKrQDCFUQARoMMDEzNjE5Mjc0ODQ5IgxU5AAHhqo1cPAzbTcqkQOGB5pEHXl6QCBCTSHUmyd%2FF8M3rpTqzp%2BOigrWU%2BrXYHZYm%2BGDawsiXhnqeD9o8Qw0b%2Fr0efVbRmhj5baoPrxgSiY%2B9zsreR3qClZZKnS0%2Brs8OqiMGd3clBbyfOxw2fa2vgQglV4dLF6EXSiGfxOms8eWdw%2F8mPtc81dMxDIlxTs50KUnd6aUjgG5BJs2k%2FL0rOKXYBS%2FdVqIQdN8JcCKMvqDv0u7pvSGEecQXa7pGdf07ufO02E64eU0OnaTeNyoq7WlZzT%2FGyvHjVtIvbXdPW15pwZm2Q4u8%2FW7ksSv4%2BxsESWLLCop0OeGUhtIppCDQlaMPC9JTj0HYKbMEGmZagmLfgHX4DKRg75%2FLNQViGcE%2FRCCaMxd6wrsv0dlz4dekjWvp4mXzLFkuKBM6c%2F%2BAemkmkgOJKnp%2FJUV1zJTe%2BO14GyIigsvxJqvrnKvkmsUrYwar1bX%2Be7UkqGzVbMAlsbRDNIOok7bVRXerhpXnbqFQsLWlqe%2BNfa4gSSfmgu4iIjCRRMdTWsvy2NQHfTsGjDAzar%2FBTrqAcniMm3eG7%2BxDZb9XVqMyQiSNyiuBD8pwO78bO8T3Uu8vSI3S05C6UCutmNkOnjR9D2NZaOgbFO4YujbW%2FY0mhhdjSppvg%2Bzdgu0AfZOou0DDwqm4vwEc0ekiNYUD6KHvD5tZwOaalihV5dSfbzoDyvfsJI6x7RYpBZmwPcshKw3Csz0uZew1JqrbUJVmc9v6q0aXols8bxyDKKPfp6siyzKhHELgTS3XGskds%2BWx5FaWemc%2Bo8QqyIuoOtWjmUwF39ydFOfg%2FyeKdwBxELGLKCSN8MyV6ov7IBrib4UiM%2F6l36ymDoHIX8ohg%3D%3D\u0026X-Amz-Signature=e4f5a5716207994c13631f73cdad2aaa2cb7880240b92179c84a511eaad6d516"}],"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5612427,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"We have 2 csrf tokens, you only bypassed one.","markdown_message":"\u003cp\u003eWe have 2 csrf tokens, you only bypassed one.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-20T04:26:14.174Z","updated_at":"2019-08-20T04:26:14.174Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5612437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Try removing `X-CSRF-Token` header instead.","markdown_message":"\u003cp\u003eTry removing \u003ccode\u003eX-CSRF-Token\u003c/code\u003e header instead.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-20T04:31:22.559Z","updated_at":"2019-08-20T04:31:22.559Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5612597,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-20T06:04:01.818Z","updated_at":"2019-08-20T06:04:01.818Z","first_to_agree":true,"actor":{"username":"tkd8","cleared":false,"url":"/tkd8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5612824,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-20T06:57:31.367Z","updated_at":"2019-08-20T06:57:31.367Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5612825,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-20T06:57:37.539Z","updated_at":"2019-08-20T06:57:37.539Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5612859,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"[Flask-SeaSurf](https://flask-seasurf.readthedocs.io/en/latest/) is the library we use for CSRF token handling. It checks the csrf token value in POST requests provided in the [csrftoken form post data](https://flask-seasurf.readthedocs.io/en/latest/#usage), or the [X-CSRFToken header](https://flask-seasurf.readthedocs.io/en/latest/#ajax-usage), against the csrf token in the Flask Session cookie.\n\nThe `csrftoken` header is only used by JavaScript to build an AJAX request, and set the `csrftoken` on that request in the `X-CSRFToken` header. The `csrftoken` cookie is only used to pass the token from server to JavaScript, it's not used for validating the request.\n\nSorry, this is not a vulnerability.","markdown_message":"\u003cp\u003e\u003ca href=\"/redirect?url=https%3A%2F%2Fflask-seasurf.readthedocs.io%2Fen%2Flatest%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eFlask-SeaSurf\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e is the library we use for CSRF token handling. It checks the csrf token value in POST requests provided in the \u003ca href=\"/redirect?url=https%3A%2F%2Fflask-seasurf.readthedocs.io%2Fen%2Flatest%2F%23usage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ecsrftoken form post data\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, or the \u003ca href=\"/redirect?url=https%3A%2F%2Fflask-seasurf.readthedocs.io%2Fen%2Flatest%2F%23ajax-usage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003eX-CSRFToken header\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e, against the csrf token in the Flask Session cookie.\u003c/p\u003e\n\n\u003cp\u003eThe \u003ccode\u003ecsrftoken\u003c/code\u003e header is only used by JavaScript to build an AJAX request, and set the \u003ccode\u003ecsrftoken\u003c/code\u003e on that request in the \u003ccode\u003eX-CSRFToken\u003c/code\u003e header. The \u003ccode\u003ecsrftoken\u003c/code\u003e cookie is only used to pass the token from server to JavaScript, it\u0026#39;s not used for validating the request.\u003c/p\u003e\n\n\u003cp\u003eSorry, this is not a vulnerability.\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-20T07:08:03.524Z","updated_at":"2019-08-20T07:08:03.524Z","first_to_agree":true,"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5612883,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"i bypass only cookies","markdown_message":"\u003cp\u003ei bypass only cookies\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-20T07:10:43.995Z","updated_at":"2019-08-20T07:10:43.995Z","actor":{"username":"tkd8","cleared":false,"url":"/tkd8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5612910,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Here's more info about how CSRF tokens work on the WakaTime website:\n\nhttps://flask-seasurf.readthedocs.io/en/latest/","markdown_message":"\u003cp\u003eHere\u0026#39;s more info about how CSRF tokens work on the WakaTime website:\u003c/p\u003e\n\n\u003cp\u003e\u003ca title=\"https://flask-seasurf.readthedocs.io/en/latest/\" href=\"/redirect?url=https%3A%2F%2Fflask-seasurf.readthedocs.io%2Fen%2Flatest%2F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003e\u003cspan\u003ehttps://flask-seasurf.readthedocs.io/en/latest/\u003c/span\u003e\u003ci class=\"icon-external-link\"\u003e\u003c/i\u003e\u003c/a\u003e\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-20T07:15:54.897Z","updated_at":"2019-08-20T07:15:54.897Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5612935,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"can we disclose report ?","markdown_message":"\u003cp\u003ecan we disclose report ?\u003c/p\u003e\n","automated_response":false,"created_at":"2019-08-20T07:20:27.376Z","updated_at":"2019-08-20T07:20:27.376Z","actor":{"username":"tkd8","cleared":false,"url":"/tkd8","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":5612998,"is_internal":false,"editable":false,"type":"Activities::ManuallyDisclosed","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-20T07:32:21.512Z","updated_at":"2019-08-20T07:32:21.512Z","actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5613182,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-20T08:00:45.727Z","updated_at":"2019-08-20T08:00:45.727Z","additional_data":{"old_title":"bypass csrftoken at profile name.","new_title":"[invalid] csrftoken token profile page"},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":5631320,"is_internal":false,"editable":false,"type":"Activities::ReportTitleUpdated","message":"","markdown_message":"","automated_response":false,"created_at":"2019-08-21T20:00:16.909Z","updated_at":"2019-08-21T20:00:16.909Z","additional_data":{"old_title":"[invalid] csrftoken token profile page","new_title":"[invalid][false-positive] csrftoken on profile page"},"actor":{"username":"alanhamlett","cleared":false,"url":"/alanhamlett","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/175/849/7d4d213b7dc7d636a5abae089f1aa907e074bcdb_original.jpg/eb31823a4cc9f6b6bb4db930ffdf512533928a68a4255fb50a83180281a60da5"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"wakatime","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":17913,"category":"team","content":"When testing csrf tokens on WakaTime's website, there are 2 ways we pass the csrf token in requests:\n\n1. form post-data `csrftoken`, for HTML form submits\n2. the `X-CSRFToken` header, for AJAX requests\n\nThe `csrftoken` cookie is only used to pass the token to JavaScript, it's not used for validating the request.\n\nClosing this as not applicable since csrf tokens are working correctly.","can_view?":true,"can_edit?":false,"content_html":"\u003cp\u003eWhen testing csrf tokens on WakaTime\u0026#39;s website, there are 2 ways we pass the csrf token in requests:\u003c/p\u003e\n\n\u003col\u003e\n\u003cli\u003eform post-data \u003ccode\u003ecsrftoken\u003c/code\u003e, for HTML form submits\u003c/li\u003e\n\u003cli\u003ethe \u003ccode\u003eX-CSRFToken\u003c/code\u003e header, for AJAX requests\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eThe \u003ccode\u003ecsrftoken\u003c/code\u003e cookie is only used to pass the token to JavaScript, it\u0026#39;s not used for validating the request.\u003c/p\u003e\n\n\u003cp\u003eClosing this as not applicable since csrf tokens are working correctly.\u003c/p\u003e\n"},{"category":"researcher","can_view?":true,"can_create?":false}]}