{"id":78436,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83ODQzNg==","url":"https://hackerone.com/reports/78436","title":"(URGENT!) Покупка OK дешевле, чем он стоит","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-24T17:50:47.686Z","submitted_at":"2015-07-24T17:50:47.686Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"4lemon","url":"/4lemon","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":1782,"url":"https://hackerone.com/ok","handle":"ok","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/001/782/0e7098faf92785cddc86bcf693dbb068dad14311_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/782/0e7098faf92785cddc86bcf693dbb068dad14311_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"ok.ru","twitter_handle":"","website":"http://ok.ru","about":"Odnoklassniki social network"}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2016-04-29T09:59:21.176Z","bug_reporter_agreed_on_going_public_at":"2016-04-28T18:54:18.159Z","team_member_agreed_on_going_public_at":"2016-04-29T09:59:21.094Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"1. Кликаем \"пополнить\". Сумма не важна.\r\n2. Выбираем \"Вебмани\" (если ещё не выбрано)\r\n3. В Burp выбираем перехват трафика и кликаем \"Перейти к оплате\" \r\n4. Правим параметр на одну копейку: LMI_PAYMENT_AMOUNT=0.01 - отправляем запрос. Выключаем, для удобства, перехват трафика в Burp\r\n5. Каскад редиректов и мы на платёжном гейте вебманей.\r\n6. Оплачиваем.\r\n7. \"Вы получили 1 OK\"\r\n\r\nТут целый каскад ошибок:\r\n- Система проверяет только факт оплаты некой транзакции и НЕ проверяет соотвествие оплаченной суммы от заказанной - плохо, но не смертельно, если бы не следующий пункт\r\n- Система прибавляет к балансу сумму с округлением до 1 ОК\r\n\r\nВ итоге за две копейки (платёж плюс комиссия вебманей) атакующий получает 1 ОК. То есть в 50 (!) раз дешевле. Дальше их можно рассылать подарочными сертификатами. Кроме того, само по себе действие вполне поддаётся автоматизации.\r\n\r\nКстати, покупка сертификата третьему лицу точно так же уязвима к замене  LMI_PAYMENT_AMOUNT=0.01\r\n\r\n","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":46968,"file_name":"okbuy2.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/046/968/5e26c8f654a431681d3aeeeae2f3b1edfc5dd7c6/okbuy2.jpg?response-content-disposition=attachment%3B%20filename%3D%22okbuy2.jpg%22%3B%20filename%2A%3DUTF-8%27%27okbuy2.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152719Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=cd3e079cb318ea58248d41f41492661c7109975a3b4bab066736955064f2b137","file_size":139968,"type":"image/jpeg"},{"id":46969,"file_name":"okbuy1.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/046/969/2c2e8fb4a1fd789991db8997d812a2dbc99b0fa1/okbuy1.jpg?response-content-disposition=attachment%3B%20filename%3D%22okbuy1.jpg%22%3B%20filename%2A%3DUTF-8%27%27okbuy1.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152719Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ea2293d4ccdc30145a08f41d2c931f3f644f8f66fed8a9e0818723883395c845","file_size":294957,"type":"image/jpeg"},{"id":46970,"file_name":"okbuy3.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/046/970/47450badf41f3589664e5f74fc681a649b28dcdd/okbuy3.png?response-content-disposition=attachment%3B%20filename%3D%22okbuy3.png%22%3B%20filename%2A%3DUTF-8%27%27okbuy3.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152719Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=289e28e1914a2a2ac4eb08cd130af28f2ba32559b260a7e0d121e98e780a9216","file_size":72940,"type":"image/png"},{"id":46971,"file_name":"okbuy4.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/046/971/51f761ee39da45445841d07ca38a1776e1226267/okbuy4.png?response-content-disposition=attachment%3B%20filename%3D%22okbuy4.png%22%3B%20filename%2A%3DUTF-8%27%27okbuy4.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152719Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3760e5dc59ee02511b902b63e5b533c11277bddbc05b96a6802683be0d3de223","file_size":81538,"type":"image/png"},{"id":46972,"file_name":"okbuy5.jpg","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/046/972/f9885b7c0411530f8c78d50f1349b210174c3220/okbuy5.jpg?response-content-disposition=attachment%3B%20filename%3D%22okbuy5.jpg%22%3B%20filename%2A%3DUTF-8%27%27okbuy5.jpg\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ57JDOB6N%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152719Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHcaCXVzLXdlc3QtMiJGMEQCIEj%2FvPHmMbBPYj%2BEqI%2BytJ5vP%2BW1Gij3b1KCROLW2m2fAiAUI2BnkECXV9d7hwkeZDEOYP6soFW%2FVQ7MIgaTaOghmSqDBAjw%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMaJpXtlkzQ%2F0YHokTKtcDqr54hfj92oRcu2Uf5AYn5X1dcYZ2fUSGzbf8TlAKPi%2BieszVvrvHI%2FlmbHmgiT1EynvsarNndOfkF2FRqu00jKx0CkmuRzepTozsI%2FVM4zmVsulVco0%2FTcUTH7ncLq5w17UCDOGpnW6JGeAot2EMSfGI%2BXeXow9Po2gINOm1gQnayfBCxU0Glim8HMTLVSft15PsLBhoVz6MQjjs5LpN9XS8yUG%2FvTzXTgclJY%2F9kWPo7VUzvyGgDBwaQ1NS4mY%2FwZ0AT%2BbZ6JXbFSX9ET%2BsjMi2Xi4Iz%2BSZK9IqUkrM05KykgVZmm0Jj83i2n43f%2BohD1oputpWW5Uu1cAXNs%2F4CRB2hvvyPQb%2B2khSXC6sOQi3exb9EuT5FkfOJXRD2w2ObGvWHxM%2BDQNczFHMaUBsCSSNn2cKqA093ghnjQ0g83xgTV9SBPb0QjpItD1Tnt9%2Bri%2FBh8RNCTedm%2Bor7TU6AnBCa6N50D96ANJhWhGw8kKZQdvzW0b0yw%2FH0clJ9XBtHGp1ul88rpA7tUuIoM7z31gr%2FReHR4G0fbpI0Bw%2BzUst%2BenEZyU7QQChxDc0u9loqAHNkWSJ3vDfDAhU2gFvocid02DAX%2FlKRXns4oUAYN7obhQgZX31MK2XkYsGOqYBmhNgLXdsx%2F8OPaK%2FmcpHbqK%2FVdgD3s09C%2FMBcjoeNruPiR%2B0%2FIpdgtcxNhaPoR0zb6re%2ByXh4v3hr2D2Z0%2BZCE4KiobLnf4PqE9a5czy2i5ctMeGIPCspubSRwCRBRORrnkT6%2FEocUc5PNqombEgctkvB80CoCyMfXpFqtIL0ne7x%2B%2B6lVkpXfm14Eb3XaRg7qWG7XL4Ud5U62KMTzbzA3t%2FxnvzsA%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=cf6a520f5b27921f7da6e83c97bc4a51ec231dcfe4ed134053ab2b4a3acc57ed","file_size":152970,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2016-05-28T18:54:18.234Z","allow_singular_disclosure_after":-169504381.65433386,"singular_disclosure_allowed":true,"vote_count":4,"voters":["w2w","spetr0x","dyabla","slowstock"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":524321,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"\" плохо, но не смертельно\" - тут я имел ввиду, что если бы система прибавляла те самые 0.01 - то было бы просто узявимость к подмене суммы платежа без нарушения финансовой целостности. А так прямо make money. ","automated_response":false,"created_at":"2015-07-24T17:52:50.438Z","updated_at":"2015-07-24T17:52:50.438Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":524367,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Мало того, подмена кошелька в запросе приводит лишь к ошибке \"Данный продавец не обслуживается\", а не к ошибке целостности запроса. И мне очень интересно, что будет если в запросе подменить номер кошелька (на свой, предварительно зарегестрированный в paymaster.ru). Вам придёт callback отстук и я получу ОКи вообще вам ничего не заплатив? Или всё-таки paymaster.ru берёт колбэк урл по номеру кошелька и я отправлю деньги в пустоту. Чуть позже я попытаюсь это протестировать. Сейчас нету валидного акка в этой системе.\n\nТакие запросы на платёж должны быть обязательно подписаны хэшом от параметров с секретной солью. Уверен, что paymaster.ru есть такая возможность.","automated_response":false,"created_at":"2015-07-24T18:21:35.875Z","updated_at":"2015-07-24T18:21:35.875Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":548690,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"any update?","automated_response":false,"created_at":"2015-08-14T15:19:27.988Z","updated_at":"2015-08-14T15:19:27.988Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":556255,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Добрый день! Спасибо за сообщение и прошу прощения за поздний ответ.\nЕсть подозрение, что дело исключительно в округлении, но проблема в любом случае требует изучения. О результатах дам знать через пару дней.\nНу и да, во-первых платежи работают одинаково, откуда бы ни вызывались. Т.е. если баг актуален, то и в сертификатах, и при попытке купить подарок, и везде. \nИ во-вторых, существует лимит на количество транзакций, 25 в день, если мне память не изменяет, так что больше 25 рублей заработать не получится :)","automated_response":false,"created_at":"2015-08-20T18:09:31.337Z","updated_at":"2015-08-20T18:09:31.337Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":556598,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Добрый вечер, Александра!\n\nПроблема всё-таки не только в округлении. А именно:\n- При переходе от платёжного гейта одноклассников к платёжному гейту paymaster.ru запрос не подписан - должен быть подписан хэшом от конкатенации параметров плюс секретная соль известная вам и paymaster.ru - в таких случаях это обычная практика.\n- При отстуке платёжного гейта paymaster.ru к вам - система не проверяет соответствие заказанной суммы с полученной\n- И, да, после этого система округляет значение до целого.\n\nТаким образом округление лишь одна из проблем.\n\nНа единичном аккаунте действительно есть ограничение на количество ежедневных платежей (Вы можете сделать 10 платежей в течение 24 часов.). Но никто не мешает купить аккаунтов одноклассников подтверждённых по СМС (например, тут: https://buyaccs.com/) - $330 за тыщу. И это уже 10к в день. Через два дня все затраты на покупку будут отбиты.","automated_response":false,"created_at":"2015-08-20T21:09:01.781Z","updated_at":"2015-08-20T21:09:23.118Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":582582,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Есть новости?","automated_response":false,"created_at":"2015-09-09T11:50:38.024Z","updated_at":"2015-09-09T11:50:38.024Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606753,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Есть новости?","automated_response":false,"created_at":"2015-10-02T16:24:54.049Z","updated_at":"2015-10-02T16:24:54.049Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":606829,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Добрый вечер! Пока нет, фикс запланирован, но точную дату я назвать не могу. Я дам знать.","automated_response":false,"created_at":"2015-10-02T17:06:48.262Z","updated_at":"2015-10-02T17:06:48.262Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":633155,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Как обстоят дела?","automated_response":false,"created_at":"2015-10-26T19:57:54.120Z","updated_at":"2015-10-26T19:57:54.120Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":637237,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Добрый день! Баг исправлен, подтвердите пожалуйста, что он больше не воспроизводится.","automated_response":false,"created_at":"2015-10-29T17:52:26.087Z","updated_at":"2015-10-29T17:52:26.087Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":637639,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Исправление лишь частичное, и не мешает покупать ОК дешевле, просто надо идти по-другому.\nЕсли вернуться к первому вектору - попытка купить 1 ОК за 1 копейку, подменив значение в запросе к платёжному гейту - то это, действительно, перестало работать.\nНо, как я уже писал раньше:\n- При переходе от платёжного гейта одноклассников к платёжному гейту paymaster.ru запрос не подписан - должен быть подписан хэшом от конкатенации параметров плюс секретная соль известная вам и paymaster.ru \n\nЭто до сих пор не сделано. Таким образом, до сих пор существует возможность подмены значений в запросе к платёжному гейту.\nСхема меняется в части сумм:\n1. Кликаем \"пополнить\". Сумма не важна.\n2. Выбираем \"Вебмани\" (если ещё не выбрано)\n3. В Burp выбираем перехват трафика и кликаем \"Перейти к оплате\"\n4. Правим параметр на 1.01: LMI_PAYMENT_AMOUNT=1.01 - отправляем запрос. Выключаем, для удобства, перехват трафика в Burp\n5. Каскад редиректов и мы на платёжном гейте вебманей.\n6. Оплачиваем.\n7. \"Вы получили 2 OK\"\n\nТаким образом, всё озвученное ранее осталось на месте:\n- При переходе от платёжного гейта одноклассников к платёжному гейту paymaster.ru запрос не подписан - должен быть подписан хэшом от конкатенации параметров плюс секретная соль известная вам и paymaster.ru - в таких случаях это обычная практика.\n- При отстуке платёжного гейта paymaster.ru к вам - система не проверяет соответствие заказанной суммы с полученной\n- После этого система округляет значение до большего (!) целого .\n\n","automated_response":false,"created_at":"2015-10-29T21:07:40.553Z","updated_at":"2015-10-29T21:07:40.553Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":708663,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Есть новости?","automated_response":false,"created_at":"2015-12-04T16:32:21.115Z","updated_at":"2015-12-04T16:32:21.115Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":712626,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Добрый день! Округления в бОльшую сторону теперь нет, проверьте пожалуйста.","automated_response":false,"created_at":"2015-12-08T10:41:37.731Z","updated_at":"2015-12-08T10:41:37.731Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":712650,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"В части платежей через вебмани, подтверждаю. Теперь округление в меньшую сторону. Проверил на суммах 1.01 и 1.51.  \nУ меня предновогодний вопрос, до нового года успеем закрыть всё, что на прислал?:)","automated_response":false,"created_at":"2015-12-08T11:03:12.581Z","updated_at":"2015-12-08T11:03:12.581Z","actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":712776,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Отлично, тогда этот resolved. Про остальные отпишу тогда сейчас в соответствующих багах, вкратце - еще несколько закроем, но не все. ","automated_response":false,"created_at":"2015-12-08T13:14:54.985Z","updated_at":"2015-12-08T13:14:54.985Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"4lemon","url":"/4lemon"},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":712777,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"Спасибо!","automated_response":false,"created_at":"2015-12-08T13:15:09.513Z","updated_at":"2015-12-08T13:15:09.513Z","actor":{"url":"/ok","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/001/782/0e7098faf92785cddc86bcf693dbb068dad14311_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"ok.ru"}},"bounty_amount":"500.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"ok","collaborator":{"username":"4lemon","url":"/4lemon"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":932429,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Расскажем миру?","automated_response":false,"created_at":"2016-04-28T18:54:18.185Z","updated_at":"2016-04-28T18:54:18.185Z","first_to_agree":true,"actor":{"username":"4lemon","cleared":true,"url":"/4lemon","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/194/aa0eb7d0d4c0ee7d20ae9b2550953b4eeda26ef9_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":933345,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2016-04-29T09:59:21.129Z","updated_at":"2016-04-29T09:59:21.129Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":933346,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2016-04-29T09:59:21.200Z","updated_at":"2016-04-29T09:59:21.200Z","actor":{"username":"alexandra_ok","cleared":false,"url":"/alexandra_ok","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"ok","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}