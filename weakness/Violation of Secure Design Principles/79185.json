{"id":79185,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC83OTE4NQ==","url":"https://hackerone.com/reports/79185","title":"Content spoofing through Referel header","state":"Closed","substate":"resolved","readable_substate":"Resolved","created_at":"2015-07-28T07:45:34.191Z","submitted_at":"2015-07-28T07:45:34.191Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"pradeepch99","url":"/pradeepch99","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/019/143/8767dbcf03d42c1a2ddd4c58c6adea18bdc8c6a8_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":true,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":2738,"url":"https://hackerone.com/flox","handle":"flox","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/738/8ff0f85fb07d857796b8d9144bdb72256624ef0f_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/738/8ff0f85fb07d857796b8d9144bdb72256624ef0f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Flox","twitter_handle":"","website":"https://example.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2015-08-29T03:15:17.821Z","bug_reporter_agreed_on_going_public_at":"2015-07-30T03:15:04.479Z","team_member_agreed_on_going_public_at":null,"comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"I found content spoofing/ text injection through referel header\r\n\r\nSteps to reproduce:\r\nwhenever you came to this page \r\nhttps://flox.io/404/\r\nYou'll see an error message like\r\n\r\n404: Baaah!\r\nNothing existed there, so now you’re here.\r\nYou appear to be a traveller from a distant land.\r\n\r\nFrom googling I found a link leads to https://flox.io/404/ \r\nand the link is http://files.flox.io/avrisk/about\r\n\r\nTo exploit this I create a html file \r\n\u003chtml\u003e\r\n  \u003cbody\u003e\r\n    \u003cform method=\"GET\" action=\"http://files.flox.io/avrisk/about\"\u003e\r\n\t\u003cinput type=\"submit\" name=\"submit\" value=\"submit\"\u003e\r\n    \u003c/form\u003e\r\n  \u003c/body\u003e\r\n\u003c/html\u003e\r\nNote: use IE to work with this.\r\n\r\nI hosted this locally at http://localhost/a.php \r\nBut I've added some text as referer header like below\r\n\r\nhttp://localhost/a.php?You're browsing privatelyFirefox won't remember any history for this window.That includes browsing history, search history, download history, web form history, cookies, and temporary internet files. However, files you download and bookmarks you make will be kept.While this computer won't have a record of your browsing history, your employer or internet service provider can still track the pages you visit.Learn More.\r\n\r\nNow the page https://flox.io/404/ shows\r\n\r\n404: Baaah!\r\nNothing existed there, so now you’re here.\r\nWe think you may have came from: http://localhost/a.php?You'rebrowsingprivatelyFirefoxwon'trememberanyhistoryforthiswindow.Thatincludesbrowsinghistory,searchhistory,downloadhistory,webformhistory,cookies,andtemporaryinternetfiles.However,filesyoudownloadandbookmarksyoumakewillbekept.Whilethiscomputerwon'thavearecordofyourbrowsinghistory,youremployerorinternetserviceprovidercanstilltrackthepagesyouvisit.LearnMore.\r\n\r\nHere the problem is the referer header is stored on the server side.\r\nWhoever came to this https://flox.io/404/ page will get the same result.\r\nAnd it stays only for few minutes.\r\nEven though the attacker can make use of this and can insert some fake content to lead users to his site.\r\n\r\nsuppose he can put his public url in the error and can also put some message to go to that site\r\n","bounty_amount":"25.0","formatted_bounty":"$25","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":47502,"file_name":"flox.io.JPG","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/047/502/e1603f6d80ddc4a2ca7151f2ebc8adf5524328c2/flox.io.JPG?response-content-disposition=attachment%3B%20filename%3D%22flox.io.JPG%22%3B%20filename%2A%3DUTF-8%27%27flox.io.JPG\u0026response-content-type=image%2Fjpeg\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ67VGDS6J%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T152827Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIBUTJ%2BNbh3iGCDafndtBQHkqG1OchqwWgdsmguvhgcLdAiAZVuUXVW1VaXDOlTKJW4MkHKw5%2BpgOTsVzeaztjAVXniqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMAWL4B0QSi4hczgSpKtcD3VOAKPL2y75%2FC3vWJu4CxM2H0MhpokFUEt9l4V7Gq%2BkP2JZRIvSX1xKqm2Gk%2BJRjjqXa9QVImay%2FdjekrRmCYTSSDt9dxM0L0oVJr7N6F8ODRv2P7lMfnzU0QMlpmHbiPpiQb5vSlaxU6jX1ESO3u1VQpKIm%2B7BGH6YiJgHcf9pDdPJ24QxGmfk3jwQevnf60P1KEwb1KLJ2JtKpPhawQ8CP%2Fp%2B8Udd6EL0VEe2hP01M49Skdizp3cnpjBBz%2FKaJPQOVb%2FxLwhTaiAm4Gs7LWex0SieNQGn7QnS8LjaHWQ69N6yv2yl5daZ0uO8CMISq44OuSORn5NNfE6Wx49Y1QtLur%2BY0bpfImT2%2Bc3AvhGI16NMEhk5qpUfU2p6NU4IF0P6m2durenSRqQWtxyQafE31VSJU%2FhpOLcgkiLcYO84tTOPewOIMl9iBrNtCggjBX8%2FrEvRnKduv0F4uzhgiTrLXMqiHsoMRJfAlsnKSaskF2MN%2FW8oUK%2Fx2WHxpYJSGLi98vCnAnrjkI1O0VdepFdfxg4xzpi25EpMuF10ISO7%2BOVlPuH4gcxSmKXq2nnWHAyNBbYGCcXKMdnH%2BrKVSQO3JfLw8lTFoTNA9axFJVvLPV3N6%2FondMJKHkYsGOqYBXTEQgnOCUR6Njz81XybrbzJvU1Pc2hk4bMTrt1%2BCSeA%2FbFO392%2FoWlFJGmK4bl3JexiICV3H2r69Blx%2FAIbSxJ4%2Bl1Ric4x9veCmMmxtb3M7uvCDvG9rrJjEd5V99ttvzT1tURyLC0o%2FETycAhpeR4E%2BNiVWXOm1S8L2NA83yPbiobo0yaywdayHxWpEhNSXoJ8gkKAiNtIC0AZekCrrrdnKzbLEBw%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=34e0c390578f2269de5382920dde0f34e4f5faea625d3c202a037482ab76cc59","file_size":79321,"type":"image/jpeg"}],"allow_singular_disclosure_at":"2015-08-29T03:15:04.570Z","allow_singular_disclosure_after":-193148003.14730883,"singular_disclosure_allowed":true,"vote_count":1,"voters":["muhaddix"],"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":530718,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Good catch. Thanks.","automated_response":false,"created_at":"2015-07-30T03:04:43.813Z","updated_at":"2015-07-30T03:04:43.813Z","actor":{"username":"jjj","cleared":false,"url":"/jjj","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/007/063/b21324cc7d9861888c1ddd4fa345cda6612361ff_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"pradeepch99","url":"/pradeepch99"},"genius_execution_id":null,"team_handle":"flox","actor_is_team_member":true,"actor_is_concealed_member":true},{"id":530719,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2015-07-30T03:04:49.455Z","updated_at":"2015-07-30T03:04:49.455Z","actor":{"url":"/flox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/738/8ff0f85fb07d857796b8d9144bdb72256624ef0f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Flox"}},"bounty_amount":"25.0","bounty_currency":"usd","genius_execution_id":null,"team_handle":"flox","collaborator":{"username":"pradeepch99","url":"/pradeepch99"},"actor_is_team_member":true,"actor_is_concealed_member":true},{"id":530725,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2015-07-30T03:15:04.505Z","updated_at":"2015-07-30T03:15:04.505Z","first_to_agree":true,"actor":{"username":"pradeepch99","cleared":true,"url":"/pradeepch99","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/019/143/8767dbcf03d42c1a2ddd4c58c6adea18bdc8c6a8_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"flox","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":567641,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2015-08-29T03:15:17.982Z","updated_at":"2015-08-29T03:15:17.982Z","actor":{"url":"/flox","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/738/8ff0f85fb07d857796b8d9144bdb72256624ef0f_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Flox"}},"genius_execution_id":null,"team_handle":"flox","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}