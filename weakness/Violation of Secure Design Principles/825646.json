{"id":825646,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MjU2NDY=","url":"https://hackerone.com/reports/825646","title":"Improper email address verifiation while saving Account Details","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-03-20T20:22:07.550Z","submitted_at":"2020-03-20T20:22:07.550Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"harshitshah4","url":"/harshitshah4","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":45900,"url":"https://hackerone.com/stagingdoteverydotorg","handle":"stagingdoteverydotorg","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/hoDHhKEVFxx72KE8bgvqYgWz/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/hoDHhKEVFxx72KE8bgvqYgWz/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Staging.every.org","twitter_handle":"everydotorg","website":"https://staging.every.org","about":"At https://staging.every.org, you can help improve security for a 501(c)(3) tech nonprofit with the mission to connect givers and nonprofits."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-03-23T08:31:07.262Z","bug_reporter_agreed_on_going_public_at":"2020-03-23T08:25:24.217Z","team_member_agreed_on_going_public_at":"2020-03-23T08:31:07.184Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary:\nAttacker could be able change its email to any email address even already created another user's email address.(Even though UI doesnot allow it)\n## Steps To Reproduce:\n\n  0. Set up proxy.\n  1. Singup with any email address\n  2. Go to profile section \n  3. Click on update button\n  4. Monitor call in reverse proxy and change email field to any user's email address\n 5. Done! Attacker is able to change its email address to any email address even registered one's\n\n## Supporting Material/References:\nhttps://hackerone.com/reports/30975\n[list any additional material (e.g. screenshots, logs, etc.)]\n\n## Impact\n\nAttacker might be able to impersonate as any other user","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":32,"voters":["a_d_a_m","base_64","sameerphad72","prophet","h4x0r_dz","mightyowl","zimmer75","zude","xesey","n33dm0n3y","and 22 more..."],"severity":{"rating":"medium","author_type":"User"},"structured_scope":{"databaseId":42365,"asset_type":"URL","asset_identifier":"staging.every.org","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7381416,"is_internal":false,"editable":false,"type":"Activities::BugNotApplicable","message":"Based on your initial description, there do not appear to be any security implications as a direct result of this behavior, as the attacker would have to first install a malicious certificate on the victim's machine in order to edit the victim's requests via proxy.\n\nIf you disagree, please reply with additional information describing your reasoning.\n\nIncluding a working proof-of-concept that shows one of these implications can be incredibly helpful in our assessment of these claims.","automated_response":false,"created_at":"2020-03-20T20:54:26.346Z","updated_at":"2020-03-20T20:54:26.346Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7381629,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"","automated_response":false,"created_at":"2020-03-20T21:35:21.706Z","updated_at":"2020-03-20T21:35:21.706Z","actor":{"username":"harshitshah4","cleared":false,"url":"/harshitshah4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7381630,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"What I meant is that , any attacker logged in with any email address can be able to change its original email address to any other registered user's email address .\nIn other words , Assume that attacker is signed up and logged in with attacker@gmail.com and any other loyal registered user is signed up with victim@gmail.com , now attacker makes an HTTP PATCH request to https://every.org/api/me with body as {... ,\"email\":\"victim@gmail.com\",...} and attackers account email address i.e. attacker@gmail.com will be updated with victim@gmail.com","automated_response":false,"created_at":"2020-03-20T21:35:21.767Z","updated_at":"2020-03-20T21:35:21.767Z","actor":{"username":"harshitshah4","cleared":false,"url":"/harshitshah4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7381695,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"POC Drive link : https://drive.google.com/file/d/1U2vpzJNYIaZKoI32NaVpwD5B8CI4C7nZ/view?usp=sharing\n\nIf below attached POC didn't work","automated_response":false,"created_at":"2020-03-20T21:49:44.242Z","updated_at":"2020-03-20T21:50:22.050Z","actor":{"username":"harshitshah4","cleared":false,"url":"/harshitshah4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":754863,"filename":"newrecord.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/6iqe33Qf3wCasz8dEnYYFWBx?response-content-disposition=attachment%3B%20filename%3D%22newrecord.mp4%22%3B%20filename%2A%3DUTF-8%27%27newrecord.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153216Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=fd1008bd93fbde1cf0a44fe812bdbce005928c1d673209983afbb53d60ed49cf"}],"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7381744,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Using a video to demonstrate a potential issue should only be necessary for rare situations and should always be accompanied by a text description of the issue as well. Please update this report with step-by-step instructions to reproduce the core components of the issue. If you don't speak English, feel free to leave your report in your language, and we'll try our best to find someone who can help translate.\n\nHi @harshitshah4, \n\nThank you for the report! Unfortunately, we need a little more information from you before we can fully validate this report. \nPlease provide a detailed proof of concept that includes the following:\n* How to find the vulnerable functionality\n* Steps to reproduce the issue\n* Any code snippets/curl commands/request and response headers that will help reproduce the issue\n* Any additional content such as screenshots/videos that will help demonstrate the vulnerability\n\nProviding this information when submitting new reports will help us to quickly determine the validity of your report. Thank you for your help!\n\nRegards, \n@antenna ","automated_response":false,"created_at":"2020-03-20T22:02:12.542Z","updated_at":"2020-03-20T22:02:12.542Z","actor":{"username":"antenna","cleared":false,"url":"/antenna","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/B1a8q5ga9BZjMczKoqAbnMj5/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7384730,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Background :\n\nAfter logging in every.org you can edit your profile setting by navigating to https://every.org/settings/profile\nIn this page we are allowed to change our profile's (firstname , lastname , username , location and private/public) after making the changes click on update button and your profile will be updated\n\nIssue :\n\nBy clicking on update button an HTTP PATCH request is sent to :\n\n\thttps://every.org/api/me\n\tRequest BODY :\n\t{username,firstName,lastName,location,isPrivate,profileImageUrl and email}\n\n\tBy modifying email field we can change our email address to any email address including the one those are already registered .\n\n\tWhat is wrong here : \n\t\n\tFirst of all email address should not be allowed to be updated at all (since there is no option in ui to update email address)\n\tAnd still if it is allowed to be updated , it should be first checked that the same email address is whether already registered with some other account or not.\n\tHere two different accounts have same email address , which is not only bad practice but may also lead in unexpected conditions.\t\n\t","automated_response":false,"created_at":"2020-03-21T11:42:30.828Z","updated_at":"2020-03-21T11:42:30.828Z","actor":{"username":"harshitshah4","cleared":false,"url":"/harshitshah4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":755310,"filename":"Screenshot_2020-03-21_Every_org_-_Give_with_friends_to_any_charity.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Pdbc6dCYgZdkEapc4Wrt1wF8?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-03-21_Every_org_-_Give_with_friends_to_any_charity.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-03-21_Every_org_-_Give_with_friends_to_any_charity.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQ4IEPVQO5%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153216Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJGMEQCIEfiwE8ABftQ4ZDSo2PcCdmgWGJAVhZBcjrVILPjej50AiACAJuLWZpiOUokpZpZYio1aaS1zedU6yBiP02ueFvn1iqDBAjv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDAxMzYxOTI3NDg0OSIMwnKCmy9PUlqhlDykKtcDeye%2FigxH7oQuBLWPNAddVUxCetP%2B6VM%2FIfdoNEAf8dePeEZ6nfGVUDz0owpAQ8YnLRTgfKqbZIg9uvHiJY%2F4BbcoCSwwJdRGPldLb3Y3WlPcJ1JvXUEefleLwhstFskHZ2cPwg1VDGmKUpYSrXj0yczI934c5Lp8FHGi7k73DEu%2FAkrDbRnSZHG42WaaqPNNWImCdPeTEmq3NWpEt8cesOA6Xa4VqYMRs9drBzvQOySUd6OOKhFszrFCIooeL9FH3tfL1jRUt27tojJhfuYEL1%2BXkCSnEkXAKcWclEQwC3FfnY0XhghLZDzab25hU%2Bd2h1mXTSBw8U0KUeuS7BYp2gJWFyuMnua0PPwpsnfW%2B9HdmkGFEZMkcwfZlh9E6l1XmyYfjTKzbK4akQ37CPeaxglSuydRq%2BOr7eoa4bJwD8SbBbqyaFHvzfbmsQAD6vBhy3a3VJ%2FRjznM9l%2FDW%2BnlGoCNLaIcQRZvZ0zDR6x%2ByF%2BOA4LXd0zzf8we7BSGFKyQfoRnsOQpRday7KSiYLmMmNfRdBrUHLRHvgeo%2BpRsKlDHGprEYxVC9m%2FkU3USyz305DDgoYfE7CyGX%2FKauSdBx1ZrMRAhyMPdXtfyvzVr4uFs8EB9pzBTMM%2F%2FkIsGOqYBpHeiPK1x0yJBNNgdNDNHwOZb44D7QldQoMShvupPsVW7xgZ9egfooN5Hr7L7zQT0se6VW6MDEHSuh790gIEL3N2l3o4i8vRIQjRoeoSklFrZONuWaRaLdV2EJtaDDZ%2BwBg0kYTnQOYCaI2vJ3EB7BWjw1JRVBpZH6NvHFfING%2B%2Bhp9nGXAhqXdBxPezBeHqUbpMsZkRZrmnH1UVt5up6rjaXPnhY6Q%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=1afc03cbfb86961432deb8f4b9f8af6966c073cecc709586953338da61374685"}],"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7386512,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Thank you very much for reporting and helping make givers and nonprofits more secure!\n\nOur engineers said now they have fixed this issue. If you can help us verify this is fixed that would be much appreciated :)","automated_response":false,"created_at":"2020-03-21T19:37:40.754Z","updated_at":"2020-03-21T19:37:40.754Z","actor":{"username":"mu_yp51u","cleared":false,"url":"/mu_yp51u","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"harshitshah4","url":"/harshitshah4"},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7394422,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Yes , I could confirm that the issue is fixed , Thankyou","automated_response":false,"created_at":"2020-03-23T08:25:02.555Z","updated_at":"2020-03-23T08:25:02.555Z","actor":{"username":"harshitshah4","cleared":false,"url":"/harshitshah4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7394426,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this report publicly ?","automated_response":false,"created_at":"2020-03-23T08:25:24.235Z","updated_at":"2020-03-23T08:25:24.235Z","first_to_agree":true,"actor":{"username":"harshitshah4","cleared":false,"url":"/harshitshah4","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7394520,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Happy to disclose, thanks again!","automated_response":false,"created_at":"2020-03-23T08:31:07.199Z","updated_at":"2020-03-23T08:31:07.199Z","actor":{"username":"mu_yp51u","cleared":false,"url":"/mu_yp51u","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7394521,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-03-23T08:31:07.283Z","updated_at":"2020-03-23T08:31:07.283Z","actor":{"username":"mu_yp51u","cleared":false,"url":"/mu_yp51u","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"stagingdoteverydotorg","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"category":"researcher","can_view?":true,"can_create?":false}]}