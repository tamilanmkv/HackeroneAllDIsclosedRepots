{"id":876192,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84NzYxOTI=","url":"https://hackerone.com/reports/876192","title":"Cookie steal through content Uri","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-05-16T20:11:15.667Z","submitted_at":"2020-05-16T20:11:15.667Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"kanytu","url":"/kanytu","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":15688,"url":"https://hackerone.com/brave","handle":"brave","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":true,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Brave Software","twitter_handle":"brave","website":"https://brave.com","about":""}},"has_bounty?":true,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":false,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":true,"disclosed_at":"2021-04-22T18:05:12.454Z","bug_reporter_agreed_on_going_public_at":"2021-04-21T21:55:14.307Z","team_member_agreed_on_going_public_at":"2021-04-22T18:05:12.306Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"## Summary\n\nA misconfiguration in a content provider is allowing Brave for Android to download internal files to Downloads folder, making them accessible to other apps. A malicious app could order Brave to download the cookies database and retrieve it afterwards.\n\n## Environment\n\n- **Device:** HTC M8\n- **OS version:** Android 9\n- **Package name:** com.brave.browser\n- **App version:** 1.8.93 (`versionCode` 410809320)\n\n\n\n## Proof of concept\n\n### Pre-conditions:\n\n- Poc installed with `STORAGE` permissions\n- Brave installed with some cookies saved\n- Brave should have `STORAGE` permission as well\n\n### Steps:\n\n1. Tap \"Start Exploit\" in PoC app\n2. Brave will start to download the cookies file\n3. Open back PoC app\n\n### Result\n\nCookies are shown in PoC app\n\n### Expected result\n\nPrivate files shouldn't be exported\n\n\n\n## Detailed explanation\n\nWhen `Start Exploit` is tapped, the app is sending an intent to Brave Browser to view a content URI:\n\n```\ncontent://com.brave.browser.FileProvider/root/data/data/com.brave.browser/app_chrome/Default/Cookies\n```\n\nThis content URI will be resolved to `ChromeFileProvider`. This File Content Provider has the following path configuration:\n\n```\n\u003cpaths\u003e\n    \u003croot-path name=\"root\" path=\".\" /\u003e\n    \u003cfiles-path name=\"images\" path=\"images/\" /\u003e\n    \u003ccache-path name=\"cache\" path=\"net-export/\" /\u003e\n    \u003ccache-path name=\"passwords\" path=\"passwords/\" /\u003e\n    \u003ccache-path name=\"traces\" path=\"traces/\" /\u003e\n    \u003ccache-path name=\"webapk\" path=\"webapks/\" /\u003e\n    \u003ccache-path name=\"offline-cache\" path=\"Offline Pages/archives/\" /\u003e\n    \u003cexternal-path name=\"downloads\" path=\"Download/\" /\u003e\n    \u003cexternal-path name=\"downloads\" path=\"Android/data/com.brave.browser/files/Download/\" /\u003e\n\u003c/paths\u003e\n```\n\nBecause of the usage of `root-path` with path `.`, it is possible to use this provider to point to all files in the Android system.\n\nBy using the path segment `/root/` followed by the absolute path to the internal file, Brave will easily process this URI because it belongs to itself, hence, no need to grant permissions to this URI.\n\nBrave will then proceed to download this file because of it's mime type (`application/octet-stream`). The file is saved in `/sdcard/Download/`. This is a public directory and all files with `STORAGE` permission can access them.\n\nThe PoC listens for changes in Downloads directory and when the Cookies file is created there, it will access this database and print all cookies in it.\n\n\n\n## Remediation\n\nBrave should not use `root-path` point to the root of the file system (`./`). If this needed for some edge case, Brave should implement path checks to make sure that no internal file is used in this URI.\n\n## Attachments\n\n- PoC.zip - source code of the PoC used in this exploit\n- poc.apk - compiled binary to use in this exploit\n- video.mp4 - a video showing the exploit in action\n\n## Impact\n\nThis allows a malicious app with `STORAGE` permission to access all cookies in Brave which has a high confidentiality impact. This requires no user interaction other than a malicious app installed.\n\nThis works for all internal files but cookies allow the malicious app to potentially access private information from the user, impacting the availability and integrity of their logged in accounts.","bounty_amount":"500.0","formatted_bounty":"$500","weakness":{"id":92,"name":"Weak Password Recovery Mechanism for Forgotten Password"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":830951,"file_name":"PoC.zip","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Z63gqavXLojBAVr3XuqDh32u?response-content-disposition=attachment%3B%20filename%3D%22PoC.zip%22%3B%20filename%2A%3DUTF-8%27%27PoC.zip\u0026response-content-type=application%2Fzip\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153700Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=124448b3a20b54e4c5f8df4c326ac0836711da262f92b5b0e2964a02aeae42cd","file_size":134084,"type":"application/zip"},{"id":830952,"file_name":"poc.apk","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/39c5oEtfBMKUedyAHPBu8VoP?response-content-disposition=attachment%3B%20filename%3D%22poc.apk%22%3B%20filename%2A%3DUTF-8%27%27poc.apk\u0026response-content-type=application%2Fvnd.android.package-archive\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153700Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=43c42d859a3124cf4454976273e2a8c1d6cdc8ffa5433d9627a50205954bb4ea","file_size":2449757,"type":"application/vnd.android.package-archive"},{"id":830953,"file_name":"video.mp4","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/tS5vS6xR77pvbpRH1SNhbvpx?response-content-disposition=attachment%3B%20filename%3D%22video.mp4%22%3B%20filename%2A%3DUTF-8%27%27video.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153700Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=891c8fe27f6ab270a19a5c65a4f4e3bd045f033daa85e292eda0cd9e04c529b9","file_size":16089749,"type":"video/mp4"}],"allow_singular_disclosure_at":null,"vote_count":72,"voters":["sw33tlie","run_win","a_d_a_m","foobar7","xnutronex","prakash142","bl4de","ali","yassinek3ch","ayoub0x1","and 62 more..."],"severity":{"rating":"critical","author_type":"Team"},"structured_scope":{"databaseId":7951,"asset_type":"GOOGLE_PLAY_APP_ID","asset_identifier":"com.brave.browser","max_severity":"critical"},"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":8023514,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The weakness is `Insecure Storage of Sensitive Information` and not `Weak Password Recovery Mechanism for Forgotten Password`. ","automated_response":false,"created_at":"2020-05-16T20:12:32.686Z","updated_at":"2020-05-16T20:12:32.686Z","actor":{"username":"kanytu","cleared":false,"url":"/kanytu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8028626,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I've managed to escalate this issue to remote accessibility. \n\nA victim can get its cookies stolen remotely by opening a website and tapping anywhere in it.\n\nThis leverages the same exploit. Basically a malicious website can trigger a malicious html file download and trigger it's opening when the user clicks on that page. Opening it with `content://` URIs bypasses file-base crossed frame protection and the HTML opened will have access to the cookies file internally since it's the same schema.\n\nThat malicious page could then send the contents of this file to the attacker.\n\nAttached is a Python webpage that runs in port 8080. \n\n### New steps:\n\n1. Run the python server\n2. Open that page in Brave Browser (`ngrok` can be used create a tunnel and easily open in the device)\n3. Tap on the webpage\n\n### Detailed explanation\n\nThe webpage returned contains an IFrame that downloads an HTML file with a random generate number. When the user clicks on the page, a new page is opened: `android-app://com.brave.browser/content/com.brave.browser.FileProvider/root/sdcard/Download/%s.html#Intent;type=text/html;end`\n\nThis webpage is an Android Intent Uri that will be opened in Brave as `content://com.brave.browser.FileProvider/root/sdcard/Download/%s.html`, being `%s`, the newly downloaded file.\n\nWhen the file is opened, it will download the contents of `Cookies` file using `XMLHttpRequest` and displays a Javascript alert box containing the contents of this file.\n\n---\n\nThe fix should be the same, either remove  `\u003croot-path\u003e` or have it point to `/storage/` instead of `.`.","automated_response":false,"created_at":"2020-05-17T20:28:20.733Z","updated_at":"2020-05-17T20:39:51.337Z","actor":{"username":"kanytu","cleared":false,"url":"/kanytu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"attachments":[{"id":831995,"filename":"device-2020-05-17-214103.mp4","type":"video/mp4","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/g1JYvGXw75rGmFCfmZ1B6GdX?response-content-disposition=attachment%3B%20filename%3D%22device-2020-05-17-214103.mp4%22%3B%20filename%2A%3DUTF-8%27%27device-2020-05-17-214103.mp4\u0026response-content-type=video%2Fmp4\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153700Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=745a425181d4aaf28fd082b50b8b7e47e9ee2897fdaeb61ee6fdf5732548459d"},{"id":831993,"filename":"server.py","type":"text/x-python-script","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/QxSKx5v4eqr8Fz4R7vA5T4DE?response-content-disposition=attachment%3B%20filename%3D%22server.py%22%3B%20filename%2A%3DUTF-8%27%27server.py\u0026response-content-type=text%2Fx-python-script\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153700Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=20644fe8378a2dbd49c81bc8c0e4d3bc8867956c98d8b3bebef8664f848ca8e1"}],"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8030189,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"","automated_response":false,"created_at":"2020-05-18T05:38:36.181Z","updated_at":"2020-05-18T05:38:36.181Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8046218,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi again,\n\nI just want to add some notes.\n\nThis works for all external files in the system as well as Brave's internal files. In this report, I've used Cookies since, in my opinion, it has the highest impact. A malicious HTML file can send any file in the external directory to a remote server if the path is known, which in some messaging applications it's predictable.\n\nThis can be exploited remotely as shown above, locally by a malicious application or it can be exploited with a malicious HTML file that the user has downloaded  and opened with Brave.\n\n### Similar reports:\nhttps://hackerone.com/reports/390013\nhttps://hackerone.com/reports/375329\n\n### CVEs for reference\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-11730","automated_response":false,"created_at":"2020-05-19T09:45:07.909Z","updated_at":"2020-05-19T09:45:30.100Z","actor":{"username":"kanytu","cleared":false,"url":"/kanytu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8052041,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-05-19T20:04:00.571Z","updated_at":"2020-05-19T20:04:00.571Z","additional_data":{"old_severity":"High (7.3)","new_severity":"Medium","old_severity_id":724062,"new_severity_id":726682},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8181052,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Brave Team.\n\nAny news you can share?\n\nThanks\n@kanytu","automated_response":false,"created_at":"2020-06-02T16:19:04.407Z","updated_at":"2020-06-02T16:19:04.407Z","actor":{"username":"kanytu","cleared":false,"url":"/kanytu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8181415,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kanytu - We are working on the fix, we expect it to be merged this week. ","automated_response":false,"created_at":"2020-06-02T17:07:12.184Z","updated_at":"2020-06-02T17:07:12.184Z","actor":{"username":"pranjal_jumde","cleared":false,"url":"/pranjal_jumde","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8297591,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kanytu - The fix should be available in the nightly channel shortly. ","automated_response":false,"created_at":"2020-06-15T17:13:53.180Z","updated_at":"2020-06-15T17:13:53.180Z","actor":{"username":"pranjal_jumde","cleared":false,"url":"/pranjal_jumde","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8298437,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Brave Team,\n\nCan you confirm the issue was addressed and a fix deployed in version 1.12.25?\n\nThanks,\n@kanytu","automated_response":false,"created_at":"2020-06-15T18:39:07.842Z","updated_at":"2020-06-15T18:39:07.842Z","actor":{"username":"kanytu","cleared":false,"url":"/kanytu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8298470,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"The patch missed version 1.12.25, hoping that it lands in the next one. I'll share an update here once I see the fix in nightly.","automated_response":false,"created_at":"2020-06-15T18:42:41.287Z","updated_at":"2020-06-15T18:42:41.287Z","actor":{"username":"pranjal_jumde","cleared":false,"url":"/pranjal_jumde","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8321656,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey Brave Team,\n\nI can confirm that this was fixed in Nightly channel (v. 1.12.32) by removing the `root-path` entry from the affected XML file.\n\nGreat job,\n@kanytu","automated_response":false,"created_at":"2020-06-17T15:36:44.860Z","updated_at":"2020-06-17T15:36:44.860Z","actor":{"username":"kanytu","cleared":false,"url":"/kanytu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":8334207,"is_internal":false,"editable":false,"type":"Activities::ReportSeverityUpdated","message":"","automated_response":false,"created_at":"2020-06-18T17:50:29.683Z","updated_at":"2020-06-18T17:50:29.683Z","additional_data":{"old_severity":"Medium","new_severity":"Critical","old_severity_id":726682,"new_severity_id":753869},"actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8334214,"is_internal":false,"editable":false,"type":"Activities::BountyAwarded","message":"sorry for the delay. given the follow-up issue which doesn't require a malicious app to be installed, this probably should have hotfixed.","automated_response":false,"created_at":"2020-06-18T17:51:45.657Z","updated_at":"2020-06-18T17:51:45.657Z","actor":{"url":"/brave","ibb":false,"profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/015/688/2aad5641af643ee4f4402896e4747293f6e9c5ca_original.png/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"profile":{"name":"Brave Software"}},"bounty_amount":"500.0","bounty_currency":"usd","bonus_amount":"0.0","genius_execution_id":null,"team_handle":"brave","collaborator":{"username":"kanytu","url":"/kanytu"},"actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8334299,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"","automated_response":false,"created_at":"2020-06-18T18:03:16.214Z","updated_at":"2020-06-18T18:03:16.214Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kanytu","url":"/kanytu"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9075141,"is_internal":false,"editable":false,"type":"Activities::BugReopened","message":"@kanytu - The patch had to be reverted because it broke PDF reader functionality on the android browser. We are working on an alternative fix for this issue.  ","automated_response":false,"created_at":"2020-08-29T20:56:34.377Z","updated_at":"2020-08-29T20:56:34.377Z","actor":{"username":"pranjal_jumde","cleared":false,"url":"/pranjal_jumde","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9239970,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Brave team,\n\nDo you have news regarding this issue? Will it be fixed soon? \n\nI have some reports for other browsers I would like to disclose in a few months. I can omit this report but some of the reports I have are kinda similar to this one. I don't want to turn this issue into a zer0day in the process so I can wait a little more for your fix but keep in mind this is a nasty bug. I understand PDFs are more important because it's a more noticeable issue than this one, but please consider fixing this as soon as possible. \n\nI'm unaware of your PDF logic but I don't see how a PDF should be opened from inside the root directory (unless you are saving them in your internal directory).\n\nLet me know if you need help regarding possible solutions to this problem.\n\nThank you,\n@kanytu","automated_response":false,"created_at":"2020-09-16T18:58:28.538Z","updated_at":"2020-09-16T18:58:28.538Z","actor":{"username":"kanytu","cleared":false,"url":"/kanytu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9251214,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@kanytu - We are working with the Chromium team to fix this issue at the moment. Do you have any timeline for disclosure?","automated_response":false,"created_at":"2020-09-17T20:40:58.188Z","updated_at":"2020-09-17T20:40:58.188Z","actor":{"username":"pranjal_jumde","cleared":false,"url":"/pranjal_jumde","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9255508,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi Brave team,\n\nI understand these things take time. I don't want to impose a short deadline for the fix. Do you think you can have that addressed by the end of November?\n\nThank you,\n@kanytu","automated_response":false,"created_at":"2020-09-18T11:18:38.508Z","updated_at":"2020-09-18T11:18:38.508Z","actor":{"username":"kanytu","cleared":false,"url":"/kanytu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":9283061,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Thanks @kanytu - November works for us. Thank you for your patience.","automated_response":false,"created_at":"2020-09-21T20:59:53.614Z","updated_at":"2020-09-21T20:59:53.614Z","actor":{"username":"pranjal_jumde","cleared":false,"url":"/pranjal_jumde","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":9616900,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Closing as the fix for https://github.com/brave/brave-browser/issues/11520 was merged yesterday. Should be released next week.","automated_response":false,"created_at":"2020-10-23T17:17:25.666Z","updated_at":"2020-10-23T17:17:25.666Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"reporter":{"username":"kanytu","url":"/kanytu"},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11472380,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"Can we disclose this as previously asked?","automated_response":false,"created_at":"2021-04-21T21:55:14.338Z","updated_at":"2021-04-21T21:55:14.338Z","first_to_agree":true,"actor":{"username":"kanytu","cleared":false,"url":"/kanytu","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":11483609,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"done, thanks for your patience.","automated_response":false,"created_at":"2021-04-22T18:05:12.342Z","updated_at":"2021-04-22T18:05:12.342Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":11483610,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2021-04-22T18:05:12.490Z","updated_at":"2021-04-22T18:05:12.490Z","actor":{"username":"diracdeltas","cleared":false,"url":"/diracdeltas","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/115/616/4e2016543ea3e299dcadd088be7d0225de3419e0_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"brave","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"category":"team","can_view?":true,"can_create?":false},{"id":45140,"category":"researcher","content":"Write-up available [here](https://infosecwriteups.com/brave-stealing-your-cookies-remotely-1e09d1184675).","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":558831,"username":"kanytu","name":"Pedro","bio":"Senior Android Developer","cleared":false,"website":null,"location":"Somewhere","created_at":"2019-03-26T12:27:48.093Z","url":"https://hackerone.com/kanytu","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"hacker","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c","xtralarge":"https://profile-photos.hackerone-user-content.com/variants/mJNP7PfX6rYmTizyamisQ5hL/c11036e2d3f8b05af4b5da5984ccdec6f786b763c8abceb4e68042e10dcdae85"}}}]}